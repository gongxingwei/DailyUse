# STORY-021 å®ŒæˆæŠ¥å‘Š

**è‡ªåŠ¨ç›®æ ‡çŠ¶æ€æ›´æ–°è§„åˆ™ (Auto Goal Status Update Rules)**

## ğŸ“Š åŸºæœ¬ä¿¡æ¯

- **Story ID**: STORY-021 (STORY-AI-003-003)
- **ä¼˜å…ˆçº§**: P2
- **é¢„ä¼°å·¥æ—¶**: 2 SP
- **å®é™…å·¥æ—¶**: 2 SP
- **çŠ¶æ€**: âœ… COMPLETED
- **å®Œæˆæ—¶é—´**: 2024-XX-XX

## ğŸ¯ Story ç›®æ ‡

æ ¹æ®å…³é”®ç»“æœ (KeyResult) çš„è¿›åº¦ã€æƒé‡å’Œå…¶ä»–æŒ‡æ ‡ï¼Œè‡ªåŠ¨å»ºè®®æˆ–åº”ç”¨ç›®æ ‡çŠ¶æ€å˜æ›´ï¼Œæå‡ç›®æ ‡ç®¡ç†çš„æ™ºèƒ½åŒ–æ°´å¹³ã€‚

## âœ… å®Œæˆçš„åŠŸèƒ½

### 1. è§„åˆ™å¼•æ“æ¶æ„ (0.5 SP)

**æ–‡ä»¶**:

- `packages/contracts/src/modules/goal/rules/StatusRule.ts` (150 lines)
- `apps/web/src/modules/goal/domain/rules/BuiltInRules.ts` (240 lines)
- `apps/web/src/modules/goal/application/services/StatusRuleEngine.ts` (260 lines)

**æ ¸å¿ƒåŠŸèƒ½**:

- âœ… StatusRule å¥‘çº¦å®šä¹‰ (8 ä¸ªç±»å‹/æ¥å£)
  - StatusRule: è§„åˆ™å®šä¹‰
  - RuleCondition: æ¡ä»¶å®šä¹‰ (metric, operator, value, scope)
  - RuleAction: åŠ¨ä½œå®šä¹‰ (status, notify, message)
  - RuleExecutionResult: æ‰§è¡Œç»“æœ
  - RuleSetConfig: è§„åˆ™é›†é…ç½®

- âœ… 6 ä¸ªå†…ç½®è§„åˆ™ (æŒ‰ä¼˜å…ˆçº§æ’åº):
  1. **rule-completed** (ä¼˜å…ˆçº§ 100): æ‰€æœ‰ KR è¿›åº¦ = 100% â†’ çŠ¶æ€å˜ä¸º COMPLETED
  2. **rule-draft** (ä¼˜å…ˆçº§ 50): KR æ•°é‡ = 0 â†’ çŠ¶æ€å˜ä¸º DRAFT
  3. **rule-at-risk** (ä¼˜å…ˆçº§ 20): ä»»æ„ KR è¿›åº¦ < 30% â†’ å‘é€è­¦å‘Šé€šçŸ¥
  4. **rule-in-progress** (ä¼˜å…ˆçº§ 15): KR æ•°é‡ > 0 ä¸”æœ‰è¿›åº¦ â†’ çŠ¶æ€å˜ä¸º ACTIVE
  5. **rule-on-track** (ä¼˜å…ˆçº§ 10): æ‰€æœ‰ KR è¿›åº¦ >= 80% â†’ å‘é€é¼“åŠ±é€šçŸ¥
  6. **rule-weight-warning** (ä¼˜å…ˆçº§ 5): æƒé‡æ€»å’Œ â‰  100% â†’ å‘é€è­¦å‘Š

- âœ… StatusRuleEngine æœåŠ¡ç±»:
  - `evaluate()`: è¿”å›æœ€é«˜ä¼˜å…ˆçº§åŒ¹é…è§„åˆ™
  - `evaluateAll()`: è¿”å›æ‰€æœ‰åŒ¹é…è§„åˆ™
  - `addRule()`, `removeRule()`, `updateRule()`: CRUD æ“ä½œ
  - `resetToBuiltIn()`: é‡ç½®ä¸ºå†…ç½®è§„åˆ™

**æ”¯æŒçš„æŒ‡æ ‡** (RuleMetric):

- `progress`: å…³é”®ç»“æœè¿›åº¦ (0-100)
- `weight`: å…³é”®ç»“æœæƒé‡ (0-100)
- `kr_count`: å…³é”®ç»“æœæ•°é‡
- `deadline`: å‰©ä½™å¤©æ•°

**æ”¯æŒçš„æ“ä½œç¬¦** (RuleOperator):

- `>`, `<`, `>=`, `<=`, `=`, `!=`

**æ¡ä»¶èŒƒå›´** (Scope):

- `all`: æ‰€æœ‰å…³é”®ç»“æœ (å¹³å‡å€¼/æ€»å’Œ)
- `any`: ä»»æ„å…³é”®ç»“æœ (æœ€å°å€¼)
- `<kr-uuid>`: ç‰¹å®šå…³é”®ç»“æœ

---

### 2. è§„åˆ™è¯„ä¼°æœåŠ¡ (0.25 SP)

**æ–‡ä»¶**: `apps/web/src/modules/goal/application/composables/useAutoStatusRules.ts` (190 lines)

**æ ¸å¿ƒåŠŸèƒ½**:

- âœ… `evaluateGoal()`: è¯„ä¼°ç›®æ ‡å¹¶è¿”å›è§„åˆ™å»ºè®®
- âœ… `recordHistory()`: è®°å½•è§„åˆ™æ‰§è¡Œå†å²
- âœ… `getGoalHistory()`: è·å–ç›®æ ‡çš„æ‰§è¡Œå†å²
- âœ… `getRuleEngine()`: è®¿é—®è§„åˆ™å¼•æ“å®ä¾‹
- âœ… `convertToGoalData()`: çµæ´»çš„ Goal â†’ GoalData è½¬æ¢
  - è‡ªåŠ¨å¤„ç†åµŒå¥—çš„ progress ç»“æ„
  - å…¼å®¹ä¸åŒ DTO æ ¼å¼

**é…ç½®é€‰é¡¹** (AutoRuleConfig):

- `enabled`: å¯ç”¨/ç¦ç”¨è‡ªåŠ¨è§„åˆ™
- `allowManualOverride`: å…è®¸æ‰‹åŠ¨è¦†ç›–
- `notifyOnChange`: çŠ¶æ€å˜æ›´æ—¶é€šçŸ¥

**è¿”å›ç±»å‹** (RuleSuggestion):

```typescript
{
  goalUuid: string;
  currentStatus: GoalStatus;
  suggestedStatus?: GoalStatus;
  notify: boolean;
  message?: string;
  executionResult: RuleExecutionResult | null;
}
```

---

### 3. è§„åˆ™ç¼–è¾‘å™¨ UI (0.5 SP)

**æ–‡ä»¶**: `apps/web/src/modules/goal/presentation/components/rules/StatusRuleEditor.vue` (560 lines)

**æ ¸å¿ƒåŠŸèƒ½**:

- âœ… è§„åˆ™åˆ—è¡¨å±•ç¤º
  - ä¼˜å…ˆçº§æ’åº
  - å¯ç”¨/ç¦ç”¨åˆ‡æ¢
  - å†…ç½®è§„åˆ™ä¿æŠ¤ (ä¸å¯åˆ é™¤)
  - è§„åˆ™æ‘˜è¦ (æ¡ä»¶ + åŠ¨ä½œ)

- âœ… è§„åˆ™ç¼–è¾‘å¯¹è¯æ¡†
  - åŸºæœ¬ä¿¡æ¯: åç§°ã€æè¿°ã€ä¼˜å…ˆçº§
  - æ¡ä»¶ç±»å‹: æ‰€æœ‰æ»¡è¶³ (AND) / ä»»æ„æ»¡è¶³ (OR)
  - æ¡ä»¶æ„å»ºå™¨:
    - æ”¯æŒæ·»åŠ /åˆ é™¤å¤šä¸ªæ¡ä»¶
    - 4 ç§æŒ‡æ ‡é€‰æ‹©
    - 6 ç§æ“ä½œç¬¦é€‰æ‹©
    - èŒƒå›´é€‰æ‹©å™¨ (all/any KR)
  - åŠ¨ä½œé…ç½®å™¨:
    - ç›®æ ‡çŠ¶æ€é€‰æ‹© (å¯é€‰)
    - é€šçŸ¥å¼€å…³
    - è‡ªå®šä¹‰é€šçŸ¥æ¶ˆæ¯

- âœ… è¡¨å•éªŒè¯
  - è§„åˆ™åç§°å¿…å¡«
  - ä¼˜å…ˆçº§ > 0
  - è‡³å°‘ä¸€ä¸ªæ¡ä»¶

- âœ… å…¨å±€é…ç½®å¼€å…³
  - å¯ç”¨è‡ªåŠ¨è§„åˆ™
  - å…è®¸æ‰‹åŠ¨è¦†ç›–
  - çŠ¶æ€å˜æ›´æ—¶é€šçŸ¥

**UI äº®ç‚¹**:

- å®æ—¶æ›´æ–°è§„åˆ™åˆ—è¡¨
- å†…è”å¯ç”¨/ç¦ç”¨åˆ‡æ¢
- æ¡ä»¶/åŠ¨ä½œå¯è¯»æ‘˜è¦
- å“åº”å¼å¸ƒå±€

---

### 4. é›†æˆåˆ° Goal æµç¨‹ (0.25 SP + 0.5 SP)

**ä¿®æ”¹æ–‡ä»¶**:

- `apps/web/src/modules/goal/presentation/components/dialogs/GoalDialog.vue` (+10 lines)
- `apps/web/src/modules/goal/presentation/views/StatusRulesDemoView.vue` (330 lines, NEW)
- `apps/web/src/shared/router/routes.ts` (+9 lines)

**GoalDialog é›†æˆ**:

- âœ… æ·»åŠ ç¬¬ 4 ä¸ªæ ‡ç­¾é¡µ "è§„åˆ™è®¾ç½®"
  - Tab å›¾æ ‡: `mdi-robot` (info é¢œè‰²)
  - ç›´æ¥åµŒå…¥ StatusRuleEditor ç»„ä»¶
  - ç”¨æˆ·å¯åœ¨åˆ›å»º/ç¼–è¾‘ç›®æ ‡æ—¶ç®¡ç†è§„åˆ™

**StatusRulesDemoView æµ‹è¯•å™¨**:

- âœ… å·¦å³åˆ†æ å¸ƒå±€
  - å·¦ä¾§: StatusRuleEditor (è§„åˆ™é…ç½®)
  - å³ä¾§: è§„åˆ™æµ‹è¯•å™¨

- âœ… æµ‹è¯•å™¨åŠŸèƒ½:
  - ç›®æ ‡çŠ¶æ€é€‰æ‹©
  - KR æ•°é‡è°ƒæ•´ (0-10)
  - KR è¿›åº¦/æƒé‡è¾“å…¥ (0-100)
  - å‰©ä½™å¤©æ•°è®¾ç½®
  - æ‰§è¡Œè§„åˆ™è¯„ä¼°æŒ‰é’®

- âœ… ç»“æœå±•ç¤º:
  - çŠ¶æ€å»ºè®® (ä¿æŒä¸å˜ / éœ€è¦å˜æ›´)
  - é€šçŸ¥æ¶ˆæ¯
  - åŒ¹é…è§„åˆ™è¯¦æƒ… (ID, åŒ¹é…æ¡ä»¶, æ‰§è¡Œæ—¶é—´)
  - æ‰§è¡Œå†å²æ—¶é—´çº¿ (æœ€è¿‘ 5 æ¡)

- âœ… è·¯ç”±: `/goals/rules-demo`

---

## ğŸ“ æ–°å¢/ä¿®æ”¹æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ (5 ä¸ª)

1. `packages/contracts/src/modules/goal/rules/StatusRule.ts` (150 lines)
2. `apps/web/src/modules/goal/domain/rules/BuiltInRules.ts` (240 lines)
3. `apps/web/src/modules/goal/application/services/StatusRuleEngine.ts` (260 lines)
4. `apps/web/src/modules/goal/application/composables/useAutoStatusRules.ts` (190 lines)
5. `apps/web/src/modules/goal/presentation/components/rules/StatusRuleEditor.vue` (560 lines)
6. `apps/web/src/modules/goal/presentation/views/StatusRulesDemoView.vue` (330 lines)

**æ€»ä»£ç é‡**: ~1,730 lines

### ä¿®æ”¹æ–‡ä»¶ (2 ä¸ª)

1. `apps/web/src/modules/goal/presentation/components/dialogs/GoalDialog.vue` (+10 lines)
2. `apps/web/src/shared/router/routes.ts` (+9 lines)
3. `packages/contracts/src/modules/goal/index.ts` (+1 line)

---

## ğŸ”§ æŠ€æœ¯å®ç°

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Presentation Layer                      â”‚
â”‚  - StatusRuleEditor.vue (è§„åˆ™ç¼–è¾‘ UI)                       â”‚
â”‚  - StatusRulesDemoView.vue (æµ‹è¯•å™¨)                         â”‚
â”‚  - GoalDialog.vue (é›†æˆ)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Application Layer                        â”‚
â”‚  - useAutoStatusRules.ts (è§„åˆ™è¯„ä¼° composable)              â”‚
â”‚  - StatusRuleEngine.ts (è§„åˆ™å¼•æ“æœåŠ¡)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Domain Layer                           â”‚
â”‚  - BuiltInRules.ts (å†…ç½®è§„åˆ™å®šä¹‰)                           â”‚
â”‚  - Helper functions (æ’åº, è¿‡æ»¤, æŸ¥æ‰¾)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Contracts Layer                         â”‚
â”‚  - StatusRule.ts (ç±»å‹å®šä¹‰)                                 â”‚
â”‚  - 8 interfaces/types                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è®¾è®¡å†³ç­–

1. **ä¼˜å…ˆçº§ç³»ç»Ÿ**:
   - å†…ç½®è§„åˆ™ä¼˜å…ˆçº§ 5-100
   - è‡ªå®šä¹‰è§„åˆ™é»˜è®¤ä¼˜å…ˆçº§ 10
   - è¯„ä¼°æ—¶è¿”å›æœ€é«˜ä¼˜å…ˆçº§åŒ¹é…è§„åˆ™

2. **æ¡ä»¶è¯„ä¼°**:
   - æ”¯æŒ AND (`conditionType: 'all'`) / OR (`conditionType: 'any'`)
   - æµ®ç‚¹æ•°æ¯”è¾ƒä½¿ç”¨ 0.01 ç²¾åº¦å®¹å·®
   - Scope æ”¯æŒ all (å¹³å‡/æ€»å’Œ), any (æœ€å°å€¼), ç‰¹å®š KR UUID

3. **çµæ´»çš„æ•°æ®è½¬æ¢**:
   - `convertToGoalData()` å…¼å®¹å¤šç§ DTO æ ¼å¼
   - è‡ªåŠ¨æå–åµŒå¥—çš„ progress ç»“æ„
   - å¤„ç† null/undefined å€¼

4. **å†å²è®°å½•**:
   - è‡ªåŠ¨é™åˆ¶ä¸ºæœ€è¿‘ 100 æ¡
   - è®°å½•è§„åˆ™ ID, çŠ¶æ€å˜æ›´, æ¶ˆæ¯, æ—¶é—´æˆ³

5. **UI ä¿æŠ¤**:
   - å†…ç½®è§„åˆ™ä¸å¯åˆ é™¤ (é€šè¿‡ `rule.id.startsWith('rule-')` åˆ¤æ–­)
   - è¡¨å•éªŒè¯ç¡®ä¿æ•°æ®å®Œæ•´æ€§
   - å®æ—¶æ›´æ–°è§„åˆ™åˆ—è¡¨

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. åœ¨ GoalDialog ä¸­ç®¡ç†è§„åˆ™

```typescript
// æ‰“å¼€ç›®æ ‡ç¼–è¾‘å¯¹è¯æ¡† â†’ åˆ‡æ¢åˆ°"è§„åˆ™è®¾ç½®"æ ‡ç­¾é¡µ
// å¯ä»¥:
// - å¯ç”¨/ç¦ç”¨å†…ç½®è§„åˆ™
// - åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™
// - ä¿®æ”¹è§„åˆ™ä¼˜å…ˆçº§
// - é…ç½®é€šçŸ¥æ¶ˆæ¯
```

### 2. åœ¨ä»£ç ä¸­ä½¿ç”¨è§„åˆ™è¯„ä¼°

```typescript
import { useAutoStatusRules } from '@/modules/goal/application/composables/useAutoStatusRules';

const { evaluateGoal, recordHistory } = useAutoStatusRules();

// è¯„ä¼°ç›®æ ‡
const suggestion = evaluateGoal(goal);

if (suggestion.suggestedStatus && suggestion.suggestedStatus !== goal.status) {
  // åº”ç”¨çŠ¶æ€å˜æ›´
  await updateGoalStatus(goal.uuid, suggestion.suggestedStatus);

  // è®°å½•å†å²
  recordHistory(
    goal.uuid,
    suggestion.executionResult.ruleId,
    goal.status,
    suggestion.suggestedStatus,
    suggestion.message,
  );

  // æ˜¾ç¤ºé€šçŸ¥
  if (suggestion.notify && suggestion.message) {
    showNotification(suggestion.message);
  }
}
```

### 3. ä½¿ç”¨æµ‹è¯•å™¨

1. è®¿é—® `/goals/rules-demo`
2. å·¦ä¾§é…ç½®è§„åˆ™
3. å³ä¾§è¾“å…¥æµ‹è¯•æ•°æ®
4. ç‚¹å‡»"æ‰§è¡Œè§„åˆ™è¯„ä¼°"
5. æŸ¥çœ‹è¯„ä¼°ç»“æœå’Œæ‰§è¡Œå†å²

---

## ğŸ“ˆ å†…ç½®è§„åˆ™ç¤ºä¾‹

### ç¤ºä¾‹ 1: è‡ªåŠ¨å®Œæˆè§„åˆ™

```typescript
{
  id: 'rule-completed',
  name: 'è‡ªåŠ¨å®Œæˆ',
  priority: 100,
  conditionType: 'all',
  conditions: [
    { metric: 'progress', operator: '=', value: 100, scope: 'all' }
  ],
  action: {
    status: GoalStatus.COMPLETED,
    notify: true,
    message: 'ğŸŠ æ­å–œï¼ç›®æ ‡å·²å®Œæˆï¼Œæ‰€æœ‰å…³é”®ç»“æœéƒ½è¾¾åˆ° 100%'
  }
}
```

**è§¦å‘æ¡ä»¶**: æ‰€æœ‰ KR è¿›åº¦è¾¾åˆ° 100%
**ç»“æœ**: çŠ¶æ€å˜ä¸º COMPLETED, å‘é€ç¥è´ºé€šçŸ¥

### ç¤ºä¾‹ 2: è¿›åº¦é£é™©è­¦å‘Š

```typescript
{
  id: 'rule-at-risk',
  name: 'éœ€è¦å…³æ³¨',
  priority: 20,
  conditionType: 'any',
  conditions: [
    { metric: 'progress', operator: '<', value: 30, scope: 'any' }
  ],
  action: {
    status: GoalStatus.ACTIVE, // ä¿æŒå½“å‰çŠ¶æ€
    notify: true,
    message: 'âš ï¸ æ³¨æ„ï¼šæœ‰å…³é”®ç»“æœè¿›åº¦ä½äº 30%'
  }
}
```

**è§¦å‘æ¡ä»¶**: ä»»æ„ä¸€ä¸ª KR è¿›åº¦ < 30%
**ç»“æœ**: çŠ¶æ€ä¸å˜, å‘é€è­¦å‘Šé€šçŸ¥

### ç¤ºä¾‹ 3: æƒé‡å¼‚å¸¸æé†’

```typescript
{
  id: 'rule-weight-warning',
  name: 'æƒé‡å¼‚å¸¸',
  priority: 5,
  conditionType: 'all',
  conditions: [
    { metric: 'weight', operator: '!=', value: 100, scope: 'all' }
  ],
  action: {
    notify: true,
    message: 'âš ï¸ æƒé‡å¼‚å¸¸ï¼šå…³é”®ç»“æœæƒé‡æ€»å’Œä¸ç­‰äº 100%'
  }
}
```

**è§¦å‘æ¡ä»¶**: KR æƒé‡æ€»å’Œ â‰  100%
**ç»“æœ**: ä»…å‘é€é€šçŸ¥, ä¸æ”¹å˜çŠ¶æ€

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•

- [ ] åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™
- [ ] ç¼–è¾‘å†…ç½®è§„åˆ™ (ä¿®æ”¹ä¼˜å…ˆçº§, å¯ç”¨/ç¦ç”¨)
- [ ] åˆ é™¤è‡ªå®šä¹‰è§„åˆ™ (éªŒè¯å†…ç½®è§„åˆ™ä¸å¯åˆ é™¤)
- [ ] æµ‹è¯•ä¸åŒæ¡ä»¶ç±»å‹ (all vs any)
- [ ] æµ‹è¯•æ‰€æœ‰æŒ‡æ ‡ (progress, weight, kr_count, deadline)
- [ ] æµ‹è¯•æ‰€æœ‰æ“ä½œç¬¦ (>, <, =, >=, <=, !=)
- [ ] éªŒè¯ä¼˜å…ˆçº§æ’åº (é«˜ä¼˜å…ˆçº§è§„åˆ™å…ˆåŒ¹é…)

### é›†æˆæµ‹è¯•

- [ ] åœ¨ GoalDialog ä¸­æ‰“å¼€è§„åˆ™è®¾ç½®æ ‡ç­¾é¡µ
- [ ] ä½¿ç”¨æµ‹è¯•å™¨éªŒè¯è§„åˆ™é€»è¾‘
- [ ] æ£€æŸ¥æ‰§è¡Œå†å²è®°å½•
- [ ] éªŒè¯é€šçŸ¥æ¶ˆæ¯æ˜¾ç¤º

### è¾¹ç•Œæµ‹è¯•

- [ ] KR æ•°é‡ = 0
- [ ] æ‰€æœ‰ KR è¿›åº¦ = 100
- [ ] æƒé‡æ€»å’Œ â‰  100
- [ ] æ— åŒ¹é…è§„åˆ™çš„æƒ…å†µ
- [ ] å¤šä¸ªè§„åˆ™åŒæ—¶åŒ¹é… (éªŒè¯ä¼˜å…ˆçº§)

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸ (Sprint 4)

1. **æŒä¹…åŒ–è§„åˆ™é…ç½®**
   - å°†è‡ªå®šä¹‰è§„åˆ™ä¿å­˜åˆ° localStorage æˆ–åç«¯
   - æ”¯æŒè§„åˆ™å¯¼å…¥/å¯¼å‡º (JSON æ ¼å¼)

2. **è§„åˆ™æ¨¡æ¿åº“**
   - æä¾›æ›´å¤šè¡Œä¸šåœºæ™¯æ¨¡æ¿
   - æ”¯æŒä¸€é”®åº”ç”¨æ¨¡æ¿è§„åˆ™

3. **è‡ªåŠ¨åº”ç”¨è§„åˆ™**
   - åœ¨ KR æ›´æ–°æ—¶è‡ªåŠ¨è§¦å‘è§„åˆ™è¯„ä¼°
   - å¯é€‰çš„è‡ªåŠ¨åº”ç”¨æ¨¡å¼ (éœ€ç¡®è®¤ vs é™é»˜åº”ç”¨)

### ä¸­æœŸ (Sprint 5-6)

1. **é«˜çº§æ¡ä»¶**
   - æ”¯æŒæ—¶é—´èŒƒå›´æ¡ä»¶ (ä¾‹å¦‚: åˆ›å»ºå 7 å¤©å†…)
   - æ”¯æŒä¾èµ–æ¡ä»¶ (ä¾‹å¦‚: å‰ç½®ç›®æ ‡å®Œæˆå)
   - æ”¯æŒè‡ªå®šä¹‰è¡¨è¾¾å¼

2. **æ‰¹é‡æ“ä½œ**
   - æ‰¹é‡è¯„ä¼°æ‰€æœ‰ç›®æ ‡
   - æ‰¹é‡åº”ç”¨è§„åˆ™å»ºè®®
   - ç”Ÿæˆæ‰¹é‡åº”ç”¨æŠ¥å‘Š

3. **è§„åˆ™å†²çªæ£€æµ‹**
   - æ£€æµ‹ç›¸äº’çŸ›ç›¾çš„è§„åˆ™
   - æä¾›è§„åˆ™ä¼˜åŒ–å»ºè®®

### é•¿æœŸ (Sprint 7+)

1. **æœºå™¨å­¦ä¹ ä¼˜åŒ–**
   - æ ¹æ®ç”¨æˆ·å†å²å­¦ä¹ æœ€ä½³è§„åˆ™
   - è‡ªåŠ¨è°ƒæ•´è§„åˆ™ä¼˜å…ˆçº§
   - æ™ºèƒ½æ¨èè§„åˆ™é…ç½®

2. **å¯è§†åŒ–è§„åˆ™è®¾è®¡å™¨**
   - æ‹–æ‹½å¼è§„åˆ™æ„å»ºå™¨
   - è§„åˆ™æµç¨‹å›¾é¢„è§ˆ
   - è§„åˆ™è¦†ç›–ç‡åˆ†æ

---

## ğŸ“Š Sprint è¿›åº¦æ›´æ–°

**Sprint 3 æ€»è¿›åº¦**: 15.4/21 SP (73.3%)

**å·²å®Œæˆ** (âœ… 15.4 SP):

- STORY-015: DAG Export (2 SP)
- STORY-020: Template Recommendations (2 SP)
- STORY-019: AI Weight Allocation (3 SP)
- STORY-016: Multi-Goal Comparison (3.5 SP)
- STORY-021: Auto Status Rules (2 SP) â† **æœ¬æ¬¡å®Œæˆ**
- KeyResult Weight Refactoring (2.9 SP, BREAKING)

**å¾…å®Œæˆ** (5.6 SP):

- STORY-012: Test Environment (3 SP, P0) - éœ€è¦ç”¨æˆ·å†³ç­–
- STORY-013: DTO Tests (2 SP, P1) - ä¾èµ– STORY-012
- STORY-014/017/018: Performance/Animation (2.6 SP, P2)

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] å®šä¹‰è§„åˆ™å¥‘çº¦æ¥å£ (StatusRule, RuleCondition, RuleAction)
- [x] å®ç° 6 ä¸ªå†…ç½®è§„åˆ™ (completed, draft, at-risk, in-progress, on-track, weight-warning)
- [x] æ„å»ºè§„åˆ™å¼•æ“ (evaluate, evaluateAll, CRUD)
- [x] åˆ›å»ºè§„åˆ™è¯„ä¼° composable (useAutoStatusRules)
- [x] å¼€å‘è§„åˆ™ç¼–è¾‘å™¨ UI (StatusRuleEditor.vue)
- [x] é›†æˆåˆ° GoalDialog (è§„åˆ™è®¾ç½®æ ‡ç­¾é¡µ)
- [x] åˆ›å»ºæµ‹è¯•å™¨é¡µé¢ (StatusRulesDemoView.vue)
- [x] æ·»åŠ è·¯ç”± `/goals/rules-demo`
- [x] æ”¯æŒ 4 ç§æŒ‡æ ‡ (progress, weight, kr_count, deadline)
- [x] æ”¯æŒ 6 ç§æ“ä½œç¬¦ (>, <, =, >=, <=, !=)
- [x] æ”¯æŒæ¡ä»¶èŒƒå›´ (all, any, specific KR)
- [x] æ”¯æŒä¼˜å…ˆçº§æ’åº
- [x] æ”¯æŒå†å²è®°å½• (æœ€è¿‘ 100 æ¡)
- [x] å†…ç½®è§„åˆ™ä¿æŠ¤ (ä¸å¯åˆ é™¤)
- [x] è¡¨å•éªŒè¯ (åç§°, ä¼˜å…ˆçº§, æ¡ä»¶)

---

## ğŸ‰ æ€»ç»“

STORY-021 (Auto Goal Status Update Rules) å·²æˆåŠŸå®Œæˆï¼

**æ ¸å¿ƒæˆå°±**:

- âœ… å®Œæ•´çš„è§„åˆ™å¼•æ“ç³»ç»Ÿ (å¥‘çº¦ â†’ åŸŸ â†’ åº”ç”¨ â†’ å±•ç¤º)
- âœ… 6 ä¸ªå¼€ç®±å³ç”¨çš„å†…ç½®è§„åˆ™
- âœ… çµæ´»çš„è‡ªå®šä¹‰è§„åˆ™ç¼–è¾‘å™¨
- âœ… å¼ºå¤§çš„è§„åˆ™æµ‹è¯•å™¨
- âœ… æ— ç¼é›†æˆåˆ°ç›®æ ‡ç¼–è¾‘æµç¨‹

**ä»£ç è´¨é‡**:

- ç±»å‹å®‰å…¨ (TypeScript)
- åˆ†å±‚æ¶æ„ (Contracts â†’ Domain â†’ Application â†’ Presentation)
- å¯æ‰©å±•è®¾è®¡ (æ˜“äºæ·»åŠ æ–°è§„åˆ™/æŒ‡æ ‡)
- å®Œæ•´çš„é”™è¯¯å¤„ç†

**ç”¨æˆ·ä½“éªŒ**:

- ç›´è§‚çš„ UI è®¾è®¡
- å®æ—¶åé¦ˆ
- ä¸°å¯Œçš„æç¤ºä¿¡æ¯
- å®Œå–„çš„éªŒè¯æœºåˆ¶

ä¸‹ä¸€æ­¥å»ºè®®: å®Œæˆ STORY-012 (Test Environment) ä»¥è§£é” STORY-013 (DTO Tests)ã€‚

# Task æ¨¡å—æ¶æ„é‡æ„æŒ‡å—

## é‡æ„æ¦‚è§ˆ

æˆ‘ä»¬å·²ç»å°† Task æ¨¡å—ä»æ¸²æŸ“è¿›ç¨‹é‡æ„ä¸ºä¸»è¿›ç¨‹æ¶æ„ï¼Œéµå¾ª Electron åº”ç”¨çš„æœ€ä½³å®è·µï¼š

- **ä¸»è¿›ç¨‹**ï¼šåŒ…å«æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ã€é¢†åŸŸæ¨¡å‹å’Œæ•°æ®è®¿é—®
- **æ¸²æŸ“è¿›ç¨‹**ï¼šåªè´Ÿè´£ UI å±•ç¤ºå’Œç”¨æˆ·äº¤äº’
- **IPC é€šä¿¡**ï¼šé€šè¿‡æ ‡å‡†åŒ–çš„ DTO è¿›è¡Œæ•°æ®ä¼ è¾“

## æ¶æ„ç»“æ„

### ä¸»è¿›ç¨‹ (`electron/modules/Task/`)

```
electron/modules/Task/
â”œâ”€â”€ domain/                    # é¢†åŸŸå±‚ï¼ˆä»æ¸²æŸ“è¿›ç¨‹è¿ç§»ï¼‰
â”‚   â”œâ”€â”€ entities/             # é¢†åŸŸå®ä½“
â”‚   â”œâ”€â”€ repositories/         # ä»“å‚¨æ¥å£
â”‚   â”œâ”€â”€ services/            # é¢†åŸŸæœåŠ¡
â”‚   â””â”€â”€ valueObjects/        # å€¼å¯¹è±¡
â”œâ”€â”€ application/              # åº”ç”¨å±‚
â”‚   â””â”€â”€ mainTaskApplicationService.ts  # ä¸»è¦åº”ç”¨æœåŠ¡
â”œâ”€â”€ infrastructure/           # åŸºç¡€è®¾æ–½å±‚ï¼ˆä»æ¸²æŸ“è¿›ç¨‹è¿ç§»ï¼‰
â”œâ”€â”€ validation/              # éªŒè¯å±‚ï¼ˆä»æ¸²æŸ“è¿›ç¨‹è¿ç§»ï¼‰
â”œâ”€â”€ ipc/                     # IPC å¤„ç†å™¨
â”‚   â””â”€â”€ taskIpcHandler.ts    # IPC è¯·æ±‚å¤„ç†å™¨
â””â”€â”€ main.ts                  # æ¨¡å—åˆå§‹åŒ–
```

### æ¸²æŸ“è¿›ç¨‹ (`src/modules/Task/`)

```
src/modules/Task/
â”œâ”€â”€ services/                 # æœåŠ¡å±‚ï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ taskServiceClient.ts  # IPC å®¢æˆ·ç«¯æœåŠ¡
â”œâ”€â”€ presentation/            # è¡¨ç°å±‚
â”‚   â”œâ”€â”€ components/          # Vue ç»„ä»¶
â”‚   â”œâ”€â”€ composables/         # ç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ views/              # è§†å›¾ç»„ä»¶
â””â”€â”€ types/                   # ç±»å‹å®šä¹‰ï¼ˆå·²åºŸå¼ƒï¼Œä½¿ç”¨å…±äº«ç±»å‹ï¼‰
```

### å…±äº«ç±»å‹ (`src/shared/types/`)

```
src/shared/types/
â””â”€â”€ taskDto.ts              # Task æ¨¡å—çš„ DTO ç±»å‹å®šä¹‰
```

## IPC é€šä¿¡åè®®

### å‘½åè§„èŒƒ

æ‰€æœ‰ Task ç›¸å…³çš„ IPC é€šé“éƒ½ä»¥ `task:` ä¸ºå‰ç¼€ï¼š

```
task:meta-templates:*    # å…ƒæ¨¡æ¿ç›¸å…³
task:templates:*         # ä»»åŠ¡æ¨¡æ¿ç›¸å…³  
task:instances:*         # ä»»åŠ¡å®ä¾‹ç›¸å…³
task:stats:*            # ç»Ÿè®¡åˆ†æç›¸å…³
```

### æ”¯æŒçš„ IPC æ“ä½œ

#### å…ƒæ¨¡æ¿ (Meta Templates)
- `task:meta-templates:get-all` - è·å–æ‰€æœ‰å…ƒæ¨¡æ¿
- `task:meta-templates:get-by-id` - æ ¹æ®IDè·å–å…ƒæ¨¡æ¿
- `task:meta-templates:get-by-category` - æ ¹æ®åˆ†ç±»è·å–å…ƒæ¨¡æ¿

#### ä»»åŠ¡æ¨¡æ¿ (Task Templates)
- `task:templates:get-by-id` - è·å–ä»»åŠ¡æ¨¡æ¿
- `task:templates:get-all` - è·å–æ‰€æœ‰ä»»åŠ¡æ¨¡æ¿
- `task:templates:get-by-key-result` - æ ¹æ®å…³é”®ç»“æœè·å–ä»»åŠ¡æ¨¡æ¿
- `task:templates:create` - åˆ›å»ºä»»åŠ¡æ¨¡æ¿
- `task:templates:update` - æ›´æ–°ä»»åŠ¡æ¨¡æ¿
- `task:templates:delete` - åˆ é™¤ä»»åŠ¡æ¨¡æ¿
- `task:templates:activate` - æ¿€æ´»ä»»åŠ¡æ¨¡æ¿
- `task:templates:pause` - æš‚åœä»»åŠ¡æ¨¡æ¿
- `task:templates:resume` - æ¢å¤ä»»åŠ¡æ¨¡æ¿
- `task:templates:archive` - å½’æ¡£ä»»åŠ¡æ¨¡æ¿

#### ä»»åŠ¡å®ä¾‹ (Task Instances)
- `task:instances:get-by-id` - è·å–ä»»åŠ¡å®ä¾‹
- `task:instances:get-all` - è·å–æ‰€æœ‰ä»»åŠ¡å®ä¾‹
- `task:instances:get-today` - è·å–ä»Šæ—¥ä»»åŠ¡
- `task:instances:create` - åˆ›å»ºä»»åŠ¡å®ä¾‹
- `task:instances:complete` - å®Œæˆä»»åŠ¡
- `task:instances:undo-complete` - æ’¤é”€å®Œæˆä»»åŠ¡
- `task:instances:start` - å¼€å§‹ä»»åŠ¡
- `task:instances:cancel` - å–æ¶ˆä»»åŠ¡
- `task:instances:reschedule` - é‡æ–°å®‰æ’æ—¶é—´
- `task:instances:delete` - åˆ é™¤ä»»åŠ¡å®ä¾‹

#### æé†’ç›¸å…³
- `task:instances:trigger-reminder` - è§¦å‘æé†’
- `task:instances:snooze-reminder` - æ¨è¿Ÿæé†’
- `task:instances:dismiss-reminder` - å¿½ç•¥æé†’
- `task:instances:disable-reminders` - ç¦ç”¨æé†’
- `task:instances:enable-reminders` - å¯ç”¨æé†’

#### ç»Ÿè®¡åˆ†æ
- `task:stats:get-for-goal` - è·å–ç›®æ ‡ç›¸å…³ç»Ÿè®¡
- `task:stats:get-completion-timeline` - è·å–å®Œæˆæ—¶é—´çº¿

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­ä½¿ç”¨

```typescript
import { TaskServiceClient } from '@/modules/Task/services/taskServiceClient';

const taskClient = new TaskServiceClient();

// è·å–æ‰€æœ‰ä»»åŠ¡æ¨¡æ¿
const templates = await taskClient.getAllTaskTemplates();

// å®Œæˆä»»åŠ¡
const result = await taskClient.completeTask('task-id');
if (result.success) {
  console.log('Task completed successfully');
} else {
  console.error('Failed to complete task:', result.message);
}
```

### åœ¨ç»„åˆå¼å‡½æ•°ä¸­ä½¿ç”¨

```typescript
// æ›¿æ¢åŸæœ‰çš„ TaskApplicationService
// const taskApplicationService = new TaskApplicationService();
const taskServiceClient = new TaskServiceClient();

// ä½¿ç”¨æ–°çš„å®¢æˆ·ç«¯æ–¹æ³•
const templates = await taskServiceClient.getAllTaskTemplates();
```

## å¾…å®Œæˆçš„å·¥ä½œ

### 1. ç±»å‹å…¼å®¹æ€§é—®é¢˜

å½“å‰æ¸²æŸ“è¿›ç¨‹ä¸­çš„ç»„ä»¶æœŸæœ›ä½¿ç”¨é¢†åŸŸå¯¹è±¡ï¼ˆå¦‚ `TaskTemplate`ï¼‰ï¼Œä½†ç°åœ¨è¿”å›çš„æ˜¯ DTOã€‚éœ€è¦ï¼š

1. **åˆ›å»ºé€‚é…å™¨å±‚**ï¼šå°† DTO è½¬æ¢ä¸ºæ¸²æŸ“è¿›ç¨‹æ‰€éœ€çš„æ ¼å¼
2. **æ›´æ–°ç»„ä»¶é€»è¾‘**ï¼šç›´æ¥ä½¿ç”¨ DTO è€Œä¸æ˜¯é¢†åŸŸå¯¹è±¡
3. **ä¿®å¤ç±»å‹é”™è¯¯**ï¼šç¡®ä¿æ‰€æœ‰æ¥å£ä¿æŒä¸€è‡´

### 2. ç¼ºå¤±çš„æœåŠ¡æ–¹æ³•

ä»¥ä¸‹æ–¹æ³•éœ€è¦åœ¨ä¸»è¿›ç¨‹æœåŠ¡ä¸­å®ç°ï¼š

- `createTaskTemplateFromMeta()` - ä»å…ƒæ¨¡æ¿åˆ›å»ºä»»åŠ¡æ¨¡æ¿
- `createTaskInstance()` - åˆ›å»ºä»»åŠ¡å®ä¾‹
- `rescheduleTask()` - é‡æ–°å®‰æ’ä»»åŠ¡æ—¶é—´
- `deleteTaskInstance()` - åˆ é™¤ä»»åŠ¡å®ä¾‹
- æ‰€æœ‰æé†’ç›¸å…³çš„æ–¹æ³•

### 3. çŠ¶æ€ç®¡ç†è°ƒæ•´

æ¸²æŸ“è¿›ç¨‹ä¸­çš„çŠ¶æ€ç®¡ç†ï¼ˆPinia storesï¼‰éœ€è¦æ›´æ–°ä»¥é…åˆæ–°çš„æœåŠ¡æ¶æ„ï¼š

- ç§»é™¤ç›´æ¥çš„é¢†åŸŸå¯¹è±¡ä¾èµ–
- ä½¿ç”¨ DTO è¿›è¡ŒçŠ¶æ€ç®¡ç†
- è°ƒæ•´çŠ¶æ€æ›´æ–°é€»è¾‘

### 4. æ•°æ®æŒä¹…åŒ–

ç¡®ä¿ä¸»è¿›ç¨‹ä¸­çš„æ•°æ®è®¿é—®å±‚æ­£ç¡®é…ç½®ï¼š

- æ•°æ®åº“è¿æ¥
- ä»“å‚¨å®ç°
- äº‹åŠ¡å¤„ç†

## è¿ç§»æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¶æ„ï¼ˆå·²å®Œæˆï¼‰
- âœ… åˆ›å»ºä¸»è¿›ç¨‹æ¨¡å—ç»“æ„
- âœ… ç§»åŠ¨é¢†åŸŸå±‚åˆ°ä¸»è¿›ç¨‹
- âœ… å®ç° IPC å¤„ç†å™¨
- âœ… åˆ›å»ºæ¸²æŸ“è¿›ç¨‹å®¢æˆ·ç«¯

### ç¬¬äºŒé˜¶æ®µï¼šæœåŠ¡å®ç°ï¼ˆè¿›è¡Œä¸­ï¼‰
- ğŸ”„ ä¿®å¤ç±»å‹å…¼å®¹æ€§é—®é¢˜
- â³ å®ç°ç¼ºå¤±çš„æœåŠ¡æ–¹æ³•
- â³ æµ‹è¯• IPC é€šä¿¡

### ç¬¬ä¸‰é˜¶æ®µï¼šç»„ä»¶é€‚é…ï¼ˆå¾…å¼€å§‹ï¼‰
- â³ æ›´æ–°ç»„ä»¶ä»¥ä½¿ç”¨æ–°çš„æœåŠ¡å®¢æˆ·ç«¯
- â³ ä¿®å¤çŠ¶æ€ç®¡ç†é—®é¢˜
- â³ æ›´æ–°è¡¨å•éªŒè¯é€»è¾‘

### ç¬¬å››é˜¶æ®µï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆå¾…å¼€å§‹ï¼‰
- â³ ç«¯åˆ°ç«¯æµ‹è¯•
- â³ æ€§èƒ½ä¼˜åŒ–
- â³ é”™è¯¯å¤„ç†æ”¹è¿›

## æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç¡®ä¿ç°æœ‰çš„ç»„ä»¶èƒ½å¤Ÿå¹³æ»‘è¿‡æ¸¡
2. **é”™è¯¯å¤„ç†**ï¼šIPC è°ƒç”¨éœ€è¦é€‚å½“çš„é”™è¯¯å¤„ç†æœºåˆ¶
3. **ç±»å‹å®‰å…¨**ï¼šä¿æŒ TypeScript ç±»å‹å®‰å…¨
4. **æ€§èƒ½**ï¼šIPC é€šä¿¡å¯èƒ½å¼•å…¥è½»å¾®çš„æ€§èƒ½å¼€é”€
5. **è°ƒè¯•**ï¼šéœ€è¦åŒæ—¶è°ƒè¯•ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹

## ä¼˜åŠ¿

é‡æ„åçš„æ¶æ„å¸¦æ¥ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **å®‰å…¨æ€§**ï¼šä¸šåŠ¡é€»è¾‘åœ¨ä¸»è¿›ç¨‹ä¸­ï¼Œæ›´å®‰å…¨
2. **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„èŒè´£åˆ†ç¦»
3. **å¯æµ‹è¯•æ€§**ï¼šæ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•
4. **æ€§èƒ½**ï¼šæ›´å¥½çš„èµ„æºç®¡ç†
5. **æ‰©å±•æ€§**ï¼šä¾¿äºæ·»åŠ æ–°åŠŸèƒ½

## æ€»ç»“

è¿™æ¬¡é‡æ„å°† Task æ¨¡å—ä»å•è¿›ç¨‹æ¶æ„è½¬æ¢ä¸ºç¬¦åˆ Electron æœ€ä½³å®è·µçš„å¤šè¿›ç¨‹æ¶æ„ã€‚è™½ç„¶éœ€è¦ä¸€äº›é€‚é…å·¥ä½œï¼Œä½†é•¿æœŸæ¥çœ‹å°†æä¾›æ›´å¥½çš„æ¶æ„å’Œç”¨æˆ·ä½“éªŒã€‚

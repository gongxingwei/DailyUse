# Sprint 6 æ‰§è¡Œè®¡åˆ’

> **Sprint ID**: Sprint 6  
> **Sprint å‘¨æœŸ**: 2025-11-05 ~ 2025-11-18 (2 weeks)  
> **Sprint ç›®æ ‡**: å®Œæˆ Sprint 5 é—ç•™ + å®ç° KR æƒé‡å¿«ç…§å†å²åŠŸèƒ½  
> **Total Story Points**: 22 SP  
> **Primary Epic**: EPIC-GOAL-002 (KR Weight Snapshot - 18 SP)  
> **Secondary Tasks**: Sprint 5 æ”¶å°¾ (4 SP)  
> **çŠ¶æ€**: Planning  
> **å‰ç½®æ¡ä»¶**: Sprint 5 ä»£ç å®Œæˆï¼ˆ~85%ï¼‰ï¼Œæ•°æ®åº“æ¢å¤å¯ç”¨

---

## ğŸ“‹ Sprint 6 æ¦‚è§ˆ

### Sprint ä¸»é¢˜: **ç›®æ ‡æƒé‡å†å²è¿½è¸ª + ç³»ç»Ÿè´¨é‡æå‡**

Sprint 6 é‡‡ç”¨**æ··åˆç­–ç•¥**ï¼Œæ—¢å®Œæˆ Sprint 5 çš„æŠ€æœ¯æ”¶å°¾ï¼ˆæ•°æ®åº“è¿ç§»ã€æµ‹è¯•è¡¥å……ï¼‰ï¼Œåˆå¯åŠ¨æ–°åŠŸèƒ½å¼€å‘ï¼ˆKR æƒé‡å¿«ç…§å†å²ï¼‰ï¼Œç¡®ä¿æŠ€æœ¯å€ºåŠ¡ä¸ç´¯ç§¯çš„åŒæ—¶ä¿æŒåŠŸèƒ½è¿­ä»£èŠ‚å¥ã€‚

**ä¸ºä»€ä¹ˆé€‰æ‹© EPIC-GOAL-002ï¼Ÿ**

| Epic | RICE Score | Priority | ç†ç”± |
|------|------------|----------|------|
| **EPIC-GOAL-002** | **672 (æœ€é«˜)** | **P0** | âœ… ä¸šåŠ¡ä»·å€¼æœ€é«˜<br>âœ… Stories å·²å®Œæ•´å®šä¹‰<br>âœ… æŠ€æœ¯é£é™©ä½ï¼ˆå¤ç”¨ Goal æ¨¡å—ï¼‰ |
| EPIC-TASK-001 | 567 | P0 | âš ï¸ å¤æ‚åº¦é«˜ï¼ˆDAG ç®—æ³•ï¼‰<br>âš ï¸ éœ€è¦ 2.5 å‘¨ |
| EPIC-TASK-002 | 576 | P0 | å¯ä½œä¸º Sprint 7 å€™é€‰ |
| EPIC-GOAL-003 | 432 | P0 | å¯ä½œä¸º Sprint 7 å€™é€‰ |

**ä¸šåŠ¡ä»·å€¼**:
- ğŸ“Š **è¿½è¸ªæƒé‡å˜æ›´å†å²**: æ¯æ¬¡ KR æƒé‡è°ƒæ•´éƒ½ç”Ÿæˆå¿«ç…§ï¼Œæ”¯æŒå†å²å¯¹æ¯”
- ğŸ” **è¶‹åŠ¿åˆ†æ**: å¯è§†åŒ–æƒé‡å˜åŒ–è¶‹åŠ¿ï¼Œè¯†åˆ«ä¸åˆç†çš„é¢‘ç¹è°ƒæ•´
- â®ï¸ **å†å²æ¢å¤**: æ”¯æŒæ¢å¤åˆ°ä»»æ„å†å²æƒé‡é…ç½®
- ğŸ“ˆ **å®¡è®¡è¿½æº¯**: æ»¡è¶³ OKR ç®¡ç†çš„å®¡è®¡éœ€æ±‚

---

## ğŸ¯ Sprint 6 ç›®æ ‡ (Sprint Goal)

> **å®Œæˆæ—¥ç¨‹å†²çªæ£€æµ‹ç³»ç»Ÿçš„æ•°æ®åº“é›†æˆï¼Œå¹¶å®ç° KR æƒé‡å¿«ç…§å†å²è¿½è¸ªåŠŸèƒ½ï¼Œç¡®ä¿ç›®æ ‡ç®¡ç†çš„æ•°æ®å®Œæ•´æ€§å’Œå¯è¿½æº¯æ€§ã€‚**

### Week 1 ç„¦ç‚¹: Sprint 5 æ”¶å°¾ + EPIC-GOAL-002 åŸºç¡€å±‚

- âœ… å®Œæˆ Sprint 5 æ•°æ®åº“è¿ç§»ï¼ˆStory 9.3ï¼‰
- âœ… å®Œæˆå…³é”®å•å…ƒæµ‹è¯•
- âœ… å®ç° EPIC-GOAL-002 çš„ Contractsã€Domainã€Application å±‚

### Week 2 ç„¦ç‚¹: EPIC-GOAL-002 å®Œæ•´å®ç°

- âœ… å®ç° Infrastructureã€APIã€Clientã€UI å±‚
- âœ… E2E æµ‹è¯•éªŒè¯
- âœ… é›†æˆåˆ°ç°æœ‰ Goal ç®¡ç†ç•Œé¢

---

## ğŸ“¦ Story åˆ†è§£ä¸ä¼˜å…ˆçº§

### **Part A: Sprint 5 æ”¶å°¾å·¥ä½œ (4 SP) - Week 1**

#### âœ… Task A.1: æ•°æ®åº“è¿ç§»ä¸éªŒè¯ (2 SP) - P0

**æè¿°**: å®Œæˆ Sprint 5 Story 9.3 çš„æ•°æ®åº“æ“ä½œ

**ä»»åŠ¡æ¸…å•**:
- [ ] ç¡®è®¤ Neon æ•°æ®åº“å¯ç”¨ï¼ˆç”¨æˆ·æ‰‹åŠ¨æ¢å¤ï¼‰
- [ ] è¿è¡Œ Prisma è¿ç§»: `pnpm prisma migrate dev --name add-schedule-model`
- [ ] è¿è¡Œ Prisma ç”Ÿæˆ: `pnpm prisma generate`
- [ ] éªŒè¯ `PrismaScheduleRepository` ç±»å‹æ­£ç¡®
- [ ] æ‰‹åŠ¨æµ‹è¯•åŸºç¡€ CRUD æ“ä½œ

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: Prisma è¿ç§»æˆåŠŸ
  Given Neon æ•°æ®åº“å·²æ¢å¤è¿æ¥
  When è¿è¡Œ prisma migrate dev
  Then Schedule è¡¨æˆåŠŸåˆ›å»º
  And ç´¢å¼• (userId, startTime, endTime) å·²åˆ›å»º
  And æ—  TypeScript ç±»å‹é”™è¯¯

Scenario: Repository é›†æˆæµ‹è¯•
  Given Prisma å®¢æˆ·ç«¯å·²ç”Ÿæˆ
  When è°ƒç”¨ scheduleRepository.save(schedule)
  Then æ•°æ®æˆåŠŸå†™å…¥æ•°æ®åº“
  And å¯ä»¥é€šè¿‡ findConflicts() æŸ¥è¯¢
```

**é¢„ä¼°æ—¶é—´**: 0.5 å¤©ï¼ˆå‡è®¾æ•°æ®åº“å¯ç”¨ï¼‰

---

#### âœ… Task A.2: å•å…ƒæµ‹è¯•è¡¥å…… (2 SP) - P1

**æè¿°**: å®Œæˆ Sprint 5 é—ç•™çš„å…³é”®å•å…ƒæµ‹è¯•

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ­£ `scheduleApiClient.spec.ts` ç±»å‹é”™è¯¯ï¼ˆ20 åˆ†é’Ÿï¼‰
  - ä¿®æ­£å¯¼å…¥è·¯å¾„: `@/shared/api/instances`
  - ä¿®æ­£ç±»å‹å: `ScheduleClientDTO`
  - ä¿®æ­£å±æ€§å: `resolution`, `applied`
- [ ] è¿è¡Œå¹¶éªŒè¯ API Client æµ‹è¯•é€šè¿‡
- [ ] ç¼–å†™ `useSchedule.spec.ts` composable æµ‹è¯•ï¼ˆ3-5 ä¸ªæ ¸å¿ƒæµ‹è¯•ï¼‰
- [ ] å¯é€‰: `PrismaScheduleRepository` é›†æˆæµ‹è¯•ï¼ˆå¦‚æ—¶é—´å…è®¸ï¼‰

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: API Client æµ‹è¯•é€šè¿‡
  Given ç±»å‹é”™è¯¯å·²ä¿®æ­£
  When è¿è¡Œ vitest scheduleApiClient.spec.ts
  Then æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆé¢„è®¡ 15-20 ä¸ªæµ‹è¯•ï¼‰
  And è¦†ç›– detectConflicts, createSchedule, resolveConflict

Scenario: Composable æµ‹è¯•é€šè¿‡
  Given useSchedule composable å·²å®ç°
  When è¿è¡Œ vitest useSchedule.spec.ts
  Then æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡
  And è¦†ç›– conflict detection state, API integration
```

**é¢„ä¼°æ—¶é—´**: 1 å¤©

**ä¼˜å…ˆçº§è¯´æ˜**: æ ‡è®°ä¸º P1ï¼Œå¦‚ Week 1 æ—¶é—´ç´§å¼ å¯æ¨è¿Ÿåˆ° Week 2 æˆ– Sprint 7

---

### **Part B: EPIC-GOAL-002 å®ç° (18 SP) - Week 1 & 2**

#### Story GOAL-002-001: Contracts & Domain (3 SP) - P0 - **Week 1 Day 2**

**User Story**:
```gherkin
As a å¼€å‘è€…
I want å®šä¹‰æƒé‡å¿«ç…§çš„ Contracts å’Œ Domain å®ä½“
So that å‰åç«¯æœ‰ç»Ÿä¸€çš„æ•°æ®ç»“æ„
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `KeyResultWeightSnapshotServerDTO` (Contracts)
  ```typescript
  export interface KeyResultWeightSnapshotServerDTO {
    uuid: string;
    goalUuid: string;
    keyResultUuid: string;
    oldWeight: number; // è°ƒæ•´å‰æƒé‡ (0-100)
    newWeight: number; // è°ƒæ•´åæƒé‡ (0-100)
    weightDelta: number; // è‡ªåŠ¨è®¡ç®—: newWeight - oldWeight
    snapshotTime: number; // timestamp
    trigger: 'manual' | 'auto_balance' | 'kr_delete' | 'system';
    operatorUuid?: string; // æ“ä½œäººï¼ˆå¦‚æœæ˜¯æ‰‹åŠ¨ï¼‰
    reason?: string; // è°ƒæ•´åŸå› ï¼ˆå¯é€‰ï¼‰
    createdAt: number;
  }
  ```

- [ ] åˆ›å»º Domain å€¼å¯¹è±¡ `WeightSnapshot`
  ```typescript
  export class WeightSnapshot extends ValueObject {
    constructor(
      public readonly keyResultUuid: string,
      public readonly oldWeight: number,
      public readonly newWeight: number,
      public readonly snapshotTime: number,
      public readonly trigger: string,
      public readonly operatorUuid?: string,
      public readonly reason?: string
    ) {
      super();
      this.validate();
    }

    private validate(): void {
      if (this.oldWeight < 0 || this.oldWeight > 100) {
        throw new InvalidWeightError('æ—§æƒé‡å¿…é¡»åœ¨ 0-100 ä¹‹é—´');
      }
      if (this.newWeight < 0 || this.newWeight > 100) {
        throw new InvalidWeightError('æ–°æƒé‡å¿…é¡»åœ¨ 0-100 ä¹‹é—´');
      }
    }

    get weightDelta(): number {
      return this.newWeight - this.oldWeight;
    }
  }
  ```

- [ ] æ‰©å±• `Goal` èšåˆæ ¹
  ```typescript
  export class Goal extends AggregateRoot {
    private weightSnapshots: WeightSnapshot[] = [];

    /**
     * è®°å½•æƒé‡å¿«ç…§
     */
    recordWeightSnapshot(
      krUuid: string,
      oldWeight: number,
      newWeight: number,
      trigger: string,
      operatorUuid?: string,
      reason?: string
    ): void {
      const snapshot = new WeightSnapshot(
        krUuid,
        oldWeight,
        newWeight,
        Date.now(),
        trigger,
        operatorUuid,
        reason
      );

      this.weightSnapshots.push(snapshot);
      this.addDomainEvent(new WeightSnapshotCreatedEvent(this.uuid, snapshot));
    }
  }
  ```

- [ ] ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡ â‰¥ 80%ï¼‰

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: DTO ç»“æ„å®Œæ•´
  Given KeyResultWeightSnapshotServerDTO å·²å®šä¹‰
  Then åº”åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
  And weightDelta è‡ªåŠ¨è®¡ç®—
  And trigger æ”¯æŒ 4 ç§ç±»å‹

Scenario: Domain éªŒè¯é€»è¾‘
  Given WeightSnapshot å€¼å¯¹è±¡
  When oldWeight = -10
  Then æŠ›å‡º InvalidWeightError
  And é”™è¯¯æ¶ˆæ¯ä¸º "æ—§æƒé‡å¿…é¡»åœ¨ 0-100 ä¹‹é—´"
```

**Story Points**: 3 SP  
**é¢„ä¼°æ—¶é—´**: 1-1.5 å¤©

---

#### Story GOAL-002-002: Application Service (3 SP) - P0 - **Week 1 Day 3**

**User Story**:
```gherkin
As a åç«¯å¼€å‘è€…
I want åœ¨ KR æƒé‡æ›´æ–°æ—¶è‡ªåŠ¨åˆ›å»ºå¿«ç…§
So that æ¯æ¬¡æƒé‡å˜æ›´éƒ½è¢«è®°å½•
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `WeightSnapshotApplicationService`
- [ ] å®ç° `createSnapshot()` æ–¹æ³•
- [ ] åœ¨ `UpdateKeyResultService` ä¸­é›†æˆå¿«ç…§åˆ›å»º
- [ ] å®ç°æƒé‡æ€»å’Œæ ¡éªŒï¼ˆç¡®ä¿ = 100%ï¼‰
- [ ] å®ç°äº‹åŠ¡ç®¡ç†ï¼ˆåŸå­æ€§ï¼‰
- [ ] ç¼–å†™é›†æˆæµ‹è¯•

**æ ¸å¿ƒä»£ç **:
```typescript
export class WeightSnapshotApplicationService {
  constructor(
    private goalRepository: GoalRepository,
    private weightSnapshotRepository: WeightSnapshotRepository
  ) {}

  async createSnapshot(params: {
    goalUuid: string;
    krUuid: string;
    oldWeight: number;
    newWeight: number;
    trigger: string;
    operatorUuid?: string;
    reason?: string;
  }): Promise<void> {
    // 1. è·å– Goal èšåˆæ ¹
    const goal = await this.goalRepository.findByUuid(params.goalUuid);
    if (!goal) throw new GoalNotFoundError();

    // 2. è°ƒç”¨ Domain æ–¹æ³•è®°å½•å¿«ç…§
    goal.recordWeightSnapshot(
      params.krUuid,
      params.oldWeight,
      params.newWeight,
      params.trigger,
      params.operatorUuid,
      params.reason
    );

    // 3. æŒä¹…åŒ–ï¼ˆé€šè¿‡ Domain Event æˆ–ç›´æ¥ä¿å­˜ï¼‰
    await this.goalRepository.save(goal);
  }

  /**
   * æ›´æ–° KR æƒé‡ï¼ˆé›†æˆå¿«ç…§åˆ›å»ºï¼‰
   */
  async updateKeyResultWeight(params: {
    goalUuid: string;
    krUuid: string;
    newWeight: number;
    operatorUuid: string;
    reason?: string;
  }): Promise<void> {
    const goal = await this.goalRepository.findByUuid(params.goalUuid);
    const kr = goal.getKeyResult(params.krUuid);
    const oldWeight = kr.weight;

    // æ ¡éªŒæƒé‡æ€»å’Œ
    this.validateWeightSum(goal, params.krUuid, params.newWeight);

    // å¼€å§‹äº‹åŠ¡
    await this.goalRepository.transaction(async () => {
      // 1. åˆ›å»ºå¿«ç…§
      await this.createSnapshot({
        goalUuid: params.goalUuid,
        krUuid: params.krUuid,
        oldWeight,
        newWeight: params.newWeight,
        trigger: 'manual',
        operatorUuid: params.operatorUuid,
        reason: params.reason
      });

      // 2. æ›´æ–°æƒé‡
      kr.updateWeight(params.newWeight);
      await this.goalRepository.save(goal);
    });
  }

  private validateWeightSum(goal: Goal, krUuid: string, newWeight: number): void {
    const otherKRsWeightSum = goal.keyResults
      .filter(kr => kr.uuid !== krUuid)
      .reduce((sum, kr) => sum + kr.weight, 0);

    if (otherKRsWeightSum + newWeight !== 100) {
      throw new InvalidWeightDistributionError(
        `æƒé‡æ€»å’Œå¿…é¡»ä¸º 100%ï¼Œå½“å‰ä¸º ${otherKRsWeightSum + newWeight}%`
      );
    }
  }
}
```

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: æƒé‡æ›´æ–°æ—¶è‡ªåŠ¨åˆ›å»ºå¿«ç…§
  Given ç›®æ ‡æœ‰ KR1 æƒé‡ä¸º 30%
  When è°ƒç”¨ updateKeyResultWeight(kr1, 50%)
  Then å…ˆåˆ›å»ºå¿«ç…§ (oldWeight=30, newWeight=50)
  And å†æ›´æ–° KR æƒé‡ä¸º 50%
  And å¦‚æœå¿«ç…§å¤±è´¥ï¼Œæƒé‡æ›´æ–°å›æ»š

Scenario: æƒé‡æ€»å’Œæ ¡éªŒ
  Given ç›®æ ‡æœ‰ 3 ä¸ª KR (30%, 40%, 30%)
  When å°è¯•å°† KR1 æ”¹ä¸º 80% (æ€»å’Œ > 100%)
  Then æŠ›å‡º InvalidWeightDistributionError
  And ä¸åˆ›å»ºå¿«ç…§
```

**Story Points**: 3 SP  
**é¢„ä¼°æ—¶é—´**: 1-1.5 å¤©

---

#### Story GOAL-002-003: Infrastructure & Repository (2 SP) - P0 - **Week 1 Day 4**

**User Story**:
```gherkin
As a åç«¯å¼€å‘è€…
I want å®ç°æƒé‡å¿«ç…§çš„æ•°æ®åº“æ“ä½œ
So that å¿«ç…§æ•°æ®å¯æŒä¹…åŒ–å­˜å‚¨å’ŒæŸ¥è¯¢
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º Prisma Schema
  ```prisma
  model KeyResultWeightSnapshot {
    uuid           String   @id @default(uuid())
    goalUuid       String   @map("goal_uuid")
    keyResultUuid  String   @map("key_result_uuid")
    
    oldWeight      Float    @map("old_weight")
    newWeight      Float    @map("new_weight")
    weightDelta    Float    @map("weight_delta")
    
    snapshotTime   DateTime @map("snapshot_time")
    trigger        String   // 'manual' | 'auto_balance' | 'kr_delete' | 'system'
    operatorUuid   String?  @map("operator_uuid")
    reason         String?
    
    createdAt      DateTime @default(now()) @map("created_at")
    
    goal          Goal       @relation(fields: [goalUuid], references: [uuid])
    keyResult     KeyResult  @relation(fields: [keyResultUuid], references: [uuid])
    
    @@index([goalUuid, snapshotTime(sort: Desc)])
    @@index([keyResultUuid, snapshotTime(sort: Desc)])
    @@map("key_result_weight_snapshots")
  }
  ```

- [ ] è¿è¡Œè¿ç§»: `pnpm prisma migrate dev --name add-weight-snapshot`
- [ ] å®ç° `WeightSnapshotRepository`
  ```typescript
  export class PrismaWeightSnapshotRepository implements WeightSnapshotRepository {
    async save(goalUuid: string, snapshot: WeightSnapshot): Promise<void> {
      await prisma.keyResultWeightSnapshot.create({
        data: {
          uuid: uuidv4(),
          goalUuid,
          keyResultUuid: snapshot.keyResultUuid,
          oldWeight: snapshot.oldWeight,
          newWeight: snapshot.newWeight,
          weightDelta: snapshot.weightDelta,
          snapshotTime: new Date(snapshot.snapshotTime),
          trigger: snapshot.trigger,
          operatorUuid: snapshot.operatorUuid,
          reason: snapshot.reason
        }
      });
    }

    async findByGoalUuid(
      goalUuid: string,
      options?: { limit?: number; offset?: number }
    ): Promise<WeightSnapshot[]> {
      const snapshots = await prisma.keyResultWeightSnapshot.findMany({
        where: { goalUuid },
        orderBy: { snapshotTime: 'desc' },
        take: options?.limit,
        skip: options?.offset
      });

      return snapshots.map(this.toDomain);
    }
  }
  ```

- [ ] ç¼–å†™ Repository æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: Schema æ­£ç¡®å®šä¹‰
  Given Prisma Schema å·²æ›´æ–°
  Then KeyResultWeightSnapshot æ¨¡å‹åŒ…å«æ‰€æœ‰å­—æ®µ
  And ç´¢å¼• (goalUuid, snapshotTime DESC) å·²åˆ›å»º

Scenario: Repository æŸ¥è¯¢
  Given ç›®æ ‡æœ‰ 5 æ¡å¿«ç…§
  When è°ƒç”¨ findByGoalUuid(goalUuid, {limit: 3})
  Then è¿”å›æœ€æ–° 3 æ¡å¿«ç…§
  And æŒ‰ snapshotTime é™åºæ’åˆ—
```

**Story Points**: 2 SP  
**é¢„ä¼°æ—¶é—´**: 0.5 å¤©

---

#### Story GOAL-002-004: API Endpoints (3 SP) - P0 - **Week 2 Day 1**

**User Story**:
```gherkin
As a å‰ç«¯å¼€å‘è€…
I want è°ƒç”¨æƒé‡å¿«ç…§çš„ HTTP API
So that Web/Desktop å¯æŸ¥è¯¢å¿«ç…§å†å²
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `WeightSnapshotController`
- [ ] å®ç° `GET /api/goals/:goalId/weight-snapshots` (æŸ¥è¯¢ç›®æ ‡å¿«ç…§)
- [ ] å®ç° `GET /api/goals/:goalId/key-results/:krId/snapshots` (æŸ¥è¯¢å•ä¸ª KR å¿«ç…§)
- [ ] æ”¯æŒæŸ¥è¯¢å‚æ•°: `limit`, `offset`, `startTime`, `endTime`, `trigger`
- [ ] æ·»åŠ  Zod éªŒè¯
- [ ] æ·»åŠ æƒé™æ£€æŸ¥ï¼ˆç”¨æˆ·å¿…é¡»æ˜¯ç›®æ ‡æˆå‘˜ï¼‰
- [ ] ç¼–å†™ API æµ‹è¯•
- [ ] æ›´æ–° Swagger æ–‡æ¡£

**æ ¸å¿ƒä»£ç **:
```typescript
@Controller('/api/goals/:goalId/weight-snapshots')
export class WeightSnapshotController {
  @Get('/')
  async getGoalSnapshots(
    @Param('goalId') goalId: string,
    @Query() query: GetSnapshotsQuerySchema
  ): Promise<KeyResultWeightSnapshotServerDTO[]> {
    // æƒé™æ£€æŸ¥
    await this.checkGoalAccess(goalId, req.user.uuid);

    const snapshots = await this.weightSnapshotService.getGoalSnapshots(
      goalId,
      {
        limit: query.limit,
        offset: query.offset,
        startTime: query.startTime,
        endTime: query.endTime,
        trigger: query.trigger
      }
    );

    return snapshots.map(this.toDTO);
  }

  @Get('/key-results/:krId')
  async getKeyResultSnapshots(
    @Param('goalId') goalId: string,
    @Param('krId') krId: string,
    @Query() query: GetSnapshotsQuerySchema
  ): Promise<KeyResultWeightSnapshotServerDTO[]> {
    await this.checkGoalAccess(goalId, req.user.uuid);

    const snapshots = await this.weightSnapshotService.getKeyResultSnapshots(
      krId,
      query
    );

    return snapshots.map(this.toDTO);
  }
}

// Zod Schema
const GetSnapshotsQuerySchema = z.object({
  limit: z.coerce.number().min(1).max(100).default(20),
  offset: z.coerce.number().min(0).default(0),
  startTime: z.coerce.number().optional(),
  endTime: z.coerce.number().optional(),
  trigger: z.enum(['manual', 'auto_balance', 'kr_delete', 'system']).optional()
});
```

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: GET ç›®æ ‡å¿«ç…§
  Given ç”¨æˆ·æ˜¯ç›®æ ‡æˆå‘˜
  And ç›®æ ‡æœ‰ 10 æ¡å¿«ç…§
  When GET /api/goals/:id/weight-snapshots?limit=5
  Then è¿”å› 200
  And å“åº”åŒ…å« 5 æ¡å¿«ç…§
  And æŒ‰ snapshotTime é™åº

Scenario: ç­›é€‰å¿«ç…§
  When GET /api/goals/:id/weight-snapshots?trigger=manual&startTime=xxx
  Then è¿”å›ä»…æ‰‹åŠ¨è°ƒæ•´çš„å¿«ç…§
  And æ—¶é—´ >= startTime

Scenario: æƒé™æ£€æŸ¥
  Given ç”¨æˆ·ä¸æ˜¯ç›®æ ‡æˆå‘˜
  When å‘é€ä»»ä½•è¯·æ±‚
  Then è¿”å› 403
```

**Story Points**: 3 SP  
**é¢„ä¼°æ—¶é—´**: 1-1.5 å¤©

---

#### Story GOAL-002-005: Client Services (2 SP) - P0 - **Week 2 Day 2**

**User Story**:
```gherkin
As a å‰ç«¯å¼€å‘è€…
I want å°è£…æƒé‡å¿«ç…§çš„ HTTP è°ƒç”¨
So that UI ç»„ä»¶å¯æ–¹ä¾¿è·å–å¿«ç…§æ•°æ®
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `WeightSnapshotClientService`
- [ ] å®ç° `getGoalSnapshots()` æ–¹æ³•
- [ ] å®ç° `getKeyResultSnapshots()` æ–¹æ³•
- [ ] å®ç° `compareSnapshots()` æ–¹æ³•ï¼ˆå¯¹æ¯”åˆ†æï¼‰
- [ ] é›†æˆ Vue composableï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ·»åŠ é”™è¯¯å¤„ç†
- [ ] ç¼–å†™å®¢æˆ·ç«¯æµ‹è¯•

**æ ¸å¿ƒä»£ç **:
```typescript
// apps/web/src/modules/goal/infrastructure/api/weightSnapshotApiClient.ts
export const weightSnapshotApiClient = {
  /**
   * è·å–ç›®æ ‡çš„æƒé‡å¿«ç…§å†å²
   */
  async getGoalSnapshots(
    goalUuid: string,
    options?: {
      limit?: number;
      offset?: number;
      startTime?: number;
      endTime?: number;
      trigger?: string;
    }
  ): Promise<KeyResultWeightSnapshotClientDTO[]> {
    const params = new URLSearchParams();
    if (options?.limit) params.append('limit', String(options.limit));
    if (options?.offset) params.append('offset', String(options.offset));
    if (options?.startTime) params.append('startTime', String(options.startTime));
    if (options?.endTime) params.append('endTime', String(options.endTime));
    if (options?.trigger) params.append('trigger', options.trigger);

    const response = await apiClient.get(
      `/api/goals/${goalUuid}/weight-snapshots?${params}`
    );

    return response.data;
  },

  /**
   * è·å–å•ä¸ª KR çš„å¿«ç…§å†å²
   */
  async getKeyResultSnapshots(
    goalUuid: string,
    krUuid: string,
    options?: { limit?: number; offset?: number }
  ): Promise<KeyResultWeightSnapshotClientDTO[]> {
    const params = new URLSearchParams();
    if (options?.limit) params.append('limit', String(options.limit));
    if (options?.offset) params.append('offset', String(options.offset));

    const response = await apiClient.get(
      `/api/goals/${goalUuid}/key-results/${krUuid}/snapshots?${params}`
    );

    return response.data;
  },

  /**
   * å¯¹æ¯”ä¸¤ä¸ªæ—¶é—´ç‚¹çš„æƒé‡é…ç½®
   */
  async compareSnapshots(
    goalUuid: string,
    time1: number,
    time2: number
  ): Promise<{
    time1Snapshots: KeyResultWeightSnapshotClientDTO[];
    time2Snapshots: KeyResultWeightSnapshotClientDTO[];
    changes: {
      krUuid: string;
      krTitle: string;
      oldWeight: number;
      newWeight: number;
      delta: number;
    }[];
  }> {
    // è·å–ä¸¤ä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§
    const snapshots1 = await this.getGoalSnapshots(goalUuid, {
      startTime: time1 - 1000,
      endTime: time1 + 1000,
      limit: 100
    });

    const snapshots2 = await this.getGoalSnapshots(goalUuid, {
      startTime: time2 - 1000,
      endTime: time2 + 1000,
      limit: 100
    });

    // è®¡ç®—å˜åŒ–
    const changes = this.calculateWeightChanges(snapshots1, snapshots2);

    return {
      time1Snapshots: snapshots1,
      time2Snapshots: snapshots2,
      changes
    };
  }
};

// Vue Composable (å¯é€‰)
export function useWeightSnapshot(goalUuid: Ref<string>) {
  const snapshots = ref<KeyResultWeightSnapshotClientDTO[]>([]);
  const loading = ref(false);
  const error = ref<Error | null>(null);

  const loadSnapshots = async (options?: { limit?: number }) => {
    loading.value = true;
    error.value = null;

    try {
      snapshots.value = await weightSnapshotApiClient.getGoalSnapshots(
        goalUuid.value,
        options
      );
    } catch (e) {
      error.value = e as Error;
    } finally {
      loading.value = false;
    }
  };

  return {
    snapshots,
    loading,
    error,
    loadSnapshots
  };
}
```

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: è·å–ç›®æ ‡å¿«ç…§
  Given ç”¨æˆ·å·²ç™»å½•
  When è°ƒç”¨ getGoalSnapshots(goalUuid, {limit: 10})
  Then å‘é€ GET è¯·æ±‚åˆ° API
  And è¿”å› KeyResultWeightSnapshotClientDTO[]

Scenario: å¯¹æ¯”å¿«ç…§
  When è°ƒç”¨ compareSnapshots(goalUuid, time1, time2)
  Then è¿”å›ä¸¤ä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§
  And è¿”å› changes æ•°ç»„æ˜¾ç¤ºæƒé‡å˜åŒ–
```

**Story Points**: 2 SP  
**é¢„ä¼°æ—¶é—´**: 0.5-1 å¤©

---

#### Story GOAL-002-006: UI Component - å†å²åˆ—è¡¨ (3 SP) - P0 - **Week 2 Day 3**

**User Story**:
```gherkin
As a ç”¨æˆ·
I want æŸ¥çœ‹ç›®æ ‡çš„æƒé‡è°ƒæ•´å†å²
So that æˆ‘èƒ½è¿½æº¯æ¯æ¬¡æƒé‡å˜æ›´
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `WeightSnapshotHistory.vue` ç»„ä»¶
- [ ] æ˜¾ç¤ºå¿«ç…§åˆ—è¡¨ï¼ˆæ—¶é—´ã€è§¦å‘æ–¹å¼ã€æƒé‡å˜åŒ–ï¼‰
- [ ] æ”¯æŒç­›é€‰ï¼ˆæŒ‰è§¦å‘æ–¹å¼ã€æ—¶é—´èŒƒå›´ï¼‰
- [ ] æ”¯æŒåˆ†é¡µåŠ è½½
- [ ] é¢œè‰²ç¼–ç æƒé‡å˜åŒ–ï¼ˆå¢åŠ /å‡å°‘ï¼‰
- [ ] æ”¯æŒå±•å¼€æŸ¥çœ‹è¯¦æƒ…
- [ ] å“åº”å¼è®¾è®¡

**UI è®¾è®¡**:
```vue
<template>
  <v-card>
    <v-card-title>
      <v-icon>mdi-history</v-icon>
      æƒé‡è°ƒæ•´å†å²
    </v-card-title>

    <!-- ç­›é€‰å™¨ -->
    <v-card-text>
      <v-row>
        <v-col cols="4">
          <v-select
            v-model="filter.trigger"
            :items="triggerOptions"
            label="è§¦å‘æ–¹å¼"
            clearable
          />
        </v-col>
        <v-col cols="4">
          <v-text-field
            v-model="filter.startDate"
            type="date"
            label="å¼€å§‹æ—¥æœŸ"
          />
        </v-col>
        <v-col cols="4">
          <v-text-field
            v-model="filter.endDate"
            type="date"
            label="ç»“æŸæ—¥æœŸ"
          />
        </v-col>
      </v-row>
    </v-card-text>

    <!-- å¿«ç…§åˆ—è¡¨ -->
    <v-list>
      <v-list-item
        v-for="snapshot in snapshots"
        :key="snapshot.uuid"
        @click="toggleExpand(snapshot.uuid)"
      >
        <template #prepend>
          <v-avatar :color="getChangeColor(snapshot.weightDelta)">
            <v-icon>{{ getChangeIcon(snapshot.weightDelta) }}</v-icon>
          </v-avatar>
        </template>

        <v-list-item-title>
          {{ snapshot.keyResultTitle }}
        </v-list-item-title>

        <v-list-item-subtitle>
          {{ formatTime(snapshot.snapshotTime) }} â€¢ 
          {{ getTriggerLabel(snapshot.trigger) }} â€¢
          <span :class="getWeightChangeClass(snapshot.weightDelta)">
            {{ snapshot.oldWeight }}% â†’ {{ snapshot.newWeight }}%
            ({{ snapshot.weightDelta > 0 ? '+' : '' }}{{ snapshot.weightDelta }}%)
          </span>
        </v-list-item-subtitle>

        <!-- å±•å¼€è¯¦æƒ… -->
        <v-expand-transition>
          <div v-if="expandedIds.includes(snapshot.uuid)" class="mt-2">
            <v-divider class="mb-2" />
            <div class="text-caption">
              <div v-if="snapshot.operatorName">
                æ“ä½œäºº: {{ snapshot.operatorName }}
              </div>
              <div v-if="snapshot.reason">
                åŸå› : {{ snapshot.reason }}
              </div>
              <div>
                UUID: {{ snapshot.uuid }}
              </div>
            </div>
          </div>
        </v-expand-transition>
      </v-list-item>
    </v-list>

    <!-- åŠ è½½æ›´å¤š -->
    <v-card-actions v-if="hasMore">
      <v-btn
        block
        :loading="loading"
        @click="loadMore"
      >
        åŠ è½½æ›´å¤š
      </v-btn>
    </v-card-actions>
  </v-card>
</template>

<script setup lang="ts">
import { ref, onMounted, computed } from 'vue';
import { useWeightSnapshot } from '../composables/useWeightSnapshot';

const props = defineProps<{
  goalUuid: string;
}>();

const { snapshots, loading, loadSnapshots } = useWeightSnapshot(
  computed(() => props.goalUuid)
);

const filter = ref({
  trigger: null,
  startDate: null,
  endDate: null
});

const expandedIds = ref<string[]>([]);
const page = ref(0);
const pageSize = 20;

const hasMore = computed(() => snapshots.value.length >= (page.value + 1) * pageSize);

const triggerOptions = [
  { title: 'æ‰‹åŠ¨è°ƒæ•´', value: 'manual' },
  { title: 'è‡ªåŠ¨å¹³è¡¡', value: 'auto_balance' },
  { title: 'KR åˆ é™¤', value: 'kr_delete' },
  { title: 'ç³»ç»Ÿè°ƒæ•´', value: 'system' }
];

onMounted(() => {
  loadSnapshots({ limit: pageSize });
});

const loadMore = async () => {
  page.value++;
  await loadSnapshots({
    limit: pageSize,
    offset: page.value * pageSize
  });
};

const toggleExpand = (uuid: string) => {
  const index = expandedIds.value.indexOf(uuid);
  if (index > -1) {
    expandedIds.value.splice(index, 1);
  } else {
    expandedIds.value.push(uuid);
  }
};

const getChangeColor = (delta: number) => {
  if (delta > 0) return 'success';
  if (delta < 0) return 'warning';
  return 'grey';
};

const getChangeIcon = (delta: number) => {
  if (delta > 0) return 'mdi-arrow-up';
  if (delta < 0) return 'mdi-arrow-down';
  return 'mdi-minus';
};

const getWeightChangeClass = (delta: number) => {
  if (delta > 0) return 'text-success';
  if (delta < 0) return 'text-warning';
  return '';
};

const getTriggerLabel = (trigger: string) => {
  const labels = {
    manual: 'æ‰‹åŠ¨è°ƒæ•´',
    auto_balance: 'è‡ªåŠ¨å¹³è¡¡',
    kr_delete: 'KR åˆ é™¤',
    system: 'ç³»ç»Ÿè°ƒæ•´'
  };
  return labels[trigger] || trigger;
};

const formatTime = (timestamp: number) => {
  return new Date(timestamp).toLocaleString('zh-CN');
};
</script>
```

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: æ˜¾ç¤ºå¿«ç…§å†å²
  Given ç›®æ ‡æœ‰ 15 æ¡æƒé‡å¿«ç…§
  When ç”¨æˆ·æ‰“å¼€æƒé‡å†å²
  Then æ˜¾ç¤ºæœ€æ–° 20 æ¡å¿«ç…§
  And æŒ‰æ—¶é—´é™åºæ’åˆ—
  And æ¯æ¡å¿«ç…§æ˜¾ç¤º: æ—¶é—´ã€KR åç§°ã€æƒé‡å˜åŒ–ã€è§¦å‘æ–¹å¼

Scenario: ç­›é€‰å¿«ç…§
  When ç”¨æˆ·é€‰æ‹©è§¦å‘æ–¹å¼ä¸º "æ‰‹åŠ¨è°ƒæ•´"
  Then ä»…æ˜¾ç¤ºæ‰‹åŠ¨è§¦å‘çš„å¿«ç…§

Scenario: åŠ è½½æ›´å¤š
  When ç”¨æˆ·ç‚¹å‡» "åŠ è½½æ›´å¤š"
  Then åŠ è½½ä¸‹ä¸€é¡µå¿«ç…§
  And è¿½åŠ åˆ°åˆ—è¡¨æœ«å°¾
```

**Story Points**: 3 SP  
**é¢„ä¼°æ—¶é—´**: 1-1.5 å¤©

---

#### Story GOAL-002-007: UI - æƒé‡å¯¹æ¯”è§†å›¾ (2 SP) - P1 - **Week 2 Day 4**

**User Story**:
```gherkin
As a ç”¨æˆ·
I want å¯¹æ¯”ä¸¤ä¸ªæ—¶é—´ç‚¹çš„æƒé‡é…ç½®
So that æˆ‘èƒ½åˆ†ææƒé‡è°ƒæ•´çš„å½±å“
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `WeightComparison.vue` ç»„ä»¶
- [ ] æ—¶é—´é€‰æ‹©å™¨ï¼ˆé€‰æ‹©ä¸¤ä¸ªå¯¹æ¯”æ—¶é—´ç‚¹ï¼‰
- [ ] å¹¶æ’æ˜¾ç¤ºæƒé‡é…ç½®
- [ ] é«˜äº®æ˜¾ç¤ºå˜åŒ–çš„ KR
- [ ] å¯è§†åŒ–æƒé‡å˜åŒ–ï¼ˆæ¡å½¢å›¾/é¥¼å›¾ï¼‰
- [ ] æ”¯æŒå¯¼å‡ºå¯¹æ¯”æŠ¥å‘Š

**UI è®¾è®¡**: å·¦å³åˆ†æ æ˜¾ç¤ºï¼Œä¸­é—´ç”¨ç®­å¤´è¿æ¥å˜åŒ–

**éªŒæ”¶æ ‡å‡†**:
```gherkin
Scenario: å¯¹æ¯”æƒé‡é…ç½®
  Given ç”¨æˆ·é€‰æ‹©äº†ä¸¤ä¸ªæ—¶é—´ç‚¹
  When ç‚¹å‡» "å¯¹æ¯”"
  Then å·¦ä¾§æ˜¾ç¤ºæ—¶é—´ç‚¹ 1 çš„æƒé‡é…ç½®
  And å³ä¾§æ˜¾ç¤ºæ—¶é—´ç‚¹ 2 çš„æƒé‡é…ç½®
  And å˜åŒ–çš„ KR ç”¨é¢œè‰²é«˜äº®
  And æ˜¾ç¤ºæƒé‡å˜åŒ–ç™¾åˆ†æ¯”
```

**Story Points**: 2 SP  
**é¢„ä¼°æ—¶é—´**: 0.5-1 å¤©

---

### ğŸ“Š Sprint 6 Story Points æ±‡æ€»

| Category | Stories | Story Points | Week |
|----------|---------|--------------|------|
| **Sprint 5 æ”¶å°¾** | 2 tasks | 4 SP | Week 1 |
| **EPIC-GOAL-002 åŸºç¡€å±‚** | Stories 001-003 | 8 SP | Week 1 |
| **EPIC-GOAL-002 åº”ç”¨å±‚** | Stories 004-007 | 10 SP | Week 2 |
| **Total** | **9 items** | **22 SP** | **2 weeks** |

---

## ğŸ“… Sprint 6 æ—¶é—´è¡¨

### **Week 1 (2025-11-05 ~ 2025-11-08): æ”¶å°¾ + åŸºç¡€å±‚**

| Day | Date | Focus | SP | Deliverables |
|-----|------|-------|----|--------------||
| **Mon** | 11-05 | Sprint 5 æ•°æ®åº“è¿ç§» | 2 | âœ… Schedule è¡¨å·²åˆ›å»º<br>âœ… Prisma å®¢æˆ·ç«¯å·²ç”Ÿæˆ |
| **Tue** | 11-06 | GOAL-002-001: Contracts & Domain | 3 | âœ… WeightSnapshot å€¼å¯¹è±¡<br>âœ… Goal èšåˆæ ¹æ‰©å±•<br>âœ… å•å…ƒæµ‹è¯•é€šè¿‡ |
| **Wed** | 11-07 | GOAL-002-002: Application Service | 3 | âœ… WeightSnapshotApplicationService<br>âœ… æƒé‡æ›´æ–°é›†æˆå¿«ç…§<br>âœ… äº‹åŠ¡ç®¡ç† |
| **Thu** | 11-08 | GOAL-002-003: Infrastructure | 2 | âœ… Prisma Schema<br>âœ… Repository å®ç°<br>âœ… è¿ç§»å®Œæˆ |

**Week 1 Total**: 10 SP

---

### **Week 2 (2025-11-11 ~ 2025-11-15): åº”ç”¨å±‚ + UI**

| Day | Date | Focus | SP | Deliverables |
|-----|------|-------|----|--------------||
| **Mon** | 11-11 | Sprint 5 æµ‹è¯• + GOAL-002-004 API | 2+3 | âœ… API Client æµ‹è¯•ä¿®æ­£<br>âœ… WeightSnapshotController<br>âœ… 2 ä¸ª REST ç«¯ç‚¹ |
| **Tue** | 11-12 | GOAL-002-005: Client Services | 2 | âœ… WeightSnapshotClientService<br>âœ… useWeightSnapshot composable<br>âœ… å®¢æˆ·ç«¯æµ‹è¯• |
| **Wed** | 11-13 | GOAL-002-006: UI å†å²åˆ—è¡¨ | 3 | âœ… WeightSnapshotHistory ç»„ä»¶<br>âœ… ç­›é€‰ã€åˆ†é¡µåŠŸèƒ½<br>âœ… å“åº”å¼è®¾è®¡ |
| **Thu** | 11-14 | GOAL-002-007: UI å¯¹æ¯”è§†å›¾ | 2 | âœ… WeightComparison ç»„ä»¶<br>âœ… å¯è§†åŒ–å¯¹æ¯”<br>âœ… å¯¼å‡ºåŠŸèƒ½ |
| **Fri** | 11-15 | E2E æµ‹è¯• + Sprint Review | - | âœ… å…¨é“¾è·¯æµ‹è¯•<br>âœ… Sprint å›é¡¾ |

**Week 2 Total**: 12 SP

---

## âœ… Definition of Done (DoD)

æ¯ä¸ª Story å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰èƒ½æ ‡è®°ä¸º "Done":

### ä»£ç è´¨é‡

- [ ] æ‰€æœ‰ TypeScript ç¼–è¯‘æ— é”™è¯¯
- [ ] ESLint æ—  error çº§åˆ«è­¦å‘Š
- [ ] ä»£ç ç¬¦åˆ DDD + Clean Architecture åˆ†å±‚åŸåˆ™
- [ ] æ‰€æœ‰ public æ–¹æ³•æœ‰ JSDoc æ³¨é‡Š

### æµ‹è¯•è¦æ±‚

- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ`pnpm test`ï¼‰
- [ ] å…³é”®è·¯å¾„æœ‰é›†æˆæµ‹è¯•

### æ–‡æ¡£è¦æ±‚

- [ ] Story æ–‡ä»¶æ›´æ–°çŠ¶æ€ä¸º "Ready for Review"
- [ ] æ·»åŠ  "Dev Agent Record" ç« èŠ‚
- [ ] API ç«¯ç‚¹æ›´æ–° Swagger æ–‡æ¡£
- [ ] UI ç»„ä»¶æœ‰ä½¿ç”¨ç¤ºä¾‹

### é›†æˆè¦æ±‚

- [ ] ä¸ç°æœ‰æ¨¡å—é›†æˆæ— å†²çª
- [ ] æ•°æ®åº“è¿ç§»å·²è¿è¡Œ
- [ ] æ‰€æœ‰ä¾èµ–é¡¹å·²å®‰è£…

---

## ğŸ¯ Sprint 6 æˆåŠŸæŒ‡æ ‡

### æŠ€æœ¯æŒ‡æ ‡

| Metric | Target | Measurement |
|--------|--------|-------------|
| Story å®Œæˆç‡ | 100% | 9/9 stories |
| ä»£ç è¦†ç›–ç‡ | â‰¥ 80% | Vitest report |
| TypeScript Errors | 0 | `pnpm typecheck` |
| Build Success | 100% | `pnpm build` |
| API Endpoints | 2 | GET snapshots x2 |

### åŠŸèƒ½æŒ‡æ ‡

| Feature | Status | Notes |
|---------|--------|-------|
| Sprint 5 æ•°æ®åº“è¿ç§» | âœ… | Schedule è¡¨å¯ç”¨ |
| æƒé‡å¿«ç…§è‡ªåŠ¨è®°å½• | âœ… | æ¯æ¬¡æƒé‡æ›´æ–°è§¦å‘ |
| å¿«ç…§å†å²æŸ¥è¯¢ | âœ… | æ”¯æŒç­›é€‰ã€åˆ†é¡µ |
| UI å†å²åˆ—è¡¨ | âœ… | WeightSnapshotHistory |
| UI å¯¹æ¯”è§†å›¾ | âœ… | WeightComparison |

### ä¸šåŠ¡æŒ‡æ ‡

| Metric | Target | Value |
|--------|--------|-------|
| RICE Score | 672 | Highest priority |
| User Value | High | å®¡è®¡è¿½æº¯ã€è¶‹åŠ¿åˆ†æ |
| Technical Debt | Low | å®Œæˆ Sprint 5 é—ç•™ |

---

## âš ï¸ é£é™©ç®¡ç†

### é£é™©è¯†åˆ«

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| **æ•°æ®åº“è¿æ¥ä»ä¸å¯ç”¨** | ä¸­ (30%) | é«˜ | âœ… Day 1 ç«‹å³éªŒè¯<br>âœ… å¤‡ç”¨æ–¹æ¡ˆ: ä½¿ç”¨æœ¬åœ° PostgreSQL |
| **æƒé‡æ ¡éªŒé€»è¾‘å¤æ‚** | ä½ (20%) | ä¸­ | âœ… å……åˆ†çš„å•å…ƒæµ‹è¯•<br>âœ… è¾¹ç•Œæ¡ä»¶æµ‹è¯• |
| **UI ç»„ä»¶è®¾è®¡è°ƒæ•´** | ä¸­ (40%) | ä½ | âœ… ä½¿ç”¨ Vuetify ç°æˆç»„ä»¶<br>âœ… å¤ç”¨ Goal æ¨¡å—æ ·å¼ |
| **Week 1 è¿›åº¦å»¶è¿Ÿ** | ä¸­ (30%) | ä¸­ | âœ… Story 007 å¯é™çº§ä¸º P2<br>âœ… æµ‹è¯•è¡¥å……å¯æ¨è¿Ÿåˆ° Sprint 7 |

### ä¾èµ–ç®¡ç†

| Dependency | Status | Owner | Risk |
|------------|--------|-------|------|
| Neon æ•°æ®åº“å¯ç”¨ | âš ï¸ Pending | User | High |
| Sprint 5 ä»£ç ç¨³å®š | âœ… Done | Dev Team | Low |
| Goal æ¨¡å— API | âœ… Available | Existing | Low |

---

## ğŸ”„ Sprint 6 ä¸ Sprint 5 çš„å…³ç³»

### æŠ€æœ¯è¿ç»­æ€§

Sprint 6 Week 1 å®Œæˆ Sprint 5 é—ç•™ä»»åŠ¡ï¼Œç¡®ä¿:
- âœ… æ•°æ®åº“å±‚å®Œæ•´ï¼ˆSchedule + WeightSnapshot è¡¨ï¼‰
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–å……åˆ†
- âœ… æ— æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯

### æ¶æ„å¤ç”¨

EPIC-GOAL-002 å¤ç”¨ Sprint 5 çš„æˆç†Ÿæ¨¡å¼:
- âœ… DDD 8 å±‚æ¶æ„
- âœ… Prisma Repository æ¨¡å¼
- âœ… Zod éªŒè¯ + Swagger æ–‡æ¡£
- âœ… Vue Composable æ¨¡å¼

### å›¢é˜ŸèŠ‚å¥

Week 1 æ…¢å¯åŠ¨ï¼ˆæ”¶å°¾ + åŸºç¡€å±‚ï¼‰ï¼ŒWeek 2 åŠ é€Ÿï¼ˆåº”ç”¨å±‚ + UIï¼‰ï¼Œä¿æŒå¯æŒç»­çš„å¼€å‘èŠ‚å¥ã€‚

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### Epic & Stories

- [EPIC-GOAL-002: KR æƒé‡å¿«ç…§](../epics/epic-goal-002-kr-weight-snapshot.md)
- [STORY-GOAL-002-001](../stories/STORY-GOAL-002-001.md) through 009
- [Sprint 5 Index](../stories/SPRINT-05-INDEX.md)

### Architecture

- [DDD 8 å±‚æ¶æ„æ–‡æ¡£](../../architecture/ddd-8-layer-architecture.md)
- [Prisma è¿ç§»æŒ‡å—](../../PRISMA_GENERATION_GUIDE.md)
- [æµ‹è¯•ç­–ç•¥æ–‡æ¡£](../../guides/testing-strategy.md)

### Sprint History

- [Sprint 4 Index](../stories/SPRINT-04-INDEX.md) - Task Dependencies & UX (24 SP)
- [Sprint 5 Index](../stories/SPRINT-05-INDEX.md) - Schedule Conflict Detection (18 SP)

---

## ğŸ“ Sprint 6 ç»éªŒé¢„æœŸ

### é¢„æœŸæŒ‘æˆ˜

1. **æƒé‡æ€»å’Œæ ¡éªŒ**: 100% çº¦æŸåœ¨å¹¶å‘æ›´æ–°æ—¶çš„å¤„ç†
2. **å¿«ç…§æ•°æ®é‡**: é•¿æœŸä½¿ç”¨åçš„æ€§èƒ½ä¼˜åŒ–
3. **UI äº¤äº’è®¾è®¡**: å†å²å¯¹æ¯”è§†å›¾çš„ç”¨æˆ·ä½“éªŒ

### é¢„æœŸæ”¶ç›Š

1. **å®Œæ•´çš„å®¡è®¡è¿½æº¯**: æ‰€æœ‰æƒé‡å˜æ›´æœ‰æ®å¯æŸ¥
2. **è¶‹åŠ¿åˆ†æèƒ½åŠ›**: è¯†åˆ«ä¸åˆç†çš„é¢‘ç¹è°ƒæ•´
3. **å†å²æ¢å¤åŠŸèƒ½**: å›æ»šåˆ°ä»»æ„å†å²é…ç½®

---

## ğŸ“‹ Sprint 6 Checklist

### Pre-Sprint å‡†å¤‡ (2025-11-04)

- [ ] Sprint 5 ä»£ç  merge åˆ° main
- [ ] ç¡®è®¤ Neon æ•°æ®åº“å¯ç”¨
- [ ] Review EPIC-GOAL-002 æ‰€æœ‰ Stories
- [ ] å‡†å¤‡å¼€å‘ç¯å¢ƒï¼ˆpnpm installï¼‰

### Week 1 Checklist

- [ ] Day 1: Sprint 5 æ•°æ®åº“è¿ç§»å®Œæˆ
- [ ] Day 2: GOAL-002-001 å®Œæˆï¼ˆContracts & Domainï¼‰
- [ ] Day 3: GOAL-002-002 å®Œæˆï¼ˆApplication Serviceï¼‰
- [ ] Day 4: GOAL-002-003 å®Œæˆï¼ˆInfrastructureï¼‰
- [ ] Week 1 Review: åŸºç¡€å±‚æµ‹è¯•é€šè¿‡

### Week 2 Checklist

- [ ] Day 1: GOAL-002-004 å®Œæˆï¼ˆAPI Endpointsï¼‰
- [ ] Day 2: GOAL-002-005 å®Œæˆï¼ˆClient Servicesï¼‰
- [ ] Day 3: GOAL-002-006 å®Œæˆï¼ˆUI å†å²åˆ—è¡¨ï¼‰
- [ ] Day 4: GOAL-002-007 å®Œæˆï¼ˆUI å¯¹æ¯”è§†å›¾ï¼‰
- [ ] Day 5: E2E æµ‹è¯• + Sprint Review

### Post-Sprint äº¤ä»˜

- [ ] æ›´æ–°æ‰€æœ‰ Story çŠ¶æ€ä¸º "Ready for Review"
- [ ] åˆ›å»º Sprint 6 æ€»ç»“æ–‡æ¡£
- [ ] è®°å½• Lessons Learned
- [ ] è§„åˆ’ Sprint 7

---

## ğŸš€ Sprint 7 é¢„å‘Š

åŸºäº RICE è¯„åˆ†å’Œä¸šåŠ¡ä¼˜å…ˆçº§ï¼ŒSprint 7 å€™é€‰ Epics:

| Epic | RICE | Priority | Effort | Theme |
|------|------|----------|--------|-------|
| **EPIC-TASK-002** | 576 | P0 | 0.5w | ä»»åŠ¡ä¼˜å…ˆçº§çŸ©é˜µ |
| **EPIC-TASK-001** | 567 | P0 | 2.5w | ä»»åŠ¡ä¾èµ–å›¾ï¼ˆDAGï¼‰ |
| **EPIC-GOAL-004** | 480 | P0 | 1.33w | è¿›åº¦è‡ªåŠ¨è®¡ç®— |
| **EPIC-GOAL-003** | 432 | P0 | - | ä¸“æ³¨æ¨¡å¼ |

**å»ºè®®**: Sprint 7 é€‰æ‹© **EPIC-TASK-002** (ä»»åŠ¡ä¼˜å…ˆçº§çŸ©é˜µ)ï¼Œç†ç”±:
- âœ… é«˜ RICE è¯„åˆ† (576)
- âœ… çŸ­å‘¨æœŸ (0.5 å‘¨ = 3-4 å¤©)
- âœ… å¯ä¸å…¶ä»–å° Epic ç»„åˆï¼Œå½¢æˆå®Œæ•´ Sprint
- âœ… ç”¨æˆ·é«˜é¢‘ä½¿ç”¨åœºæ™¯

---

**Sprint 6 è§„åˆ’å®Œæˆæ—¥æœŸ**: 2025-10-24  
**è§„åˆ’åˆ›å»ºè€…**: Bob (Scrum Master)  
**å®¡æ‰¹çŠ¶æ€**: Pending Review  
**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: User review & approve â†’ Start Sprint 6

---

_Sprint 6, Let's ship it! ğŸš€_

### Sprint ç›®æ ‡ (Sprint Goal)

> **å®ç°åŸºäº BullMQ çš„å¤šæ¸ é“é€šçŸ¥èšåˆç³»ç»Ÿï¼Œå®Œæˆæ ¸å¿ƒåŠŸèƒ½é—­ç¯ã€‚**

**æ ¸å¿ƒä»·å€¼**:

- âœ… å¤šæ¸ é“é€šçŸ¥èšåˆï¼ˆåº”ç”¨å†… + æ¡Œé¢æ¨é€ + é‚®ä»¶ï¼‰
- âœ… BullMQ + Redis æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¯é æ€§ã€é‡è¯•ã€ä¼˜å…ˆçº§ï¼‰
- âœ… Bull Board å¯è§†åŒ–ç›‘æ§é¢æ¿
- âœ… ç³»ç»Ÿé›†æˆæµ‹è¯• + éƒ¨ç½²å‡†å¤‡

### Epic èƒŒæ™¯

**NOTIFICATION-001 - å¤šæ¸ é“é€šçŸ¥èšåˆ**:

- **æ ¸å¿ƒæ¶æ„**: BullMQ æ¶ˆæ¯é˜Ÿåˆ— + Worker å¼‚æ­¥å¤„ç†
- **æŠ€æœ¯å†³ç­–**: åŸºäº Sprint 2b Spike ç»“æœï¼Œé‡‡ç”¨ BullMQ (ADR-003)
- **ç”¨æˆ·åœºæ™¯**: ä»»åŠ¡æé†’ã€ç›®æ ‡æé†’ã€æ—¥ç¨‹æé†’è‡ªåŠ¨åˆ†å‘åˆ°å¤šä¸ªæ¸ é“

---

## ğŸ“… æ¯æ—¥æ‰§è¡Œè®¡åˆ’ (Day-by-Day Plan)

### **Week 13: BullMQ æ ¸å¿ƒç³»ç»Ÿæ­å»º**

#### **Day 1 (2026-01-12 å‘¨ä¸€): Redis + BullMQ åŸºç¡€è®¾æ–½**

**ç›®æ ‡**: å®Œæˆ BullMQ + Redis ç¯å¢ƒæ­å»º (3 SP)

**ä»»åŠ¡æ¸…å•**:

- [ ] **ä¸Šåˆ**: Redis é…ç½®

  ```yaml
  # docker-compose.yml
  services:
    redis:
      image: redis:7-alpine
      ports:
        - '6379:6379'
      volumes:
        - ./data/redis:/data
      command: redis-server --appendonly yes --appendfsync everysec
  ```

- [ ] **ä¸‹åˆ**: BullMQ Queue åˆå§‹åŒ–

  ```typescript
  // packages/domain-server/src/infrastructure/queue/notification-queue.ts
  import { Queue, Worker, QueueEvents } from 'bullmq';
  import IORedis from 'ioredis';

  const connection = new IORedis({
    host: process.env.REDIS_HOST || 'localhost',
    port: parseInt(process.env.REDIS_PORT || '6379'),
    maxRetriesPerRequest: null,
  });

  export const notificationQueue = new Queue('notifications', { connection });

  export interface NotificationJobData {
    targetUuid: string;
    targetType: 'task' | 'goal' | 'schedule';
    channels: ('in_app' | 'desktop' | 'email')[];
    title: string;
    content: string;
    priority: number; // 1-5
    scheduledAt?: number; // å®šæ—¶å‘é€
  }
  ```

**äº¤ä»˜ç‰©**: âœ… Redis + BullMQ ç¯å¢ƒå°±ç»ª

---

#### **Day 2-3 (2026-01-13 ~ 2026-01-14): Contracts + Domain + Application**

**ç›®æ ‡**: å®Œæˆé€šçŸ¥é¢†åŸŸæ¨¡å‹ + Application Service (5 SP)

**ä»»åŠ¡æ¸…å•**:

- [ ] **Day 2**: Contracts + Domain

  ```typescript
  // packages/contracts/src/notification/notification.dto.ts
  export interface NotificationDTO {
    uuid: string;
    userUuid: string;
    targetUuid: string;
    targetType: 'task' | 'goal' | 'schedule';

    channel: 'in_app' | 'desktop' | 'email';
    title: string;
    content: string;

    status: 'pending' | 'sent' | 'failed';
    priority: number;

    sentAt?: number;
    failureReason?: string;

    createdAt: number;
  }

  // packages/domain-server/src/domain/notification/notification.entity.ts
  export class Notification extends AggregateRoot {
    constructor(
      uuid: string,
      public readonly userUuid: string,
      public readonly targetUuid: string,
      public readonly targetType: string,
      public readonly channel: string,
      public readonly title: string,
      public readonly content: string,
      public readonly priority: number,
      private _status: 'pending' | 'sent' | 'failed' = 'pending',
      private _sentAt?: number,
      private _failureReason?: string,
    ) {
      super();
      this.validate();
    }

    private validate(): void {
      if (this.priority < 1 || this.priority > 5) {
        throw new InvalidPriorityError('ä¼˜å…ˆçº§å¿…é¡»åœ¨ 1-5 ä¹‹é—´');
      }
    }

    markAsSent(): void {
      this._status = 'sent';
      this._sentAt = Date.now();
      this.addDomainEvent(new NotificationSentEvent(this.uuid, this.channel));
    }

    markAsFailed(reason: string): void {
      this._status = 'failed';
      this._failureReason = reason;
      this.addDomainEvent(new NotificationFailedEvent(this.uuid, reason));
    }
  }
  ```

- [ ] **Day 3**: Application Service - NotificationDispatcherService

  ```typescript
  // packages/domain-server/src/application/notification/notification-dispatcher.service.ts
  import { notificationQueue } from '../../infrastructure/queue/notification-queue';

  export class NotificationDispatcherService {
    constructor(
      private notificationRepository: NotificationRepository,
      private taskRepository: TaskRepository,
    ) {}

    /**
     * åˆ†å‘é€šçŸ¥åˆ°å¤šä¸ªæ¸ é“
     */
    async dispatch(params: {
      targetUuid: string;
      targetType: string;
      channels: string[];
      title: string;
      content: string;
      priority: number;
      scheduledAt?: number;
    }): Promise<void> {
      // ä¸ºæ¯ä¸ªæ¸ é“åˆ›å»ºé€šçŸ¥å®ä½“
      const notifications = params.channels.map(
        (channel) =>
          new Notification(
            uuidv4(),
            'user-uuid', // ä»ä¸Šä¸‹æ–‡è·å–
            params.targetUuid,
            params.targetType,
            channel,
            params.title,
            params.content,
            params.priority,
          ),
      );

      // ä¿å­˜åˆ°æ•°æ®åº“
      await this.notificationRepository.saveBatch(notifications);

      // æ·»åŠ åˆ° BullMQ é˜Ÿåˆ—
      for (const notification of notifications) {
        await notificationQueue.add(
          'send-notification',
          {
            notificationUuid: notification.uuid,
            channel: notification.channel,
            title: notification.title,
            content: notification.content,
          },
          {
            priority: 6 - params.priority, // BullMQ: æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
            delay: params.scheduledAt ? params.scheduledAt - Date.now() : 0,
            attempts: 3,
            backoff: {
              type: 'exponential',
              delay: 5000,
            },
          },
        );
      }
    }

    /**
     * ä»»åŠ¡æé†’ï¼ˆä» Sprint 2b Node-Cron è¿ç§»ï¼‰
     */
    async sendTaskReminder(taskUuid: string): Promise<void> {
      const task = await this.taskRepository.findByUuid(taskUuid);
      if (!task) return;

      await this.dispatch({
        targetUuid: taskUuid,
        targetType: 'task',
        channels: ['in_app', 'desktop'],
        title: 'ä»»åŠ¡æé†’',
        content: `ä»»åŠ¡ "${task.title}" å³å°†åˆ°æœŸ`,
        priority: task.importance, // å¤ç”¨ä»»åŠ¡ä¼˜å…ˆçº§
      });
    }
  }
  ```

**äº¤ä»˜ç‰©**: âœ… é€šçŸ¥åˆ†å‘é€»è¾‘å®Œæˆ

---

#### **Day 4 (2026-01-15 å‘¨å››): BullMQ Worker å®ç°**

**ç›®æ ‡**: å®Œæˆå¤šæ¸ é“ Worker (3 SP)

**ä»»åŠ¡æ¸…å•**:

- [ ] **å…¨å¤©**: Worker å®ç°

  ```typescript
  // apps/api/src/workers/notification-worker.ts
  import { Worker, Job } from 'bullmq';
  import { notificationQueue } from '@dailyuse/domain-server';

  const worker = new Worker(
    'notifications',
    async (job: Job) => {
      const { notificationUuid, channel, title, content } = job.data;

      try {
        switch (channel) {
          case 'in_app':
            await sendInAppNotification(notificationUuid, title, content);
            break;
          case 'desktop':
            await sendDesktopNotification(notificationUuid, title, content);
            break;
          case 'email':
            await sendEmailNotification(notificationUuid, title, content);
            break;
        }

        // æ ‡è®°ä¸ºå·²å‘é€
        const notification = await notificationRepository.findByUuid(notificationUuid);
        notification.markAsSent();
        await notificationRepository.save(notification);
      } catch (error) {
        // æ ‡è®°ä¸ºå¤±è´¥
        const notification = await notificationRepository.findByUuid(notificationUuid);
        notification.markAsFailed(error.message);
        await notificationRepository.save(notification);

        throw error; // BullMQ ä¼šè‡ªåŠ¨é‡è¯•
      }
    },
    {
      connection,
      concurrency: 5, // å¹¶å‘å¤„ç† 5 ä¸ªä»»åŠ¡
      limiter: {
        max: 100, // æ¯ 10 ç§’æœ€å¤š 100 ä¸ª
        duration: 10000,
      },
    },
  );

  /**
   * åº”ç”¨å†…é€šçŸ¥ï¼ˆSSEï¼‰
   */
  async function sendInAppNotification(
    uuid: string,
    title: string,
    content: string,
  ): Promise<void> {
    // é€šè¿‡ SSE æ¨é€ï¼ˆä» Sprint 2b å¤ç”¨ï¼‰
    sseManager.broadcast('user-uuid', {
      type: 'notification',
      uuid,
      title,
      content,
    });
  }

  /**
   * æ¡Œé¢æ¨é€ï¼ˆElectronï¼‰
   */
  async function sendDesktopNotification(
    uuid: string,
    title: string,
    content: string,
  ): Promise<void> {
    // è°ƒç”¨ Desktop åº”ç”¨çš„ IPC
    // ç”± apps/desktop å¤„ç†
  }

  /**
   * é‚®ä»¶é€šçŸ¥ï¼ˆNodemailerï¼‰
   */
  async function sendEmailNotification(
    uuid: string,
    title: string,
    content: string,
  ): Promise<void> {
    const transporter = nodemailer.createTransport({
      service: 'gmail',
      auth: {
        user: process.env.EMAIL_USER,
        pass: process.env.EMAIL_PASS,
      },
    });

    await transporter.sendMail({
      from: process.env.EMAIL_USER,
      to: 'user-email', // ä»ç”¨æˆ·é…ç½®è·å–
      subject: title,
      text: content,
    });
  }

  worker.on('completed', (job) => {
    console.log(`âœ… Job ${job.id} completed`);
  });

  worker.on('failed', (job, error) => {
    console.error(`âŒ Job ${job?.id} failed:`, error);
  });

  export default worker;
  ```

**äº¤ä»˜ç‰©**: âœ… BullMQ Worker å®Œæˆ

---

#### **Day 5 (2026-01-16 å‘¨äº”): Bull Board ç›‘æ§é¢æ¿**

**ç›®æ ‡**: é›†æˆ Bull Board UI (2 SP)

**ä»»åŠ¡æ¸…å•**:

- [ ] **ä¸Šåˆ**: Bull Board é…ç½®

  ```typescript
  // apps/api/src/server.ts
  import { createBullBoard } from '@bull-board/api';
  import { BullMQAdapter } from '@bull-board/api/bullMQAdapter';
  import { ExpressAdapter } from '@bull-board/express';

  const serverAdapter = new ExpressAdapter();
  serverAdapter.setBasePath('/admin/queues');

  createBullBoard({
    queues: [new BullMQAdapter(notificationQueue)],
    serverAdapter,
  });

  app.use('/admin/queues', serverAdapter.getRouter());
  ```

- [ ] **ä¸‹åˆ**: æµ‹è¯•ç›‘æ§é¢æ¿
  - è®¿é—® `http://localhost:3000/admin/queues`
  - æŸ¥çœ‹é˜Ÿåˆ—çŠ¶æ€ã€ä½œä¸šåˆ—è¡¨ã€é‡è¯•è®°å½•

**äº¤ä»˜ç‰©**: âœ… Bull Board å¯è§†åŒ–é¢æ¿å°±ç»ª

---

### **Week 14: ç³»ç»Ÿé›†æˆ + éƒ¨ç½²å‡†å¤‡**

#### **Day 6-7 (2026-01-19 ~ 2026-01-20): ç³»ç»Ÿé›†æˆ**

**ç›®æ ‡**: é›†æˆé€šçŸ¥ç³»ç»Ÿåˆ°ç°æœ‰æ¨¡å— (2 SP)

**ä»»åŠ¡æ¸…å•**:

- [ ] **Day 6**: è¿ç§» Sprint 2b Node-Cron åˆ° BullMQ
  - ä»»åŠ¡æé†’ â†’ NotificationDispatcherService
  - ç›®æ ‡æé†’ â†’ NotificationDispatcherService
- [ ] **Day 7**: é›†æˆåˆ° Sprint 5 æ™ºèƒ½æé†’
  - `SmartReminderService.sendReminder()` è°ƒç”¨ `NotificationDispatcherService`

**äº¤ä»˜ç‰©**: âœ… é€šçŸ¥ç³»ç»Ÿä¸æ‰€æœ‰æ¨¡å—é›†æˆå®Œæˆ

---

#### **Day 8 (2026-01-21 å‘¨ä¸‰): E2E æµ‹è¯•**

**ç›®æ ‡**: å…¨é“¾è·¯æµ‹è¯•

**ä»»åŠ¡æ¸…å•**:

- [ ] åˆ›å»ºä»»åŠ¡ â†’ è®¾ç½®æé†’ â†’ è§¦å‘æé†’ â†’ å¤šæ¸ é“åˆ†å‘
- [ ] æµ‹è¯• BullMQ é‡è¯•æœºåˆ¶
- [ ] æµ‹è¯• Bull Board ç›‘æ§

**äº¤ä»˜ç‰©**: âœ… E2E æµ‹è¯•é€šè¿‡

---

#### **Day 9 (2026-01-22 å‘¨å››): éƒ¨ç½²å‡†å¤‡**

**ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒé…ç½®

**ä»»åŠ¡æ¸…å•**:

- [ ] Redis æŒä¹…åŒ–é…ç½®ï¼ˆAOF + RDBï¼‰
- [ ] BullMQ Worker éƒ¨ç½²ç­–ç•¥ï¼ˆPM2ï¼‰
- [ ] ç¯å¢ƒå˜é‡æ–‡æ¡£
- [ ] éƒ¨ç½²è„šæœ¬

**äº¤ä»˜ç‰©**: âœ… éƒ¨ç½²æ–‡æ¡£å®Œæˆ

---

#### **Day 10 (2026-01-23 å‘¨äº”): Sprint Review + Retrospective**

**ç›®æ ‡**: Sprint 6 å›é¡¾ + æ•´ä½“å¤ç›˜

---

## ğŸ“Š Sprint ç»Ÿè®¡

- **NOTIFICATION-001**: 15 SP (7 Stories)
- **ç³»ç»Ÿé›†æˆ**: åŒ…å«åœ¨å„ Story ä¸­

---

## âœ… Definition of Done

åŒ Sprint 3ï¼Œè¯¦è§ [sprint-03-plan.md](./sprint-03-plan.md)

**é¢å¤–è¦æ±‚**:

- âœ… Bull Board ç›‘æ§é¢æ¿å¯è®¿é—®
- âœ… BullMQ Worker ç¨³å®šè¿è¡Œ
- âœ… Redis æŒä¹…åŒ–é…ç½®éªŒè¯

---

## ğŸš¨ é£é™©ç®¡ç†

| é£é™©            | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥                         |
| --------------- | ---- | ---- | -------------------------------- |
| BullMQ å­¦ä¹ æ›²çº¿ | ä½   | ä¸­   | Sprint 2b Spike å·²éªŒè¯           |
| Redis å•ç‚¹æ•…éšœ  | ä¸­   | é«˜   | Redis Sentinel / Clusterï¼ˆåç»­ï¼‰ |
| é‚®ä»¶å‘é€é™æµ    | ä½   | ä½   | é€Ÿç‡é™åˆ¶ + é˜Ÿåˆ—ç¼“å†²              |

---

## ğŸ¯ Sprint 6 é‡Œç¨‹ç¢‘æ„ä¹‰

**âœ… ç¬¬ä¸€é˜¶æ®µå¼€å‘å®Œæˆ**:

- Sprint 1-6 å…± 182 SP
- 10 ä¸ªæ ¸å¿ƒ Epic å…¨éƒ¨å®ç°
- DDD 8 å±‚æ¶æ„å®Œæ•´è½åœ°

**ğŸš€ ä¸‹ä¸€é˜¶æ®µé¢„å‘Š**:

- æ€§èƒ½ä¼˜åŒ–
- å®‰å…¨åŠ å›º
- å¯è§‚æµ‹æ€§æå‡

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Epic: NOTIFICATION-001](../epics/epic-notification-001-multi-channel-aggregation.md)
- [ADR-003: BullMQ æŠ€æœ¯å†³ç­–](../../architecture/adr/ADR-003-bullmq-selection.md)
- [Sprint 2b: Node-Cron å®ç°](./sprint-02b-plan.md)
- [PM é˜¶æ®µæ€»ç»“](../PM_PHASE_SUMMARY.md)

---

**Sprint è®¡åˆ’åˆ›å»ºäº**: 2025-10-21  
**å‰ç½®æ¡ä»¶**: Sprint 5 å®Œæˆ  
**ä¸‹ä¸€æ­¥**: Production Deployment

---

_ç¥ Sprint 6 åœ†æ»¡æˆåŠŸï¼ğŸ‰_

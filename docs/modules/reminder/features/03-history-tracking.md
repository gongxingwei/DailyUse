# Feature Spec: æé†’å†å²è¿½è¸ª

> **åŠŸèƒ½ç¼–å·**: REMINDER-003  
> **RICE è¯„åˆ†**: 252 (Reach: 6, Impact: 6, Confidence: 7, Effort: 1)  
> **ä¼˜å…ˆçº§**: P1  
> **é¢„ä¼°æ—¶é—´**: 0.8-1 å‘¨  
> **çŠ¶æ€**: Draft  
> **è´Ÿè´£äºº**: TBD  
> **æœ€åæ›´æ–°**: 2025-10-21

---

## 1. æ¦‚è¿°ä¸ç›®æ ‡

### èƒŒæ™¯ä¸ç—›ç‚¹

æé†’ç³»ç»Ÿæ˜¯æ—¶é—´ç®¡ç†çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†ç°æœ‰æé†’å·¥å…·æ™®éå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

- âŒ æé†’è§¦å‘åæ— å†å²è®°å½•ï¼Œæ— æ³•è¿½æº¯
- âŒ ä¸çŸ¥é“è‡ªå·±å¿½ç•¥äº†å¤šå°‘æé†’ï¼Œç¼ºå°‘åé¦ˆé—­ç¯
- âŒ æ— æ³•åˆ†ææé†’çš„æœ‰æ•ˆæ€§ï¼ˆå“åº”ç‡ã€å®Œæˆç‡ï¼‰
- âŒ é‡å¤æé†’ç¼ºå°‘ä¼˜åŒ–ä¾æ®ï¼ˆä¸çŸ¥é“å“ªäº›æé†’æ€»æ˜¯è¢«å¿½ç•¥ï¼‰
- âŒ æé†’å¤±è´¥ï¼ˆå‘é€å¤±è´¥ã€å»¶è¿Ÿï¼‰æ— è®°å½•ï¼Œæ— æ³•æ’æŸ¥é—®é¢˜

### ç›®æ ‡ç”¨æˆ·

- **ä¸»è¦ç”¨æˆ·**: æ‰€æœ‰ä½¿ç”¨æé†’åŠŸèƒ½çš„ DailyUse ç”¨æˆ·
- **æ¬¡è¦ç”¨æˆ·**: éœ€è¦åˆ†ææé†’æ•ˆæœçš„é¡¹ç›®ç»ç†
- **å…¸å‹ç”»åƒ**: "æˆ‘è®¾ç½®äº†å¾ˆå¤šæé†’ï¼Œä½†ä¸çŸ¥é“å“ªäº›æœ‰æ•ˆï¼Œå“ªäº›è¢«å¿½ç•¥äº†"

### ä»·å€¼ä¸»å¼ 

**ä¸€å¥è¯ä»·å€¼**: è®°å½•æ‰€æœ‰æé†’äº‹ä»¶çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå†å²è¿½æº¯ã€æ•ˆæœåˆ†æå’Œæ™ºèƒ½ä¼˜åŒ–

**æ ¸å¿ƒæ”¶ç›Š**:

- âœ… å®Œæ•´è®°å½•æé†’è§¦å‘å†å²ï¼ˆè§¦å‘æ—¶é—´ã€æ¸ é“ã€å“åº”ï¼‰
- âœ… è¿½è¸ªç”¨æˆ·å“åº”è¡Œä¸ºï¼ˆæŸ¥çœ‹ã€å®Œæˆã€å»¶æœŸã€å¿½ç•¥ï¼‰
- âœ… åˆ†ææé†’æœ‰æ•ˆæ€§ï¼ˆå“åº”ç‡ã€å®Œæˆç‡ã€å¹³å‡å“åº”æ—¶é—´ï¼‰
- âœ… è¯†åˆ«å¤±æ•ˆæé†’ï¼ˆæ€»æ˜¯è¢«å¿½ç•¥çš„æé†’ï¼‰
- âœ… æé†’å¤±è´¥è¯Šæ–­

---

## 2. ç”¨æˆ·ä»·å€¼ä¸åœºæ™¯

### æ ¸å¿ƒåœºæ™¯ 1: è‡ªåŠ¨è®°å½•æé†’è§¦å‘å†å²

**åœºæ™¯æè¿°**:  
æé†’è§¦å‘æ—¶ï¼ˆåˆ°è¾¾é¢„è®¾æ—¶é—´ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå†å²è®°å½•ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want ç³»ç»Ÿè‡ªåŠ¨è®°å½•æ¯æ¬¡æé†’è§¦å‘
So that æˆ‘å¯ä»¥è¿½æº¯æ‰€æœ‰æé†’å†å²
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæé†’ï¼š"æ¯å¤© 09:00 æ™¨ä¼šæé†’"
2. åˆ°è¾¾ 2025-10-21 09:00ï¼Œæé†’è§¦å‘
3. ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºæé†’å†å²è®°å½•ï¼š
   ```typescript
   {
     uuid: 'history-001',
     reminderUuid: 'reminder-123',
     triggeredAt: 1729479600000,  // 2025-10-21 09:00
     channels: ['desktop', 'in_app'],
     deliveryStatus: [
       { channel: 'desktop', status: 'sent', sentAt: 1729479600100 },
       { channel: 'in_app', status: 'sent', sentAt: 1729479600150 }
     ],
     userResponse: 'pending',  // å¾…å“åº”
     createdAt: 1729479600000
   }
   ```
4. ç”¨æˆ·åœ¨æ¡Œé¢é€šçŸ¥ä¸Šç‚¹å‡»"æŸ¥çœ‹"
5. ç³»ç»Ÿæ›´æ–°å†å²è®°å½•ï¼š
   ```typescript
   {
     ...existing fields,
     userResponse: 'viewed',
     respondedAt: 1729479660000,  // 09:01ï¼ˆ1åˆ†é’Ÿåï¼‰
     responseTime: 60000,  // 60ç§’
     responseAction: 'viewed',
     metadata: {
       viewedFrom: 'desktop'
     }
   }
   ```
6. ç”¨æˆ·å®Œæˆå…³è”ä»»åŠ¡
7. ç³»ç»Ÿå†æ¬¡æ›´æ–°ï¼š
   ```typescript
   {
     ...existing fields,
     userResponse: 'completed',
     completedAt: 1729483200000,  // 10:00ï¼ˆ1å°æ—¶åå®Œæˆä»»åŠ¡ï¼‰
     completionTime: 3600000  // 1å°æ—¶
   }
   ```

**é¢„æœŸç»“æœ**:

- æ¯æ¬¡æé†’è§¦å‘éƒ½åˆ›å»ºå†å²è®°å½•
- è®°å½•æ¨é€çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- è¿½è¸ªç”¨æˆ·å“åº”ï¼ˆæŸ¥çœ‹ã€å®Œæˆã€å¿½ç•¥ï¼‰
- è®¡ç®—å“åº”æ—¶é—´å’Œå®Œæˆæ—¶é—´

---

### æ ¸å¿ƒåœºæ™¯ 2: æŸ¥çœ‹æé†’å†å²åˆ—è¡¨

**åœºæ™¯æè¿°**:  
ç”¨æˆ·æŸ¥çœ‹æŸä¸ªæé†’çš„æ‰€æœ‰è§¦å‘å†å²ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want æŸ¥çœ‹æŸä¸ªæé†’çš„æ‰€æœ‰å†å²è®°å½•
So that æˆ‘å¯ä»¥äº†è§£è¿™ä¸ªæé†’çš„è§¦å‘å’Œå“åº”æƒ…å†µ
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€æé†’è¯¦æƒ…é¡µ
2. ç‚¹å‡»"å†å²è®°å½•"æ ‡ç­¾
3. ç³»ç»Ÿå±•ç¤ºå†å²åˆ—è¡¨ï¼š

   ```
   ğŸ“‹ æé†’å†å²ï¼ˆæœ€è¿‘ 30 å¤©ï¼‰
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   âœ… 2025-10-21 09:00
   â”œâ”€ æ¨é€æ¸ é“ï¼šæ¡Œé¢é€šçŸ¥ã€åº”ç”¨å†…
   â”œâ”€ ç”¨æˆ·å“åº”ï¼šå·²æŸ¥çœ‹ï¼ˆ1åˆ†é’Ÿåï¼‰
   â”œâ”€ ä»»åŠ¡çŠ¶æ€ï¼šå·²å®Œæˆï¼ˆ1å°æ—¶åï¼‰
   â””â”€ [æŸ¥çœ‹è¯¦æƒ…]

   âŒ 2025-10-20 09:00
   â”œâ”€ æ¨é€æ¸ é“ï¼šæ¡Œé¢é€šçŸ¥ã€åº”ç”¨å†…
   â”œâ”€ ç”¨æˆ·å“åº”ï¼šå·²å¿½ç•¥
   â”œâ”€ ä»»åŠ¡çŠ¶æ€ï¼šæœªå®Œæˆ
   â””â”€ [æŸ¥çœ‹è¯¦æƒ…]

   âœ… 2025-10-19 09:00
   â”œâ”€ æ¨é€æ¸ é“ï¼šæ¡Œé¢é€šçŸ¥ã€åº”ç”¨å†…
   â”œâ”€ ç”¨æˆ·å“åº”ï¼šå·²æŸ¥çœ‹ï¼ˆ3åˆ†é’Ÿåï¼‰
   â”œâ”€ ä»»åŠ¡çŠ¶æ€ï¼šå·²å®Œæˆï¼ˆ2å°æ—¶åï¼‰
   â””â”€ [æŸ¥çœ‹è¯¦æƒ…]

   âš ï¸ 2025-10-18 09:00
   â”œâ”€ æ¨é€æ¸ é“ï¼šæ¡Œé¢é€šçŸ¥ï¼ˆå¤±è´¥ï¼‰ã€åº”ç”¨å†…
   â”œâ”€ å¤±è´¥åŸå› ï¼šæ¡Œé¢é€šçŸ¥æƒé™è¢«æ‹’ç»
   â”œâ”€ ç”¨æˆ·å“åº”ï¼šå·²å»¶æœŸåˆ°æ˜å¤©
   â””â”€ [æŸ¥çœ‹è¯¦æƒ…]

   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ç»Ÿè®¡ï¼ˆæœ€è¿‘ 30 å¤©ï¼‰ï¼š
   - æ€»è§¦å‘æ¬¡æ•°ï¼š30 æ¬¡
   - å“åº”ç‡ï¼š73.3%ï¼ˆ22/30ï¼‰
   - å®Œæˆç‡ï¼š66.7%ï¼ˆ20/30ï¼‰
   - å¹³å‡å“åº”æ—¶é—´ï¼š2.5 åˆ†é’Ÿ
   - å¹³å‡å®Œæˆæ—¶é—´ï¼š1.2 å°æ—¶

   [å¯¼å‡ºå†å²]  [æŸ¥çœ‹åˆ†æ]
   ```

**é¢„æœŸç»“æœ**:

- å†å²æŒ‰æ—¶é—´å€’åºå±•ç¤º
- æ˜¾ç¤ºæ¨é€çŠ¶æ€ã€ç”¨æˆ·å“åº”ã€ä»»åŠ¡å®Œæˆæƒ…å†µ
- æ±‡æ€»ç»Ÿè®¡æ•°æ®

---

### æ ¸å¿ƒåœºæ™¯ 3: æé†’æ•ˆæœåˆ†æ

**åœºæ™¯æè¿°**:  
ç³»ç»Ÿåˆ†ææé†’å†å²ï¼Œæä¾›æ•ˆæœæ´å¯Ÿã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want æŸ¥çœ‹æé†’çš„æ•ˆæœåˆ†æ
So that æˆ‘å¯ä»¥äº†è§£å“ªäº›æé†’æœ‰æ•ˆï¼Œå“ªäº›éœ€è¦ä¼˜åŒ–
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€æé†’è¯¦æƒ…é¡µ
2. ç‚¹å‡»"æ•ˆæœåˆ†æ"æ ‡ç­¾
3. ç³»ç»Ÿå±•ç¤ºåˆ†ææŠ¥å‘Šï¼š

   ```
   ğŸ“Š æé†’æ•ˆæœåˆ†æï¼ˆæœ€è¿‘ 30 å¤©ï¼‰
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   æ€»ä½“æŒ‡æ ‡
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ğŸ“… è§¦å‘æ¬¡æ•°ï¼š30 æ¬¡
   ğŸ‘ï¸ å“åº”ç‡ï¼š73.3%ï¼ˆ22/30ï¼‰
      â”œâ”€ å·²æŸ¥çœ‹ï¼š22 æ¬¡
      â”œâ”€ å·²å¿½ç•¥ï¼š8 æ¬¡
      â””â”€ å»¶æœŸï¼š0 æ¬¡
   âœ… å®Œæˆç‡ï¼š66.7%ï¼ˆ20/30ï¼‰
      â”œâ”€ æŒ‰æ—¶å®Œæˆï¼š15 æ¬¡
      â”œâ”€ å»¶æœŸå®Œæˆï¼š5 æ¬¡
      â””â”€ æœªå®Œæˆï¼š10 æ¬¡
   â±ï¸  å¹³å‡å“åº”æ—¶é—´ï¼š2.5 åˆ†é’Ÿ
   â³ å¹³å‡å®Œæˆæ—¶é—´ï¼š1.2 å°æ—¶

   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ¸ é“æ•ˆæœå¯¹æ¯”
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ¡Œé¢é€šçŸ¥ï¼š
   â”œâ”€ æ¨é€æˆåŠŸç‡ï¼š90%ï¼ˆ27/30ï¼‰
   â”œâ”€ å“åº”ç‡ï¼š70%ï¼ˆ19/27ï¼‰
   â””â”€ å¹³å‡å“åº”æ—¶é—´ï¼š1.8 åˆ†é’Ÿ

   åº”ç”¨å†…é€šçŸ¥ï¼š
   â”œâ”€ æ¨é€æˆåŠŸç‡ï¼š100%ï¼ˆ30/30ï¼‰
   â”œâ”€ å“åº”ç‡ï¼š50%ï¼ˆ15/30ï¼‰
   â””â”€ å¹³å‡å“åº”æ—¶é—´ï¼š5.2 åˆ†é’Ÿ

   ğŸ“Œ æ´å¯Ÿï¼šæ¡Œé¢é€šçŸ¥å“åº”ç‡æ›´é«˜ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨

   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ—¶é—´è§„å¾‹
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   å“åº”ç‡æŒ‰æ—¶æ®µï¼š
   08:00-10:00: 85%ï¼ˆå·¥ä½œæ—¥æ—©æ™¨ï¼Œå“åº”ç‡é«˜ï¼‰
   12:00-14:00: 60%ï¼ˆåˆä¼‘æ—¶æ®µï¼Œå“åº”ç‡ä½ï¼‰
   18:00-22:00: 75%ï¼ˆæ™šé—´æ—¶æ®µï¼Œå“åº”ç‡ä¸­ç­‰ï¼‰

   ğŸ“Œ å»ºè®®ï¼šé‡è¦æé†’å®‰æ’åœ¨ 08:00-10:00

   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   å¤±è´¥åŸå› åˆ†æ
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ¡Œé¢é€šçŸ¥å¤±è´¥ï¼š3 æ¬¡
   â”œâ”€ æƒé™è¢«æ‹’ç»ï¼š2 æ¬¡
   â””â”€ ç³»ç»ŸæœåŠ¡å¼‚å¸¸ï¼š1 æ¬¡

   ğŸ“Œ å»ºè®®ï¼šå¼•å¯¼ç”¨æˆ·å¼€å¯æ¡Œé¢é€šçŸ¥æƒé™
   ```

**é¢„æœŸç»“æœ**:

- å¤šç»´åº¦åˆ†ææé†’æ•ˆæœ
- å¯¹æ¯”ä¸åŒæ¸ é“çš„æ•ˆæœ
- è¯†åˆ«æ—¶é—´è§„å¾‹
- æä¾›ä¼˜åŒ–å»ºè®®

---

### æ ¸å¿ƒåœºæ™¯ 4: è¯†åˆ«å¤±æ•ˆæé†’

**åœºæ™¯æè¿°**:  
ç³»ç»Ÿè¯†åˆ«é•¿æœŸè¢«å¿½ç•¥çš„æé†’ï¼Œå»ºè®®ä¼˜åŒ–æˆ–åˆ é™¤ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want ç³»ç»Ÿè¯†åˆ«å¤±æ•ˆçš„æé†’
So that æˆ‘å¯ä»¥æ¸…ç†æ— ç”¨æé†’ï¼Œå‡å°‘å¹²æ‰°
```

**æ“ä½œæµç¨‹**:

1. ç³»ç»Ÿæ¯å‘¨åˆ†ææ‰€æœ‰æé†’çš„å†å²æ•°æ®
2. å‘ç°æé†’"æ¯æ—¥å¤ç›˜æé†’"è¿ç»­ 7 å¤©è¢«å¿½ç•¥
3. ç³»ç»Ÿåˆ›å»ºæé†’ä¼˜åŒ–å»ºè®®ï¼š
   ```typescript
   {
     reminderUuid: 'reminder-456',
     issueType: 'low_response_rate',
     severity: 'medium',
     statistics: {
       recentTriggers: 7,
       responseRate: 0,  // 0%
       ignoreRate: 100%  // 100%
     },
     suggestion: 'è¯¥æé†’è¿ç»­7å¤©è¢«å¿½ç•¥ï¼Œå»ºè®®ï¼š\n1. è°ƒæ•´æé†’æ—¶é—´\n2. ä¿®æ”¹æé†’å†…å®¹\n3. å¦‚ä¸éœ€è¦å¯ç›´æ¥åˆ é™¤',
     createdAt: Date.now()
   }
   ```
4. ç³»ç»Ÿå‘é€é€šçŸ¥ç»™ç”¨æˆ·ï¼š

   ```
   ğŸ’¡ æé†’ä¼˜åŒ–å»ºè®®

   æ‚¨çš„æé†’"æ¯æ—¥å¤ç›˜æé†’"è¿ç»­ 7 å¤©è¢«å¿½ç•¥

   ç»Ÿè®¡æ•°æ®ï¼š
   - è§¦å‘æ¬¡æ•°ï¼š7 æ¬¡
   - å“åº”ç‡ï¼š0%
   - å¿½ç•¥ç‡ï¼š100%

   å»ºè®®ï¼š
   1. è°ƒæ•´æé†’æ—¶é—´ï¼ˆå½“å‰ï¼š21:00ï¼‰
   2. ä¿®æ”¹æé†’å†…å®¹ï¼Œå¢åŠ å¸å¼•åŠ›
   3. å¦‚ä¸éœ€è¦å¯ç›´æ¥åˆ é™¤

   [è°ƒæ•´æé†’]  [åˆ é™¤æé†’]  [å¿½ç•¥å»ºè®®]
   ```

5. ç”¨æˆ·ç‚¹å‡»"è°ƒæ•´æé†’"
6. å°†æé†’æ—¶é—´ä» 21:00 æ”¹ä¸º 19:00
7. ç³»ç»Ÿè®°å½•ä¼˜åŒ–æ“ä½œ

**é¢„æœŸç»“æœ**:

- è‡ªåŠ¨è¯†åˆ«å¤±æ•ˆæé†’ï¼ˆå“åº”ç‡ <20%ï¼‰
- æä¾›ä¼˜åŒ–å»ºè®®
- ç”¨æˆ·å¯ä¸€é”®ä¼˜åŒ–æˆ–åˆ é™¤

---

### æ ¸å¿ƒåœºæ™¯ 5: æé†’å¤±è´¥è¯Šæ–­

**åœºæ™¯æè¿°**:  
æé†’æ¨é€å¤±è´¥æ—¶ï¼Œç³»ç»Ÿè®°å½•å¤±è´¥åŸå› å¹¶æä¾›è§£å†³æ–¹æ¡ˆã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want äº†è§£æé†’ä¸ºä»€ä¹ˆå¤±è´¥
So that æˆ‘å¯ä»¥è§£å†³é—®é¢˜ï¼Œç¡®ä¿æé†’æ­£å¸¸å·¥ä½œ
```

**æ“ä½œæµç¨‹**:

1. æé†’"é‡è¦ä¼šè®®æé†’"åˆ°è¾¾è§¦å‘æ—¶é—´
2. ç³»ç»Ÿå°è¯•æ¨é€æ¡Œé¢é€šçŸ¥
3. æ¨é€å¤±è´¥ï¼ˆç”¨æˆ·æœªæˆæƒæ¡Œé¢é€šçŸ¥æƒé™ï¼‰
4. ç³»ç»Ÿåˆ›å»ºå¤±è´¥è®°å½•ï¼š
   ```typescript
   {
     uuid: 'history-002',
     reminderUuid: 'reminder-789',
     triggeredAt: 1729483200000,
     channels: ['desktop', 'in_app'],
     deliveryStatus: [
       {
         channel: 'desktop',
         status: 'failed',
         error: 'NotificationPermissionDenied',
         errorMessage: 'æ¡Œé¢é€šçŸ¥æƒé™è¢«æ‹’ç»',
         attemptedAt: 1729483200100
       },
       {
         channel: 'in_app',
         status: 'sent',
         sentAt: 1729483200150
       }
     ],
     userResponse: 'pending'
   }
   ```
5. ç³»ç»Ÿå‘é€å¤±è´¥é€šçŸ¥ï¼ˆé€šè¿‡åº”ç”¨å†…ï¼‰ï¼š

   ```
   âš ï¸ æé†’æ¨é€å¤±è´¥

   æé†’ï¼š"é‡è¦ä¼šè®®æé†’"
   å¤±è´¥æ¸ é“ï¼šæ¡Œé¢é€šçŸ¥
   å¤±è´¥åŸå› ï¼šæƒé™è¢«æ‹’ç»

   è§£å†³æ–¹æ¡ˆï¼š
   1. æ‰“å¼€ç³»ç»Ÿè®¾ç½®
   2. æ‰¾åˆ° DailyUse åº”ç”¨
   3. å¼€å¯"é€šçŸ¥"æƒé™

   [æ‰“å¼€è®¾ç½®]  [ä»…ä½¿ç”¨åº”ç”¨å†…é€šçŸ¥]
   ```

6. ç”¨æˆ·ç‚¹å‡»"æ‰“å¼€è®¾ç½®"
7. ç³»ç»Ÿè°ƒç”¨æ“ä½œç³»ç»Ÿ API æ‰“å¼€æƒé™è®¾ç½®é¡µé¢

**é¢„æœŸç»“æœ**:

- è®°å½•æ‰€æœ‰å¤±è´¥åŸå› 
- æä¾›é’ˆå¯¹æ€§è§£å†³æ–¹æ¡ˆ
- å¼•å¯¼ç”¨æˆ·ä¿®å¤é—®é¢˜

---

### æ ¸å¿ƒåœºæ™¯ 6: å¯¼å‡ºæé†’å†å²

**åœºæ™¯æè¿°**:  
ç”¨æˆ·å¯¼å‡ºæé†’å†å²æ•°æ®ç”¨äºåˆ†ææˆ–å¤‡ä»½ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a DailyUse ç”¨æˆ·
I want å¯¼å‡ºæé†’å†å²æ•°æ®
So that æˆ‘å¯ä»¥è¿›è¡Œæ·±åº¦åˆ†ææˆ–å¤‡ä»½
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€æé†’è¯¦æƒ…é¡µ
2. ç‚¹å‡»"å¯¼å‡ºå†å²"
3. ç³»ç»Ÿæ˜¾ç¤ºå¯¼å‡ºé€‰é¡¹ï¼š

   ```
   ğŸ“¥ å¯¼å‡ºæé†’å†å²
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ—¶é—´èŒƒå›´ï¼š
   âšª æœ€è¿‘ 7 å¤©
   ğŸ”˜ æœ€è¿‘ 30 å¤©
   âšª æœ€è¿‘ 90 å¤©
   âšª è‡ªå®šä¹‰èŒƒå›´

   å¯¼å‡ºæ ¼å¼ï¼š
   ğŸ”˜ CSVï¼ˆè¡¨æ ¼æ•°æ®ï¼‰
   âšª JSONï¼ˆç»“æ„åŒ–æ•°æ®ï¼‰
   âšª PDFï¼ˆå¯è§†åŒ–æŠ¥å‘Šï¼‰

   åŒ…å«å­—æ®µï¼š
   â˜‘ï¸ è§¦å‘æ—¶é—´
   â˜‘ï¸ æ¨é€æ¸ é“
   â˜‘ï¸ ç”¨æˆ·å“åº”
   â˜‘ï¸ å“åº”æ—¶é—´
   â˜‘ï¸ å®ŒæˆçŠ¶æ€
   â˜‘ï¸ å¤±è´¥åŸå› 

   [å–æ¶ˆ]  [å¯¼å‡º]
   ```

4. ç”¨æˆ·é€‰æ‹©"æœ€è¿‘ 30 å¤©" + "CSV"
5. ç‚¹å‡»"å¯¼å‡º"
6. ç³»ç»Ÿç”Ÿæˆ CSV æ–‡ä»¶ï¼š
   ```csv
   è§¦å‘æ—¶é—´,æ¨é€æ¸ é“,ç”¨æˆ·å“åº”,å“åº”æ—¶é—´(ç§’),å®ŒæˆçŠ¶æ€,å¤±è´¥åŸå› 
   2025-10-21 09:00,æ¡Œé¢é€šçŸ¥+åº”ç”¨å†…,å·²æŸ¥çœ‹,60,å·²å®Œæˆ,
   2025-10-20 09:00,æ¡Œé¢é€šçŸ¥+åº”ç”¨å†…,å·²å¿½ç•¥,,,
   2025-10-19 09:00,æ¡Œé¢é€šçŸ¥+åº”ç”¨å†…,å·²æŸ¥çœ‹,180,å·²å®Œæˆ,
   2025-10-18 09:00,æ¡Œé¢é€šçŸ¥(å¤±è´¥)+åº”ç”¨å†…,å·²å»¶æœŸ,,,æƒé™è¢«æ‹’ç»
   ...
   ```
7. æµè§ˆå™¨ä¸‹è½½æ–‡ä»¶ï¼š"æ™¨ä¼šæé†’\_å†å²\_20251021.csv"

**é¢„æœŸç»“æœ**:

- æ”¯æŒå¤šç§å¯¼å‡ºæ ¼å¼ï¼ˆCSVã€JSONã€PDFï¼‰
- å¯è‡ªå®šä¹‰æ—¶é—´èŒƒå›´å’Œå­—æ®µ
- ç”Ÿæˆæ–‡ä»¶å‘½åè§„èŒƒ

---

## 3. è®¾è®¡è¦ç‚¹

### æ¶‰åŠå­—æ®µï¼ˆå¯¹é½ Contractsï¼‰

#### æ–°å¢å®ä½“ï¼šReminderHistory

**ä½ç½®**: `packages/contracts/src/modules/reminder/entities/ReminderHistoryServer.ts`

```typescript
/**
 * æé†’å†å²è®°å½•
 */
export interface ReminderHistoryServerDTO {
  readonly uuid: string;
  readonly reminderUuid: string;
  readonly userUuid: string;
  readonly triggeredAt: number; // è§¦å‘æ—¶é—´
  readonly channels: NotificationChannel[]; // æ¨é€æ¸ é“
  readonly deliveryStatus: DeliveryStatus[]; // æ¨é€çŠ¶æ€
  readonly userResponse: UserResponse; // ç”¨æˆ·å“åº”
  readonly respondedAt?: number; // å“åº”æ—¶é—´
  readonly responseTime?: number; // å“åº”æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
  readonly responseAction?: ResponseAction; // å“åº”åŠ¨ä½œ
  readonly completedAt?: number; // å®Œæˆæ—¶é—´
  readonly completionTime?: number; // å®Œæˆæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
  readonly metadata?: Record<string, any>; // æ‰©å±•å…ƒæ•°æ®
  readonly createdAt: number;
}

/**
 * ç”¨æˆ·å“åº”çŠ¶æ€
 */
export enum UserResponse {
  PENDING = 'pending', // å¾…å“åº”
  VIEWED = 'viewed', // å·²æŸ¥çœ‹
  COMPLETED = 'completed', // å·²å®Œæˆ
  IGNORED = 'ignored', // å·²å¿½ç•¥
  SNOOZED = 'snoozed', // å·²å»¶æœŸ
}

/**
 * å“åº”åŠ¨ä½œ
 */
export enum ResponseAction {
  VIEWED = 'viewed', // æŸ¥çœ‹
  CLICKED_ACTION = 'clicked_action', // ç‚¹å‡»æ“ä½œæŒ‰é’®
  SNOOZED = 'snoozed', // å»¶æœŸ
  DISMISSED = 'dismissed', // å…³é—­
}

/**
 * æ¨é€çŠ¶æ€ï¼ˆå¤ç”¨ Notification æ¨¡å—å®šä¹‰ï¼‰
 */
export interface DeliveryStatus {
  readonly channel: NotificationChannel;
  readonly status: 'pending' | 'sent' | 'failed';
  readonly sentAt?: number;
  readonly attemptedAt?: number;
  readonly error?: string;
  readonly errorMessage?: string;
}
```

#### æ–°å¢å®ä½“ï¼šReminderOptimizationSuggestion

**ä½ç½®**: `packages/contracts/src/modules/reminder/entities/ReminderOptimizationSuggestionServer.ts`

```typescript
/**
 * æé†’ä¼˜åŒ–å»ºè®®
 */
export interface ReminderOptimizationSuggestionServerDTO {
  readonly uuid: string;
  readonly reminderUuid: string;
  readonly userUuid: string;
  readonly issueType: IssueType;
  readonly severity: 'low' | 'medium' | 'high';
  readonly statistics: OptimizationStatistics;
  readonly suggestion: string;
  readonly actions: SuggestedAction[];
  readonly status: 'pending' | 'applied' | 'ignored';
  readonly appliedAt?: number;
  readonly createdAt: number;
}

/**
 * é—®é¢˜ç±»å‹
 */
export enum IssueType {
  LOW_RESPONSE_RATE = 'low_response_rate', // å“åº”ç‡ä½
  LOW_COMPLETION_RATE = 'low_completion_rate', // å®Œæˆç‡ä½
  HIGH_FAILURE_RATE = 'high_failure_rate', // å¤±è´¥ç‡é«˜
  ALWAYS_IGNORED = 'always_ignored', // æ€»æ˜¯è¢«å¿½ç•¥
}

/**
 * ä¼˜åŒ–ç»Ÿè®¡æ•°æ®
 */
export interface OptimizationStatistics {
  readonly recentTriggers: number; // æœ€è¿‘è§¦å‘æ¬¡æ•°
  readonly responseRate: number; // å“åº”ç‡ï¼ˆ0-1ï¼‰
  readonly completionRate: number; // å®Œæˆç‡ï¼ˆ0-1ï¼‰
  readonly ignoreRate: number; // å¿½ç•¥ç‡ï¼ˆ0-1ï¼‰
  readonly failureRate: number; // å¤±è´¥ç‡ï¼ˆ0-1ï¼‰
  readonly avgResponseTime: number; // å¹³å‡å“åº”æ—¶é—´ï¼ˆç§’ï¼‰
}

/**
 * å»ºè®®åŠ¨ä½œ
 */
export interface SuggestedAction {
  readonly type: 'adjust_time' | 'change_channel' | 'modify_content' | 'delete';
  readonly label: string;
  readonly description: string;
}
```

#### æ›´æ–° Reminder å®ä½“

**ä½ç½®**: `packages/contracts/src/modules/reminder/entities/ReminderServer.ts`

```typescript
export interface ReminderServerDTO {
  // ...existing fields...

  // å†å²è¿½è¸ªç›¸å…³
  readonly history?: ReminderHistoryServerDTO[];
  readonly lastTriggeredAt?: number; // æœ€åè§¦å‘æ—¶é—´
  readonly totalTriggers?: number; // æ€»è§¦å‘æ¬¡æ•°
  readonly responseRate?: number; // å“åº”ç‡ï¼ˆ0-1ï¼‰
  readonly completionRate?: number; // å®Œæˆç‡ï¼ˆ0-1ï¼‰
  readonly needsOptimization?: boolean; // æ˜¯å¦éœ€è¦ä¼˜åŒ–
}
```

---

### äº¤äº’è®¾è®¡

#### 1. å†å²è®°å½•çŠ¶æ€æµè½¬

```
æé†’è§¦å‘ â†’ æ¨é€ï¼ˆpendingï¼‰
    â†“
æ¨é€æˆåŠŸï¼ˆsentï¼‰/ æ¨é€å¤±è´¥ï¼ˆfailedï¼‰
    â†“
ç”¨æˆ·å“åº”ï¼ˆpendingï¼‰
    â†“
â”œâ”€ å·²æŸ¥çœ‹ï¼ˆviewedï¼‰
â”œâ”€ å·²å»¶æœŸï¼ˆsnoozedï¼‰
â”œâ”€ å·²å¿½ç•¥ï¼ˆignoredï¼‰
â””â”€ å·²å®Œæˆï¼ˆcompletedï¼‰
```

#### 2. æ•ˆæœåˆ†æç»´åº¦

| ç»´åº¦     | æŒ‡æ ‡           | è®¡ç®—æ–¹å¼                |
| -------- | -------------- | ----------------------- |
| æ€»ä½“æ•ˆæœ | å“åº”ç‡         | å·²å“åº”æ¬¡æ•° / æ€»è§¦å‘æ¬¡æ•° |
|          | å®Œæˆç‡         | å·²å®Œæˆæ¬¡æ•° / æ€»è§¦å‘æ¬¡æ•° |
|          | å¿½ç•¥ç‡         | å·²å¿½ç•¥æ¬¡æ•° / æ€»è§¦å‘æ¬¡æ•° |
| æ¸ é“æ•ˆæœ | æ¨é€æˆåŠŸç‡     | æˆåŠŸæ¨é€ / å°è¯•æ¨é€     |
|          | æ¸ é“å“åº”ç‡     | è¯¥æ¸ é“å“åº” / è¯¥æ¸ é“æ¨é€ |
| æ—¶é—´è§„å¾‹ | æ—¶æ®µå“åº”ç‡     | å„æ—¶æ®µçš„å“åº”ç‡å¯¹æ¯”      |
|          | å·¥ä½œæ—¥ vs å‘¨æœ« | å“åº”ç‡å¯¹æ¯”              |

---

## 4. MVP/MMP/Full è·¯å¾„

### MVP: åŸºç¡€å†å²è®°å½•ï¼ˆ0.8-1 å‘¨ï¼‰

**èŒƒå›´**:

- âœ… æé†’è§¦å‘è‡ªåŠ¨åˆ›å»ºå†å²è®°å½•
- âœ… è®°å½•æ¨é€çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- âœ… è®°å½•ç”¨æˆ·å“åº”ï¼ˆæŸ¥çœ‹/å¿½ç•¥ï¼‰
- âœ… æŸ¥çœ‹å†å²åˆ—è¡¨
- âœ… åŸºç¡€ç»Ÿè®¡ï¼ˆè§¦å‘æ¬¡æ•°ã€å“åº”ç‡ï¼‰
- âœ… å¤±è´¥åŸå› è®°å½•

**æŠ€æœ¯è¦ç‚¹**:

- Contracts: å®šä¹‰ `ReminderHistoryServerDTO`
- Domain: Reminder èšåˆæ ¹æ·»åŠ  `recordHistory()` æ–¹æ³•
- Application: `ReminderHistoryService` åº”ç”¨æœåŠ¡
- Infrastructure: äº‹ä»¶ç›‘å¬å™¨ï¼ˆç›‘å¬æé†’è§¦å‘äº‹ä»¶ï¼‰
- API: `GET /api/v1/reminders/:uuid/history`
- UI: å†å²åˆ—è¡¨ç»„ä»¶

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given æé†’åˆ°è¾¾è§¦å‘æ—¶é—´
When ç³»ç»Ÿæ¨é€æé†’
Then åº”åˆ›å»ºå†å²è®°å½•
And è®°å½•è§¦å‘æ—¶é—´å’Œæ¨é€çŠ¶æ€
And ç”¨æˆ·å¯åœ¨å†å²åˆ—è¡¨ä¸­æŸ¥çœ‹
```

---

### MMP: æ•ˆæœåˆ†æä¸ä¼˜åŒ–å»ºè®®ï¼ˆ+0.5-1 å‘¨ï¼‰

**åœ¨ MVP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… å¤šç»´åº¦æ•ˆæœåˆ†æ
- âœ… æ¸ é“æ•ˆæœå¯¹æ¯”
- âœ… æ—¶é—´è§„å¾‹è¯†åˆ«
- âœ… å¤±æ•ˆæé†’è¯†åˆ«
- âœ… ä¼˜åŒ–å»ºè®®ç”Ÿæˆ
- âœ… ä¸€é”®ä¼˜åŒ–æ“ä½œ

**æŠ€æœ¯è¦ç‚¹**:

- ç»Ÿè®¡åˆ†æç®—æ³•
- å¤±æ•ˆæ£€æµ‹è§„åˆ™å¼•æ“
- å»ºè®®ç”Ÿæˆç®—æ³•

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given æé†’è¿ç»­ 7 å¤©è¢«å¿½ç•¥
When ç³»ç»Ÿæ‰§è¡Œå‘¨åº¦åˆ†æ
Then åº”è¯†åˆ«ä¸ºå¤±æ•ˆæé†’
And ç”Ÿæˆä¼˜åŒ–å»ºè®®
And å‘é€é€šçŸ¥ç»™ç”¨æˆ·
```

---

### Full Release: æ·±åº¦æ´å¯Ÿä¸å¯¼å‡ºï¼ˆ+1-2 å‘¨ï¼‰

**åœ¨ MMP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… å†å²æ•°æ®å¯¼å‡ºï¼ˆCSVã€JSONã€PDFï¼‰
- âœ… è·¨æé†’å¯¹æ¯”åˆ†æ
- âœ… ç”¨æˆ·è¡Œä¸ºæ¨¡å¼è¯†åˆ«ï¼ˆå¦‚ä¹ æƒ¯åœ¨ä½•æ—¶å“åº”æé†’ï¼‰
- âœ… é¢„æµ‹æ€§åˆ†æï¼ˆé¢„æµ‹æé†’æœ‰æ•ˆæ€§ï¼‰
- âœ… å¯è§†åŒ–å›¾è¡¨ï¼ˆå“åº”ç‡è¶‹åŠ¿å›¾ã€æ¸ é“æ•ˆæœå¯¹æ¯”å›¾ï¼‰

**æŠ€æœ¯è¦ç‚¹**:

- æ•°æ®å¯¼å‡ºæœåŠ¡
- è¡Œä¸ºæ¨¡å¼è¯†åˆ«ç®—æ³•
- æ•°æ®å¯è§†åŒ–

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·æœ‰ 90 å¤©çš„æé†’å†å²
When ç”¨æˆ·æŸ¥çœ‹"è¡Œä¸ºåˆ†æ"
Then åº”è¯†åˆ«ç”¨æˆ·ä¹ æƒ¯ï¼š"å·¥ä½œæ—¥æ—©æ™¨å“åº”ç‡é«˜ 85%"
And æä¾›å»ºè®®ï¼š"é‡è¦æé†’å»ºè®®å®‰æ’åœ¨å·¥ä½œæ—¥ 08:00-10:00"
```

---

## 5. éªŒæ”¶æ ‡å‡†ï¼ˆGherkinï¼‰

### Feature: æé†’å†å²è¿½è¸ª

#### Scenario 1: è‡ªåŠ¨åˆ›å»ºå†å²è®°å½•

```gherkin
Feature: æé†’å†å²è¿½è¸ª
  ä½œä¸º DailyUse ç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›ç³»ç»Ÿè‡ªåŠ¨è®°å½•æé†’å†å²

  Background:
    Given ç”¨æˆ·"éƒ‘å"å·²ç™»å½•
    And ç”¨æˆ·æœ‰ä¸€ä¸ªæé†’"æ™¨ä¼šæé†’"
    And æé†’è®¾ç½®ä¸ºæ¯å¤© 09:00 è§¦å‘
    And æ¨é€æ¸ é“ä¸ºï¼šæ¡Œé¢é€šçŸ¥ã€åº”ç”¨å†…

  Scenario: æé†’è§¦å‘åˆ›å»ºå†å²
    When å½“å‰æ—¶é—´åˆ°è¾¾ 2025-10-21 09:00
    And æé†’è§¦å‘
    Then ç³»ç»Ÿåº”åˆ›å»ºå†å²è®°å½•ï¼š
      | å­—æ®µ          | å€¼                        |
      | reminderUuid  | reminder-123             |
      | triggeredAt   | 2025-10-21 09:00:00      |
      | channels      | ['desktop', 'in_app']    |
      | userResponse  | pending                  |
    And deliveryStatus åº”åŒ…å«ï¼š
      | channel  | status  |
      | desktop  | sent    |
      | in_app   | sent    |

    When ç”¨æˆ·ç‚¹å‡»æ¡Œé¢é€šçŸ¥
    And å½“å‰æ—¶é—´ä¸º 09:01
    Then å†å²è®°å½•åº”æ›´æ–°ï¼š
      | å­—æ®µ            | å€¼                  |
      | userResponse    | viewed              |
      | respondedAt     | 2025-10-21 09:01:00 |
      | responseTime    | 60000ï¼ˆ60ç§’ï¼‰       |
      | responseAction  | viewed              |
```

---

#### Scenario 2: è®°å½•å¤±è´¥åŸå› 

```gherkin
  Background:
    Given ç”¨æˆ·æœªæˆæƒæ¡Œé¢é€šçŸ¥æƒé™

  Scenario: æ¨é€å¤±è´¥è®°å½•å¤±è´¥åŸå› 
    When æé†’è§¦å‘
    And ç³»ç»Ÿå°è¯•æ¨é€æ¡Œé¢é€šçŸ¥
    Then deliveryStatus åº”åŒ…å«ï¼š
      | channel  | status | error                          | errorMessage           |
      | desktop  | failed | NotificationPermissionDenied   | æ¡Œé¢é€šçŸ¥æƒé™è¢«æ‹’ç»     |
      | in_app   | sent   |                                |                        |
    And ç³»ç»Ÿåº”å‘é€å¤±è´¥é€šçŸ¥ï¼ˆåº”ç”¨å†…ï¼‰
    And é€šçŸ¥åº”åŒ…å«è§£å†³æ–¹æ¡ˆ
```

---

#### Scenario 3: æŸ¥çœ‹å†å²åˆ—è¡¨ä¸ç»Ÿè®¡

```gherkin
  Background:
    Given æé†’"æ™¨ä¼šæé†’"æœ‰ä»¥ä¸‹å†å²ï¼š
      | è§¦å‘æ—¶é—´       | ç”¨æˆ·å“åº” | å®ŒæˆçŠ¶æ€ |
      | 2025-10-21     | viewed   | completed|
      | 2025-10-20     | ignored  | -        |
      | 2025-10-19     | viewed   | completed|
      | 2025-10-18     | snoozed  | -        |
      | ...ï¼ˆå…± 30 æ¡ï¼‰|          |          |

  Scenario: æŸ¥çœ‹å†å²ä¸ç»Ÿè®¡
    When ç”¨æˆ·æ‰“å¼€æé†’è¯¦æƒ…é¡µ
    And ç‚¹å‡»"å†å²è®°å½•"
    Then åº”æ˜¾ç¤ºå†å²åˆ—è¡¨ï¼ˆ30 æ¡ï¼‰
    And åº”æŒ‰æ—¶é—´å€’åºæ’åˆ—
    And åº”æ˜¾ç¤ºç»Ÿè®¡æ•°æ®ï¼š
      | æŒ‡æ ‡         | å€¼      |
      | æ€»è§¦å‘æ¬¡æ•°   | 30      |
      | å“åº”ç‡       | 73.3%   |
      | å®Œæˆç‡       | 66.7%   |
      | å¹³å‡å“åº”æ—¶é—´ | 2.5åˆ†é’Ÿ |
```

---

#### Scenario 4: è¯†åˆ«å¤±æ•ˆæé†’

```gherkin
  Background:
    Given æé†’"æ¯æ—¥å¤ç›˜æé†’"è¿ç»­ 7 å¤©è¢«å¿½ç•¥

  Scenario: ç”Ÿæˆä¼˜åŒ–å»ºè®®
    When ç³»ç»Ÿæ‰§è¡Œå‘¨åº¦åˆ†æ
    Then åº”åˆ›å»ºä¼˜åŒ–å»ºè®®ï¼š
      | å­—æ®µ        | å€¼                      |
      | issueType   | always_ignored          |
      | severity    | medium                  |
      | responseRate| 0                       |
      | ignoreRate  | 1.0ï¼ˆ100%ï¼‰             |
    And suggestion åº”åŒ…å«ï¼š"å»ºè®®è°ƒæ•´æé†’æ—¶é—´æˆ–åˆ é™¤"
    And actions åº”åŒ…å«ï¼š
      | type          | label      |
      | adjust_time   | è°ƒæ•´æ—¶é—´   |
      | delete        | åˆ é™¤æé†’   |
    And ç³»ç»Ÿåº”å‘é€ä¼˜åŒ–å»ºè®®é€šçŸ¥
```

---

#### Scenario 5: æ•ˆæœåˆ†æ

```gherkin
  Background:
    Given æé†’æœ‰ 30 å¤©å†å²æ•°æ®
    And æ¡Œé¢é€šçŸ¥æ¨é€ 27 æ¬¡æˆåŠŸï¼Œå“åº” 19 æ¬¡
    And åº”ç”¨å†…æ¨é€ 30 æ¬¡æˆåŠŸï¼Œå“åº” 15 æ¬¡

  Scenario: æŸ¥çœ‹æ¸ é“æ•ˆæœå¯¹æ¯”
    When ç”¨æˆ·æ‰“å¼€"æ•ˆæœåˆ†æ"
    Then åº”æ˜¾ç¤ºæ¸ é“å¯¹æ¯”ï¼š
      | æ¸ é“       | æ¨é€æˆåŠŸç‡ | å“åº”ç‡ | å¹³å‡å“åº”æ—¶é—´ |
      | æ¡Œé¢é€šçŸ¥   | 90%        | 70.4%  | 1.8åˆ†é’Ÿ      |
      | åº”ç”¨å†…     | 100%       | 50%    | 5.2åˆ†é’Ÿ      |
    And åº”æä¾›æ´å¯Ÿï¼š"æ¡Œé¢é€šçŸ¥å“åº”ç‡æ›´é«˜ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨"
```

---

#### Scenario 6: å¯¼å‡ºå†å²

```gherkin
  Scenario: å¯¼å‡º CSV æ ¼å¼
    When ç”¨æˆ·ç‚¹å‡»"å¯¼å‡ºå†å²"
    And é€‰æ‹©æ—¶é—´èŒƒå›´ï¼š"æœ€è¿‘ 30 å¤©"
    And é€‰æ‹©æ ¼å¼ï¼š"CSV"
    And ç‚¹å‡»"å¯¼å‡º"
    Then åº”ç”Ÿæˆ CSV æ–‡ä»¶
    And æ–‡ä»¶ååº”ä¸ºï¼š"æ™¨ä¼šæé†’_å†å²_20251021.csv"
    And æ–‡ä»¶åº”åŒ…å«å­—æ®µï¼šè§¦å‘æ—¶é—´ã€æ¨é€æ¸ é“ã€ç”¨æˆ·å“åº”ã€å“åº”æ—¶é—´ã€å®ŒæˆçŠ¶æ€
    And åº”è§¦å‘æµè§ˆå™¨ä¸‹è½½
```

---

## 6. æŒ‡æ ‡ä¸è¿½è¸ª

### äº‹ä»¶åŸ‹ç‚¹

```typescript
// å†å²è®°å½•åˆ›å»º
{
  event: 'reminder_history_created',
  properties: {
    reminderUuid: string,
    triggeredAt: number,
    channels: NotificationChannel[],
    deliverySuccess: boolean
  }
}

// ç”¨æˆ·å“åº”
{
  event: 'reminder_responded',
  properties: {
    historyUuid: string,
    response: UserResponse,
    responseTime: number,  // ç§’
    respondedFrom: 'desktop' | 'in_app'
  }
}

// ä¼˜åŒ–å»ºè®®ç”Ÿæˆ
{
  event: 'reminder_optimization_suggested',
  properties: {
    reminderUuid: string,
    issueType: IssueType,
    severity: string,
    responseRate: number
  }
}

// å†å²å¯¼å‡º
{
  event: 'reminder_history_exported',
  properties: {
    reminderUuid: string,
    format: 'csv' | 'json' | 'pdf',
    recordCount: number
  }
}
```

---

### æˆåŠŸæŒ‡æ ‡

**å®šé‡æŒ‡æ ‡**:
| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹å¼ |
|------|-------|---------|
| å†å²è®°å½•åˆ›å»ºæˆåŠŸç‡ | >99% | æˆåŠŸåˆ›å»ºè®°å½•æ•° / æé†’è§¦å‘æ•° |
| å¤±æ•ˆæé†’è¯†åˆ«å‡†ç¡®ç‡ | >80% | å‡†ç¡®è¯†åˆ«æ•° / å®é™…å¤±æ•ˆæ•° |
| ä¼˜åŒ–å»ºè®®é‡‡çº³ç‡ | >40% | é‡‡çº³å»ºè®®æ•° / å»ºè®®ç”Ÿæˆæ•° |
| å¯¼å‡ºä½¿ç”¨ç‡ | >15% | å¯¼å‡ºç”¨æˆ·æ•° / æ´»è·ƒç”¨æˆ·æ•° |

**å®šæ€§æŒ‡æ ‡**:

- ç”¨æˆ·åé¦ˆ"æ›´äº†è§£æé†’æ•ˆæœ"
- å¤±æ•ˆæé†’è¢«åŠæ—¶æ¸…ç†
- æé†’å“åº”ç‡æ•´ä½“æå‡

---

## 7. æŠ€æœ¯å®ç°è¦ç‚¹

### Prisma Schema

```prisma
model ReminderHistory {
  uuid            String   @id @default(uuid())
  reminderUuid    String   @map("reminder_uuid")
  userUuid        String   @map("user_uuid")
  triggeredAt     BigInt   @map("triggered_at")
  channels        Json     @map("channels")  // NotificationChannel[]
  deliveryStatus  Json     @map("delivery_status")  // DeliveryStatus[]
  userResponse    String   @map("user_response")
  respondedAt     BigInt?  @map("responded_at")
  responseTime    Int?     @map("response_time")  // æ¯«ç§’
  responseAction  String?  @map("response_action")
  completedAt     BigInt?  @map("completed_at")
  completionTime  Int?     @map("completion_time")  // æ¯«ç§’
  metadata        Json?    @map("metadata")
  createdAt       DateTime @default(now()) @map("created_at")

  reminder        Reminder @relation(fields: [reminderUuid], references: [uuid])
  user            Account  @relation(fields: [userUuid], references: [uuid])

  @@index([reminderUuid, triggeredAt(sort: Desc)])
  @@index([userUuid, userResponse])
  @@map("reminder_histories")
}

model ReminderOptimizationSuggestion {
  uuid         String   @id @default(uuid())
  reminderUuid String   @map("reminder_uuid")
  userUuid     String   @map("user_uuid")
  issueType    String   @map("issue_type")
  severity     String   @map("severity")
  statistics   Json     @map("statistics")
  suggestion   String   @map("suggestion") @db.Text
  actions      Json     @map("actions")
  status       String   @default("pending") @map("status")
  appliedAt    BigInt?  @map("applied_at")
  createdAt    DateTime @default(now()) @map("created_at")

  reminder     Reminder @relation(fields: [reminderUuid], references: [uuid])
  user         Account  @relation(fields: [userUuid], references: [uuid])

  @@index([reminderUuid, status])
  @@index([userUuid, createdAt(sort: Desc)])
  @@map("reminder_optimization_suggestions")
}

// æ›´æ–° Reminder æ¨¡å‹
model Reminder {
  // ...existing fields...

  history               ReminderHistory[]
  optimizationSuggestions ReminderOptimizationSuggestion[]
  lastTriggeredAt       BigInt?  @map("last_triggered_at")
  totalTriggers         Int      @default(0) @map("total_triggers")
  responseRate          Float?   @map("response_rate")
  completionRate        Float?   @map("completion_rate")
  needsOptimization     Boolean  @default(false) @map("needs_optimization")
}
```

### Application Service

```typescript
// packages/domain-server/src/modules/reminder/application/ReminderHistoryService.ts

export class ReminderHistoryService {
  // åˆ›å»ºå†å²è®°å½•
  async recordTrigger(
    reminder: Reminder,
    channels: NotificationChannel[],
    deliveryStatus: DeliveryStatus[],
  ): Promise<ReminderHistory> {
    const history = new ReminderHistory({
      reminderUuid: reminder.uuid,
      userUuid: reminder.userUuid,
      triggeredAt: Date.now(),
      channels,
      deliveryStatus,
      userResponse: UserResponse.PENDING,
    });

    await this.historyRepository.save(history);

    // æ›´æ–°æé†’ç»Ÿè®¡
    await this.updateReminderStatistics(reminder);

    return history;
  }

  // è®°å½•ç”¨æˆ·å“åº”
  async recordResponse(
    historyUuid: string,
    response: UserResponse,
    action: ResponseAction,
  ): Promise<void> {
    const history = await this.historyRepository.findByUuid(historyUuid);
    const now = Date.now();

    history.updateResponse({
      userResponse: response,
      respondedAt: now,
      responseTime: now - history.triggeredAt,
      responseAction: action,
    });

    await this.historyRepository.save(history);
  }

  // åˆ†ææé†’æ•ˆæœ
  async analyzeEffectiveness(
    reminderUuid: string,
    days: number = 30,
  ): Promise<EffectivenessAnalysis> {
    const histories = await this.historyRepository.findRecent(reminderUuid, days);

    const totalTriggers = histories.length;
    const responded = histories.filter(
      (h) => h.userResponse !== UserResponse.PENDING && h.userResponse !== UserResponse.IGNORED,
    );
    const completed = histories.filter((h) => h.userResponse === UserResponse.COMPLETED);

    const responseRate = totalTriggers > 0 ? responded.length / totalTriggers : 0;
    const completionRate = totalTriggers > 0 ? completed.length / totalTriggers : 0;

    const avgResponseTime =
      responded.length > 0
        ? responded.reduce((sum, h) => sum + (h.responseTime || 0), 0) / responded.length / 1000
        : 0;

    return {
      totalTriggers,
      responseRate,
      completionRate,
      avgResponseTime,
      channelAnalysis: this.analyzeChannels(histories),
      timePatterns: this.analyzeTimePatterns(histories),
    };
  }

  // è¯†åˆ«å¤±æ•ˆæé†’
  async detectIneffectiveReminders(): Promise<void> {
    const reminders = await this.reminderRepository.findAll();

    for (const reminder of reminders) {
      const recentHistories = await this.historyRepository.findRecent(reminder.uuid, 7);

      if (recentHistories.length >= 5) {
        const ignoreRate =
          recentHistories.filter((h) => h.userResponse === UserResponse.IGNORED).length /
          recentHistories.length;

        if (ignoreRate >= 0.8) {
          // 80% å¿½ç•¥ç‡
          await this.createOptimizationSuggestion(reminder, IssueType.ALWAYS_IGNORED, 'high', {
            recentTriggers: recentHistories.length,
            responseRate: 1 - ignoreRate,
            ignoreRate,
          });
        }
      }
    }
  }
}
```

### API ç«¯ç‚¹

```typescript
// è·å–æé†’å†å²
GET /api/v1/reminders/:uuid/history?days=30&limit=50
Response: {
  history: ReminderHistoryClientDTO[],
  total: number,
  statistics: {
    totalTriggers: number,
    responseRate: number,
    completionRate: number
  }
}

// è®°å½•ç”¨æˆ·å“åº”
POST /api/v1/reminder-history/:uuid/response
Body: {
  response: UserResponse,
  action: ResponseAction
}
Response: ReminderHistoryClientDTO

// è·å–æ•ˆæœåˆ†æ
GET /api/v1/reminders/:uuid/analysis?days=30
Response: EffectivenessAnalysis

// è·å–ä¼˜åŒ–å»ºè®®
GET /api/v1/reminders/:uuid/optimization-suggestions
Response: {
  suggestions: ReminderOptimizationSuggestionClientDTO[]
}

// åº”ç”¨ä¼˜åŒ–å»ºè®®
POST /api/v1/reminder-optimization-suggestions/:uuid/apply
Response: { success: boolean }

// å¯¼å‡ºå†å²
GET /api/v1/reminders/:uuid/history/export?format=csv&days=30
Response: File (CSV/JSON/PDF)
```

---

## 8. é£é™©ä¸ç¼“è§£

| é£é™©             | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½                     |
| ---------------- | ------ | ---- | ---------------------------- |
| å†å²æ•°æ®é‡è¿‡å¤§   | é«˜     | ä¸­   | å®šæœŸå½’æ¡£ï¼ˆä¿ç•™ 90 å¤©ï¼‰+ åˆ†é¡µ |
| ç»Ÿè®¡è®¡ç®—æ€§èƒ½é—®é¢˜ | ä¸­     | ä¸­   | å¼‚æ­¥è®¡ç®— + ç¼“å­˜ç»“æœ          |
| å¤±æ•ˆæ£€æµ‹è¯¯æŠ¥     | ä¸­     | ä½   | å¯é…ç½®é˜ˆå€¼ + äººå·¥ç¡®è®¤        |
| å¯¼å‡ºæ–‡ä»¶è¿‡å¤§     | ä½     | ä½   | é™åˆ¶å¯¼å‡ºæ•°é‡ + å‹ç¼©          |

---

## 9. åç»­å¢å¼ºæ–¹å‘

### Phase 2 åŠŸèƒ½

- ğŸ”„ ç”¨æˆ·è¡Œä¸ºæ¨¡å¼è¯†åˆ«ï¼ˆå¦‚ä¹ æƒ¯ä½•æ—¶å“åº”ï¼‰
- ğŸ“Š è·¨æé†’å¯¹æ¯”åˆ†æ
- ğŸ¤– AI é¢„æµ‹æé†’æœ‰æ•ˆæ€§
- ğŸ“± ç§»åŠ¨ç«¯å†å²æŸ¥çœ‹ä¼˜åŒ–

### Phase 3 åŠŸèƒ½

- ğŸ”— ä¸ Task/Goal æ¨¡å—æ·±åº¦é›†æˆï¼ˆå…³è”ä»»åŠ¡å®Œæˆç‡ï¼‰
- ğŸ‘¥ å›¢é˜Ÿæé†’æ•ˆæœå¯¹æ¯”
- ğŸ¯ A/B æµ‹è¯•ï¼ˆä¸åŒæé†’ç­–ç•¥æ•ˆæœå¯¹æ¯”ï¼‰
- ğŸ“ˆ é•¿æœŸè¶‹åŠ¿é¢„æµ‹

---

## 10. å‚è€ƒèµ„æ–™

- [Reminder Contracts](../../../../packages/contracts/src/modules/reminder/)
- [ç”¨æˆ·è¡Œä¸ºåˆ†ææœ€ä½³å®è·µ](https://en.wikipedia.org/wiki/Behavioral_analytics)
- [A/B æµ‹è¯•æ–¹æ³•è®º](https://en.wikipedia.org/wiki/A/B_testing)

---

**æ–‡æ¡£çŠ¶æ€**: âœ… Ready for PM Review  
**ä¸‹ä¸€æ­¥**: PM ç”Ÿæˆ Project Flow

---

**æ–‡æ¡£ç»´æŠ¤**:

- åˆ›å»º: 2025-10-21
- åˆ›å»ºè€…: PO Agent
- ç‰ˆæœ¬: 1.0
- ä¸‹æ¬¡æ›´æ–°: Sprint Planning å‰

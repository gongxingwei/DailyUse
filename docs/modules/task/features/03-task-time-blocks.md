# Feature Spec: ä»»åŠ¡æ—¶é—´å—ç®¡ç†

> **åŠŸèƒ½ç¼–å·**: TASK-003  
> **RICE è¯„åˆ†**: 298.7 (Reach: 8, Impact: 7, Confidence: 8, Effort: 1.5)  
> **ä¼˜å…ˆçº§**: P0  
> **é¢„ä¼°æ—¶é—´**: 1-1.5 å‘¨  
> **çŠ¶æ€**: Draft  
> **è´Ÿè´£äºº**: TBD  
> **æœ€åæ›´æ–°**: 2025-10-21

---

## 1. æ¦‚è¿°ä¸ç›®æ ‡

### èƒŒæ™¯ä¸ç—›ç‚¹

æ—¶é—´ç›’ï¼ˆTime Boxingï¼‰æ˜¯é«˜æ•ˆä»»åŠ¡ç®¡ç†çš„æ ¸å¿ƒæ–¹æ³•è®ºï¼Œä½†ç°æœ‰ä»»åŠ¡ç®¡ç†å·¥å…·æ™®éå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

- âŒ ä»»åŠ¡åªæœ‰æˆªæ­¢æ—¥æœŸï¼Œæ²¡æœ‰æ‰§è¡Œæ—¶é—´å®‰æ’ï¼Œå¯¼è‡´æ‹–å»¶
- âŒ æ— æ³•å°†ä»»åŠ¡ä¸æ—¥å†é›†æˆï¼Œæ—¶é—´è§„åˆ’ä¸æ‰§è¡Œè„±èŠ‚
- âŒ é¢„ä¼°æ—¶é—´ä¸å®é™…æ—¶é—´æ— è¿½è¸ªï¼Œæ— æ³•ä¼˜åŒ–æ—¶é—´ç®¡ç†èƒ½åŠ›
- âŒ ç•ªèŒ„é’Ÿã€æ—¶é—´å—ç­‰æ—¶é—´ç®¡ç†æŠ€å·§æ— æ³•ä¸ä»»åŠ¡ç³»ç»Ÿé›†æˆ
- âŒ å¤šä»»åŠ¡å¹¶è¡Œæ—¶ï¼Œæ—¶é—´åˆ†é…æ··ä¹±

### ç›®æ ‡ç”¨æˆ·

- **ä¸»è¦ç”¨æˆ·**: çŸ¥è¯†å·¥ä½œè€…ã€é¡¹ç›®ç»ç†ã€è‡ªç”±èŒä¸šè€…
- **æ¬¡è¦ç”¨æˆ·**: éœ€è¦ä¸¥æ ¼æ—¶é—´ç®¡ç†çš„å­¦ç”Ÿã€åˆ›ä½œè€…
- **å…¸å‹ç”»åƒ**: "æˆ‘æœ‰å¾ˆå¤šä»»åŠ¡ï¼Œä½†ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™åšï¼Œç»å¸¸ä½ä¼°ä»»åŠ¡æ—¶é—´"

### ä»·å€¼ä¸»å¼ 

**ä¸€å¥è¯ä»·å€¼**: ä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…æ˜ç¡®çš„æ‰§è¡Œæ—¶é—´å—ï¼Œå°†è®¡åˆ’è½¬åŒ–ä¸ºè¡ŒåŠ¨ï¼Œæå‡æ—¶é—´ç®¡ç†èƒ½åŠ›

**æ ¸å¿ƒæ”¶ç›Š**:

- âœ… ä¸ºä»»åŠ¡åˆ†é…å…·ä½“æ‰§è¡Œæ—¶é—´æ®µï¼ˆå¦‚ä»Šå¤© 14:00-15:30ï¼‰
- âœ… é¢„ä¼°æ—¶é—´ vs å®é™…æ—¶é—´å¯¹æ¯”ï¼ŒæŒç»­ä¼˜åŒ–æ—¶é—´æ„ŸçŸ¥
- âœ… ä¸æ—¥å†é›†æˆï¼Œæ—¶é—´å—å¯è§†åŒ–å±•ç¤º
- âœ… æ”¯æŒç•ªèŒ„é’Ÿæ¨¡å¼ï¼ˆ25 åˆ†é’Ÿå·¥ä½œ + 5 åˆ†é’Ÿä¼‘æ¯ï¼‰
- âœ… æ—¶é—´å—å†²çªæ£€æµ‹ä¸æ™ºèƒ½è°ƒæ•´

---

## 2. ç”¨æˆ·ä»·å€¼ä¸åœºæ™¯

### æ ¸å¿ƒåœºæ™¯ 1: ä¸ºä»»åŠ¡åˆ†é…æ—¶é—´å—

**åœºæ™¯æè¿°**:  
ç”¨æˆ·ä¸ºä¸€ä¸ªä»»åŠ¡åˆ†é…æ˜ç¡®çš„æ‰§è¡Œæ—¶é—´æ®µï¼Œå°†"è¦åš"è½¬åŒ–ä¸º"ä½•æ—¶åš"ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want ä¸ºä»»åŠ¡åˆ†é…å…·ä½“çš„æ—¶é—´å—ï¼ˆå¦‚ä»Šå¤© 14:00-15:30ï¼‰
So that æˆ‘çŸ¥é“ä½•æ—¶æ‰§è¡Œï¼Œé¿å…æ‹–å»¶ï¼Œæé«˜æ‰§è¡ŒåŠ›
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€ä»»åŠ¡è¯¦æƒ…é¡µ
2. ç‚¹å‡»"å®‰æ’æ—¶é—´"æŒ‰é’®
3. ç³»ç»Ÿå¼¹å‡ºæ—¶é—´å—é…ç½®é¢æ¿ï¼š

   ```
   â° å®‰æ’ä»»åŠ¡æ—¶é—´
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ä»»åŠ¡ï¼šæ’°å†™é¡¹ç›®æŠ¥å‘Š
   é¢„ä¼°æ—¶é—´ï¼š2 å°æ—¶

   é€‰æ‹©æ‰§è¡Œæ—¶é—´ï¼š
   ğŸ“… æ—¥æœŸï¼š2025-10-21ï¼ˆä»Šå¤©ï¼‰
   ğŸ• å¼€å§‹æ—¶é—´ï¼š14:00
   ğŸ•‘ ç»“æŸæ—¶é—´ï¼š16:00
   â±ï¸  æ—¶é•¿ï¼š2 å°æ—¶

   æ—¶é—´å—æ¨¡å¼ï¼š
   ğŸ”˜ è¿ç»­å·¥ä½œï¼ˆ2 å°æ—¶ä¸é—´æ–­ï¼‰
   âšª ç•ªèŒ„é’Ÿæ¨¡å¼ï¼ˆ25åˆ†é’Ÿ Ã— 4 + ä¼‘æ¯ï¼‰
   âšª è‡ªå®šä¹‰åˆ†æ®µ

   å†²çªæ£€æµ‹ï¼š
   âœ… è¯¥æ—¶é—´æ®µæ— å†²çª

   åŒæ­¥åˆ°æ—¥å†ï¼š
   â˜‘ï¸ è‡ªåŠ¨åˆ›å»ºæ—¥å†äº‹ä»¶

   [å–æ¶ˆ]  [å®‰æ’æ—¶é—´]
   ```

4. ç”¨æˆ·é€‰æ‹©"ç•ªèŒ„é’Ÿæ¨¡å¼"
5. ç³»ç»Ÿè‡ªåŠ¨æ‹†åˆ†ä¸º 4 ä¸ªç•ªèŒ„é’Ÿï¼š
   - 14:00-14:25 (å·¥ä½œ)
   - 14:25-14:30 (ä¼‘æ¯)
   - 14:30-14:55 (å·¥ä½œ)
   - 14:55-15:00 (ä¼‘æ¯)
   - 15:00-15:25 (å·¥ä½œ)
   - 15:25-15:30 (ä¼‘æ¯)
   - 15:30-15:55 (å·¥ä½œ)
   - 15:55-16:00 (å®Œæˆ)
6. ç‚¹å‡»"å®‰æ’æ—¶é—´"
7. ç³»ç»Ÿåˆ›å»ºæ—¶é—´å—è®°å½•å¹¶åŒæ­¥åˆ°æ—¥å†

**é¢„æœŸç»“æœ**:

- Task æ–°å¢å­—æ®µï¼š
  ```typescript
  readonly timeBlocks?: TimeBlock[];
  readonly estimatedTime?: number;   // é¢„ä¼°æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  readonly actualTime?: number;      // å®é™…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  ```
- TimeBlock ç»“æ„ï¼š
  ```typescript
  {
    uuid: string,
    taskUuid: string,
    startTime: number,          // å¼€å§‹æ—¶é—´æˆ³
    endTime: number,            // ç»“æŸæ—¶é—´æˆ³
    duration: number,           // æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    mode: 'continuous' | 'pomodoro' | 'custom',
    status: 'scheduled' | 'in-progress' | 'paused' | 'completed' | 'cancelled',
    actualStartTime?: number,   // å®é™…å¼€å§‹æ—¶é—´
    actualEndTime?: number,     // å®é™…ç»“æŸæ—¶é—´
    pomodoroConfig?: {          // ç•ªèŒ„é’Ÿé…ç½®
      workDuration: number,     // å·¥ä½œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 25ï¼‰
      breakDuration: number,    // ä¼‘æ¯æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 5ï¼‰
      longBreakInterval: number,// é•¿ä¼‘æ¯é—´éš”ï¼ˆé»˜è®¤ 4ï¼‰
      longBreakDuration: number // é•¿ä¼‘æ¯æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 15ï¼‰
    },
    createdAt: number,
    updatedAt: number
  }
  ```

---

### æ ¸å¿ƒåœºæ™¯ 2: å¼€å§‹æ‰§è¡Œæ—¶é—´å—ï¼ˆç•ªèŒ„é’Ÿè®¡æ—¶ï¼‰

**åœºæ™¯æè¿°**:  
åˆ°è¾¾ä»»åŠ¡æ—¶é—´å—çš„å¼€å§‹æ—¶é—´ï¼Œç”¨æˆ·å¼€å§‹æ‰§è¡Œä»»åŠ¡å¹¶å¯åŠ¨è®¡æ—¶å™¨ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want åœ¨ä»»åŠ¡æ—¶é—´å—å¼€å§‹æ—¶å¯åŠ¨è®¡æ—¶å™¨
So that æˆ‘å¯ä»¥ä¸“æ³¨å·¥ä½œï¼Œå¹¶è®°å½•å®é™…æ‰§è¡Œæ—¶é—´
```

**æ“ä½œæµç¨‹**:

1. å½“å‰æ—¶é—´åˆ°è¾¾ 14:00
2. ç³»ç»Ÿå‘é€æé†’ï¼š"â° ä»»åŠ¡æ—¶é—´å—å³å°†å¼€å§‹ï¼šæ’°å†™é¡¹ç›®æŠ¥å‘Šï¼ˆ14:00-16:00ï¼‰"
3. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹"
4. ç³»ç»Ÿè¿›å…¥ç•ªèŒ„é’Ÿå·¥ä½œç•Œé¢ï¼š

   ```
   ğŸ… ç•ªèŒ„é’Ÿ - ç¬¬ 1 ä¸ª
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ä»»åŠ¡ï¼šæ’°å†™é¡¹ç›®æŠ¥å‘Š

   â±ï¸  24:58
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’ 1/4

   [æš‚åœ]  [å®Œæˆ]  [æ”¾å¼ƒ]

   ä¸‹ä¸€ä¸ªï¼šä¼‘æ¯ 5 åˆ†é’Ÿï¼ˆ14:25ï¼‰
   ```

5. è®¡æ—¶å™¨å€’è®¡æ—¶ 25 åˆ†é’Ÿ
6. åˆ°è¾¾ 14:25ï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›å…¥ä¼‘æ¯ï¼š

   ```
   â˜• ä¼‘æ¯æ—¶é—´
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   â±ï¸  04:58

   ğŸ’¡ å»ºè®®ï¼šç«™èµ·æ¥èµ°åŠ¨ã€å–æ°´ã€æ”¾æ¾çœ¼ç›

   [è·³è¿‡ä¼‘æ¯ï¼Œç»§ç»­å·¥ä½œ]
   ```

7. ä¼‘æ¯ç»“æŸåè‡ªåŠ¨è¿›å…¥ä¸‹ä¸€ä¸ªç•ªèŒ„é’Ÿ
8. å®Œæˆ 4 ä¸ªç•ªèŒ„é’Ÿåä»»åŠ¡æ ‡è®°ä¸ºå®Œæˆ

**é¢„æœŸç»“æœ**:

- TimeBlock çŠ¶æ€å˜åŒ–ï¼š`scheduled` â†’ `in-progress` â†’ `completed`
- è®°å½•å®é™…å¼€å§‹/ç»“æŸæ—¶é—´
- è®¡ç®—å®é™…æ—¶é•¿å¹¶æ›´æ–° Task çš„ `actualTime`

---

### æ ¸å¿ƒåœºæ™¯ 3: æ—¶é—´å—å†²çªæ£€æµ‹

**åœºæ™¯æè¿°**:  
ç”¨æˆ·å°è¯•ä¸ºä»»åŠ¡åˆ†é…æ—¶é—´å—ï¼Œä½†ä¸å·²æœ‰æ—¶é—´å—å†²çªã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹æ—¶é—´å—å†²çª
So that æˆ‘å¯ä»¥é¿å…æ—¶é—´å®‰æ’é‡å ï¼Œåˆç†è°ƒæ•´è®¡åˆ’
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·ä¸º"æ’°å†™æŠ€æœ¯æ–‡æ¡£"ä»»åŠ¡åˆ†é…æ—¶é—´å—ï¼š14:30-16:30
2. ç³»ç»Ÿæ£€æµ‹åˆ°ä¸"æ’°å†™é¡¹ç›®æŠ¥å‘Š"ï¼ˆ14:00-16:00ï¼‰å†²çª
3. æ˜¾ç¤ºå†²çªæç¤ºï¼š

   ```
   âš ï¸ æ—¶é—´å†²çª
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ‚¨é€‰æ‹©çš„æ—¶é—´æ®µï¼š
   ğŸ“… 2025-10-21 14:30-16:30

   ä¸ä»¥ä¸‹æ—¶é—´å—å†²çªï¼š
   ğŸ”´ æ’°å†™é¡¹ç›®æŠ¥å‘Š
      14:00-16:00ï¼ˆå†²çª 30 åˆ†é’Ÿï¼‰

   å»ºè®®è°ƒæ•´ï¼š
   âœ… æ–¹æ¡ˆ1ï¼šè°ƒæ•´ä¸º 16:00-18:00ï¼ˆæ— å†²çªï¼‰
   âœ… æ–¹æ¡ˆ2ï¼šè°ƒæ•´ä¸ºæ˜å¤© 14:30-16:30ï¼ˆæ— å†²çªï¼‰
   âš ï¸ æ–¹æ¡ˆ3ï¼šä¿æŒ 14:30-16:30ï¼Œå–æ¶ˆ"æ’°å†™é¡¹ç›®æŠ¥å‘Š"

   [é€‰æ‹©æ–¹æ¡ˆ1]  [é€‰æ‹©æ–¹æ¡ˆ2]  [æ‰‹åŠ¨è°ƒæ•´]
   ```

4. ç”¨æˆ·é€‰æ‹©"æ–¹æ¡ˆ1"
5. ç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´æ—¶é—´å—ä¸º 16:00-18:00

**é¢„æœŸç»“æœ**:

- å†²çªæ£€æµ‹ç®—æ³•æ£€æŸ¥æ‰€æœ‰å·²æœ‰æ—¶é—´å—
- æä¾›æ™ºèƒ½è°ƒæ•´æ–¹æ¡ˆ
- æ”¯æŒå¼ºåˆ¶è¦†ç›–ï¼ˆéœ€ç¡®è®¤ï¼‰

---

### æ ¸å¿ƒåœºæ™¯ 4: æ—¶é—´å—å¯è§†åŒ–ï¼ˆæ—¥å†è§†å›¾ï¼‰

**åœºæ™¯æè¿°**:  
ç”¨æˆ·æŸ¥çœ‹æ—¥å†ï¼Œç›´è§‚äº†è§£æ‰€æœ‰ä»»åŠ¡çš„æ—¶é—´å—åˆ†å¸ƒã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want åœ¨æ—¥å†è§†å›¾ä¸­æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡çš„æ—¶é—´å—
So that æˆ‘å¯ä»¥ç›´è§‚äº†è§£æ—¶é—´å®‰æ’ï¼Œé¿å…è¿‡è½½
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€æ—¥å†è§†å›¾
2. ç³»ç»Ÿå±•ç¤ºæ—¶é—´å—åˆ†å¸ƒï¼š
   ```
   ğŸ“… 2025-10-21ï¼ˆä»Šå¤©ï¼‰
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   08:00 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  æ™¨ä¼š (30åˆ†é’Ÿ)   â”‚ [Schedule]
   08:30 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   09:00
   ...
   14:00 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æ’°å†™é¡¹ç›®æŠ¥å‘Š (2å°æ—¶)     â”‚ [Task]
         â”‚ ğŸ…ğŸ…ğŸ…ğŸ… (ç•ªèŒ„é’Ÿæ¨¡å¼)   â”‚
   16:00 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   16:00 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æ’°å†™æŠ€æœ¯æ–‡æ¡£ (2å°æ—¶)     â”‚ [Task]
   18:00 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   19:00
   ...
   ```
3. æ—¶é—´å—é¢œè‰²ç¼–ç ï¼š
   - ğŸŸ¢ å·²å®Œæˆ
   - ğŸŸ¡ è¿›è¡Œä¸­
   - ğŸ”µ å·²å®‰æ’
   - ğŸ”´ å·²è¿‡æœŸ
4. ç‚¹å‡»æ—¶é—´å—å¯æŸ¥çœ‹è¯¦æƒ…æˆ–å¿«é€Ÿæ“ä½œï¼ˆå¼€å§‹/å–æ¶ˆ/è°ƒæ•´ï¼‰

**é¢„æœŸç»“æœ**:

- æ—¥å†è§†å›¾é›†æˆä»»åŠ¡æ—¶é—´å—
- æ”¯æŒæ‹–æ‹½è°ƒæ•´æ—¶é—´å—
- æ˜¾ç¤ºæ—¶é—´åˆ©ç”¨ç‡ï¼ˆå¦‚ä»Šå¤©å®‰æ’äº† 6 å°æ—¶ï¼‰

---

### æ ¸å¿ƒåœºæ™¯ 5: é¢„ä¼°æ—¶é—´ vs å®é™…æ—¶é—´å¯¹æ¯”

**åœºæ™¯æè¿°**:  
ä»»åŠ¡å®Œæˆåï¼Œç³»ç»Ÿå¯¹æ¯”é¢„ä¼°æ—¶é—´ä¸å®é™…æ—¶é—´ï¼Œå¸®åŠ©ç”¨æˆ·æå‡æ—¶é—´æ„ŸçŸ¥ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want æŸ¥çœ‹ä»»åŠ¡çš„é¢„ä¼°æ—¶é—´ä¸å®é™…æ—¶é—´å¯¹æ¯”
So that æˆ‘å¯ä»¥äº†è§£è‡ªå·±çš„æ—¶é—´ä¼°ç®—èƒ½åŠ›ï¼Œå¹¶æŒç»­æ”¹è¿›
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·å®Œæˆ"æ’°å†™é¡¹ç›®æŠ¥å‘Š"ä»»åŠ¡
2. ç³»ç»Ÿè®°å½•å®é™…æ—¶é—´ï¼š2.5 å°æ—¶ï¼ˆé¢„ä¼° 2 å°æ—¶ï¼‰
3. ä»»åŠ¡è¯¦æƒ…é¡µæ˜¾ç¤ºæ—¶é—´å¯¹æ¯”ï¼š

   ```
   â±ï¸  æ—¶é—´ç»Ÿè®¡
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   é¢„ä¼°æ—¶é—´ï¼š2 å°æ—¶
   å®é™…æ—¶é—´ï¼š2.5 å°æ—¶
   åå·®ï¼š+25% (è¶…å‡º 30 åˆ†é’Ÿ)

   æ•ˆç‡åˆ†æï¼š
   âš ï¸ æ‚¨ä½ä¼°äº†æ­¤ä»»åŠ¡çš„æ—¶é—´
   ğŸ’¡ å»ºè®®ï¼šç±»ä¼¼ä»»åŠ¡é¢„ä¼°æ—¶å¢åŠ  20-30%

   æ—¶é—´åˆ†å¸ƒï¼š
   - ç¬¬1ä¸ªç•ªèŒ„é’Ÿï¼š25åˆ†é’Ÿ âœ…
   - ç¬¬2ä¸ªç•ªèŒ„é’Ÿï¼š28åˆ†é’Ÿ âš ï¸ (è¶…æ—¶3åˆ†é’Ÿ)
   - ç¬¬3ä¸ªç•ªèŒ„é’Ÿï¼š25åˆ†é’Ÿ âœ…
   - ç¬¬4ä¸ªç•ªèŒ„é’Ÿï¼š32åˆ†é’Ÿ âš ï¸ (è¶…æ—¶7åˆ†é’Ÿ)
   ```

4. ç”¨æˆ·çš„æ—¶é—´ä¼°ç®—å‡†ç¡®ç‡è¢«è®°å½•ç”¨äºåç»­åˆ†æ

**é¢„æœŸç»“æœ**:

- æ¯ä¸ªä»»åŠ¡è®°å½• `estimatedTime` å’Œ `actualTime`
- è®¡ç®—æ—¶é—´åå·®ç‡
- ç”Ÿæˆæ—¶é—´ç®¡ç†æ´å¯ŸæŠ¥å‘Š

---

### æ ¸å¿ƒåœºæ™¯ 6: æ‰¹é‡å®‰æ’æ—¶é—´å—

**åœºæ™¯æè¿°**:  
ç”¨æˆ·ä¸€æ¬¡æ€§ä¸ºå¤šä¸ªä»»åŠ¡å®‰æ’æ—¶é—´å—ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ä»»åŠ¡æ‰§è¡Œè€…
I want æ‰¹é‡ä¸ºå¤šä¸ªä»»åŠ¡å®‰æ’æ—¶é—´å—
So that æˆ‘å¯ä»¥å¿«é€Ÿè§„åˆ’ä¸€å¤©æˆ–ä¸€å‘¨çš„æ—¶é—´
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·è¿›å…¥"ä»Šæ—¥ä»»åŠ¡"è§†å›¾
2. å‹¾é€‰ 3 ä¸ªä»»åŠ¡ï¼š
   - æ’°å†™é¡¹ç›®æŠ¥å‘Šï¼ˆé¢„ä¼° 2 å°æ—¶ï¼‰
   - ä»£ç å®¡æŸ¥ï¼ˆé¢„ä¼° 1 å°æ—¶ï¼‰
   - å›å¤é‚®ä»¶ï¼ˆé¢„ä¼° 30 åˆ†é’Ÿï¼‰
3. ç‚¹å‡»"æ‰¹é‡å®‰æ’æ—¶é—´"
4. ç³»ç»Ÿæ™ºèƒ½æ¨èæ—¶é—´å®‰æ’ï¼š

   ```
   ğŸ“… æ™ºèƒ½æ—¶é—´å®‰æ’
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   åŸºäºæ‚¨çš„å·¥ä½œä¹ æƒ¯ï¼Œæ¨èä»¥ä¸‹å®‰æ’ï¼š

   ğŸŒ… ä¸Šåˆï¼ˆé«˜ä¸“æ³¨åº¦ï¼Œé€‚åˆæ·±åº¦å·¥ä½œï¼‰
   09:00-11:00  æ’°å†™é¡¹ç›®æŠ¥å‘Šï¼ˆ2å°æ—¶ï¼‰

   ğŸŒ¤ï¸  ä¸­åˆï¼ˆä¸“æ³¨åº¦ä¸‹é™ï¼Œé€‚åˆæ²Ÿé€šï¼‰
   13:00-13:30  å›å¤é‚®ä»¶ï¼ˆ30åˆ†é’Ÿï¼‰

   ğŸŒ† ä¸‹åˆï¼ˆä¸“æ³¨åº¦æ¢å¤ï¼Œé€‚åˆè¯„å®¡ï¼‰
   14:00-15:00  ä»£ç å®¡æŸ¥ï¼ˆ1å°æ—¶ï¼‰

   æ€»æ—¶é•¿ï¼š3.5 å°æ—¶
   ç©ºé—²æ—¶é—´ï¼š4.5 å°æ—¶

   [æ¥å—æ¨è]  [æ‰‹åŠ¨è°ƒæ•´]  [å–æ¶ˆ]
   ```

5. ç”¨æˆ·ç‚¹å‡»"æ¥å—æ¨è"
6. ç³»ç»Ÿæ‰¹é‡åˆ›å»ºæ—¶é—´å—

**é¢„æœŸç»“æœ**:

- æ™ºèƒ½æ¨èåŸºäºä»»åŠ¡ä¼˜å…ˆçº§ã€ç±»å‹ã€ç”¨æˆ·ä¹ æƒ¯
- è‡ªåŠ¨é¿å¼€å·²æœ‰æ—¶é—´å—
- æ”¯æŒä¸€é”®æ¥å—æˆ–æ‹–æ‹½è°ƒæ•´

---

## 3. è®¾è®¡è¦ç‚¹

### æ¶‰åŠå­—æ®µï¼ˆå¯¹é½ Contractsï¼‰

#### æ›´æ–° Task å®ä½“

**ä½ç½®**: `packages/contracts/src/modules/task/entities/TaskServer.ts`

```typescript
export interface TaskServerDTO {
  // ...existing fields...

  // æ—¶é—´å—ç›¸å…³
  readonly timeBlocks?: TimeBlockServerDTO[];
  readonly estimatedTime?: number; // é¢„ä¼°æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  readonly actualTime?: number; // å®é™…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  readonly timeEstimationAccuracy?: number; // æ—¶é—´ä¼°ç®—å‡†ç¡®ç‡ (0-1)
}
```

#### æ–°å¢å®ä½“ï¼šTimeBlock

**ä½ç½®**: `packages/contracts/src/modules/task/entities/TimeBlockServer.ts`

```typescript
/**
 * æ—¶é—´å—
 */
export interface TimeBlockServerDTO {
  readonly uuid: string;
  readonly taskUuid: string;
  readonly userUuid: string;
  readonly startTime: number; // å¼€å§‹æ—¶é—´æˆ³
  readonly endTime: number; // ç»“æŸæ—¶é—´æˆ³
  readonly duration: number; // æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  readonly mode: TimeBlockMode;
  readonly status: TimeBlockStatus;
  readonly actualStartTime?: number; // å®é™…å¼€å§‹æ—¶é—´
  readonly actualEndTime?: number; // å®é™…ç»“æŸæ—¶é—´
  readonly actualDuration?: number; // å®é™…æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  readonly pomodoroConfig?: PomodoroConfig;
  readonly pomodoroSessions?: PomodoroSession[]; // ç•ªèŒ„é’Ÿä¼šè¯è®°å½•
  readonly syncedToCalendar: boolean; // æ˜¯å¦å·²åŒæ­¥åˆ°æ—¥å†
  readonly calendarEventId?: string; // æ—¥å†äº‹ä»¶ ID
  readonly createdAt: number;
  readonly updatedAt: number;
}

/**
 * æ—¶é—´å—æ¨¡å¼
 */
export enum TimeBlockMode {
  CONTINUOUS = 'continuous', // è¿ç»­å·¥ä½œ
  POMODORO = 'pomodoro', // ç•ªèŒ„é’Ÿ
  CUSTOM = 'custom', // è‡ªå®šä¹‰åˆ†æ®µ
}

/**
 * æ—¶é—´å—çŠ¶æ€
 */
export enum TimeBlockStatus {
  SCHEDULED = 'scheduled', // å·²å®‰æ’
  IN_PROGRESS = 'in-progress', // è¿›è¡Œä¸­
  PAUSED = 'paused', // å·²æš‚åœ
  COMPLETED = 'completed', // å·²å®Œæˆ
  CANCELLED = 'cancelled', // å·²å–æ¶ˆ
  OVERDUE = 'overdue', // å·²è¿‡æœŸï¼ˆæœªæ‰§è¡Œï¼‰
}

/**
 * ç•ªèŒ„é’Ÿé…ç½®
 */
export interface PomodoroConfig {
  readonly workDuration: number; // å·¥ä½œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 25ï¼‰
  readonly breakDuration: number; // çŸ­ä¼‘æ¯æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 5ï¼‰
  readonly longBreakInterval: number; // é•¿ä¼‘æ¯é—´éš”ï¼ˆé»˜è®¤ 4 ä¸ªç•ªèŒ„é’Ÿï¼‰
  readonly longBreakDuration: number; // é•¿ä¼‘æ¯æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼Œé»˜è®¤ 15ï¼‰
}

/**
 * ç•ªèŒ„é’Ÿä¼šè¯è®°å½•
 */
export interface PomodoroSession {
  readonly sessionNumber: number; // ç¬¬å‡ ä¸ªç•ªèŒ„é’Ÿ
  readonly type: 'work' | 'break' | 'long-break';
  readonly plannedDuration: number; // è®¡åˆ’æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  readonly actualDuration: number; // å®é™…æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  readonly startTime: number;
  readonly endTime: number;
  readonly completed: boolean; // æ˜¯å¦å®Œæ•´å®Œæˆï¼ˆæœªä¸­æ–­ï¼‰
}
```

---

### äº¤äº’è®¾è®¡

#### 1. æ—¶é—´å—åˆ›å»ºæµç¨‹

```
é€‰æ‹©ä»»åŠ¡ â†’ ç‚¹å‡»"å®‰æ’æ—¶é—´"
    â†“
é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´èŒƒå›´
    â†“
é€‰æ‹©æ—¶é—´å—æ¨¡å¼ï¼ˆè¿ç»­/ç•ªèŒ„é’Ÿ/è‡ªå®šä¹‰ï¼‰
    â†“
å†²çªæ£€æµ‹ï¼ˆå¦‚æœ‰å†²çªï¼Œæ˜¾ç¤ºè°ƒæ•´å»ºè®®ï¼‰
    â†“
ç¡®è®¤åˆ›å»º â†’ åŒæ­¥åˆ°æ—¥å†ï¼ˆå¯é€‰ï¼‰
    â†“
åˆ›å»ºæˆåŠŸï¼Œåˆ°æ—¶æé†’
```

#### 2. ç•ªèŒ„é’Ÿæ‰§è¡Œæµç¨‹

```
æ—¶é—´åˆ°è¾¾ â†’ å‘é€æé†’ â†’ ç”¨æˆ·ç‚¹å‡»"å¼€å§‹"
    â†“
ç¬¬1ä¸ªç•ªèŒ„é’Ÿï¼ˆ25åˆ†é’Ÿå·¥ä½œï¼‰
    â†“
çŸ­ä¼‘æ¯ï¼ˆ5åˆ†é’Ÿï¼‰
    â†“
ç¬¬2ä¸ªç•ªèŒ„é’Ÿï¼ˆ25åˆ†é’Ÿå·¥ä½œï¼‰
    â†“
çŸ­ä¼‘æ¯ï¼ˆ5åˆ†é’Ÿï¼‰
    â†“
ç¬¬3ä¸ªç•ªèŒ„é’Ÿï¼ˆ25åˆ†é’Ÿå·¥ä½œï¼‰
    â†“
çŸ­ä¼‘æ¯ï¼ˆ5åˆ†é’Ÿï¼‰
    â†“
ç¬¬4ä¸ªç•ªèŒ„é’Ÿï¼ˆ25åˆ†é’Ÿå·¥ä½œï¼‰
    â†“
é•¿ä¼‘æ¯ï¼ˆ15åˆ†é’Ÿï¼‰
    â†“
å®Œæˆï¼Œè®°å½•å®é™…æ—¶é—´
```

#### 3. UI çŠ¶æ€æŒ‡ç¤º

| æ—¶é—´å—çŠ¶æ€  | é¢œè‰² | å›¾æ ‡ | æ“ä½œ           |
| ----------- | ---- | ---- | -------------- |
| scheduled   | è“è‰² | ğŸ“…   | å¼€å§‹/å–æ¶ˆ/è°ƒæ•´ |
| in-progress | ç»¿è‰² | â–¶ï¸   | æš‚åœ/å®Œæˆ      |
| paused      | é»„è‰² | â¸ï¸   | ç»§ç»­/å–æ¶ˆ      |
| completed   | ç°è‰² | âœ…   | æŸ¥çœ‹è¯¦æƒ…       |
| cancelled   | çº¢è‰² | âŒ   | é‡æ–°å®‰æ’       |
| overdue     | æ©™è‰² | âš ï¸   | é‡æ–°å®‰æ’       |

---

## 4. MVP/MMP/Full è·¯å¾„

### MVP: åŸºç¡€æ—¶é—´å—ç®¡ç†ï¼ˆ1-1.5 å‘¨ï¼‰

**èŒƒå›´**:

- âœ… ä¸ºå•ä¸ªä»»åŠ¡åˆ†é…æ—¶é—´å—ï¼ˆæ—¥æœŸ + å¼€å§‹/ç»“æŸæ—¶é—´ï¼‰
- âœ… è¿ç»­å·¥ä½œæ¨¡å¼ï¼ˆä¸æ”¯æŒç•ªèŒ„é’Ÿï¼‰
- âœ… æ—¶é—´å—å†²çªæ£€æµ‹ï¼ˆåŸºç¡€ç‰ˆï¼‰
- âœ… æ—¶é—´å—çŠ¶æ€ç®¡ç†ï¼ˆscheduled, in-progress, completedï¼‰
- âœ… è®°å½•é¢„ä¼°æ—¶é—´ vs å®é™…æ—¶é—´
- âœ… æ—¥å†è§†å›¾æ˜¾ç¤ºæ—¶é—´å—ï¼ˆåªè¯»ï¼‰

**æŠ€æœ¯è¦ç‚¹**:

- Contracts: å®šä¹‰ `TimeBlockServerDTO`
- Domain: Task èšåˆæ ¹æ·»åŠ  `scheduleTimeBlock()` æ–¹æ³•
- Application: `ScheduleTimeBlockService` åº”ç”¨æœåŠ¡
- API: `POST /api/v1/tasks/:taskUuid/time-blocks`
- UI: æ—¶é—´å—é…ç½®é¢æ¿ + æ—¥å†è§†å›¾é›†æˆ

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·æœ‰ä¸€ä¸ªä»»åŠ¡"æ’°å†™æŠ¥å‘Š"
When ç”¨æˆ·ä¸ºè¯¥ä»»åŠ¡å®‰æ’æ—¶é—´å—ï¼š2025-10-21 14:00-16:00
Then ç³»ç»Ÿåº”åˆ›å»ºæ—¶é—´å—è®°å½•
And æ—¥å†è§†å›¾åº”æ˜¾ç¤ºè¯¥æ—¶é—´å—
And åˆ°è¾¾ 14:00 æ—¶åº”å‘é€æé†’
```

---

### MMP: ç•ªèŒ„é’Ÿä¸æ™ºèƒ½æ¨èï¼ˆ+1-2 å‘¨ï¼‰

**åœ¨ MVP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… ç•ªèŒ„é’Ÿæ¨¡å¼ï¼ˆ25åˆ†é’Ÿå·¥ä½œ + 5åˆ†é’Ÿä¼‘æ¯ï¼‰
- âœ… ç•ªèŒ„é’Ÿè®¡æ—¶å™¨ UIï¼ˆå€’è®¡æ—¶ + è¿›åº¦æ¡ï¼‰
- âœ… ç•ªèŒ„é’Ÿä¼šè¯è®°å½•
- âœ… æ™ºèƒ½æ—¶é—´æ¨èï¼ˆæ‰¹é‡å®‰æ’ï¼‰
- âœ… æ—¶é—´å—æ‹–æ‹½è°ƒæ•´ï¼ˆæ—¥å†è§†å›¾ï¼‰
- âœ… åŒæ­¥åˆ°ç³»ç»Ÿæ—¥å†ï¼ˆICS æ ¼å¼ï¼‰

**æŠ€æœ¯è¦ç‚¹**:

- ç•ªèŒ„é’ŸçŠ¶æ€æœºï¼ˆwork â†’ break â†’ work â†’ ...ï¼‰
- WebWorker å®ç°ç²¾ç¡®è®¡æ—¶
- æ‹–æ‹½è°ƒæ•´è§¦å‘å†²çªæ£€æµ‹
- iCalendar åè®®é›†æˆ

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·é€‰æ‹©ç•ªèŒ„é’Ÿæ¨¡å¼
When æ—¶é—´å—å¼€å§‹æ‰§è¡Œ
Then ç³»ç»Ÿåº”è‡ªåŠ¨è¿›å…¥ç¬¬1ä¸ªç•ªèŒ„é’Ÿï¼ˆ25åˆ†é’Ÿï¼‰
And å€’è®¡æ—¶ç»“æŸåè‡ªåŠ¨è¿›å…¥ä¼‘æ¯ï¼ˆ5åˆ†é’Ÿï¼‰
And å¾ªç¯ç›´åˆ°å®Œæˆæ‰€æœ‰ç•ªèŒ„é’Ÿ
And è®°å½•æ¯ä¸ªç•ªèŒ„é’Ÿçš„å®é™…æ—¶é•¿
```

---

### Full Release: é«˜çº§æ—¶é—´ç®¡ç†ï¼ˆ+2-3 å‘¨ï¼‰

**åœ¨ MMP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… è‡ªå®šä¹‰åˆ†æ®µæ¨¡å¼ï¼ˆå¦‚ 50åˆ†é’Ÿå·¥ä½œ + 10åˆ†é’Ÿä¼‘æ¯ï¼‰
- âœ… æ—¶é—´å—æ¨¡æ¿ï¼ˆå¸¸ç”¨æ—¶é—´å®‰æ’å¿«é€Ÿåº”ç”¨ï¼‰
- âœ… æ—¶é—´åˆ©ç”¨ç‡åˆ†æï¼ˆæ¯æ—¥/æ¯å‘¨ï¼‰
- âœ… ä¸“æ³¨åº¦çƒ­åŠ›å›¾ï¼ˆå“ªä¸ªæ—¶é—´æ®µæœ€é«˜æ•ˆï¼‰
- âœ… æ—¶é—´ä¼°ç®—å‡†ç¡®ç‡è¶‹åŠ¿
- âœ… ä¸ Schedule æ¨¡å—æ·±åº¦é›†æˆï¼ˆè‡ªåŠ¨å¡«å……ç©ºé—²æ—¶é—´ï¼‰
- âœ… å¤šè®¾å¤‡åŒæ­¥ï¼ˆå®æ—¶æ›´æ–°æ—¶é—´å—çŠ¶æ€ï¼‰

**æŠ€æœ¯è¦ç‚¹**:

- æ—¶é—´åˆ©ç”¨ç‡ç®—æ³•ï¼ˆå·¥ä½œæ—¶é—´ / æ€»å¯ç”¨æ—¶é—´ï¼‰
- ä¸“æ³¨åº¦åˆ†æï¼ˆåŸºäºå®é™…å®Œæˆæ—¶é—´ä¸è®¡åˆ’æ—¶é—´çš„åå·®ï¼‰
- WebSocket å®æ—¶åŒæ­¥æ—¶é—´å—çŠ¶æ€

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·åœ¨æ¡Œé¢ç«¯å¼€å§‹ä¸€ä¸ªæ—¶é—´å—
When ç”¨æˆ·åˆ‡æ¢åˆ°ç§»åŠ¨ç«¯
Then ç§»åŠ¨ç«¯åº”å®æ—¶æ˜¾ç¤ºæ—¶é—´å—è¿›è¡Œä¸­çŠ¶æ€
And å€’è®¡æ—¶åº”åŒæ­¥
```

---

## 5. éªŒæ”¶æ ‡å‡†ï¼ˆGherkinï¼‰

### Feature: ä»»åŠ¡æ—¶é—´å—ç®¡ç†

#### Scenario 1: ä¸ºä»»åŠ¡åˆ†é…æ—¶é—´å—

```gherkin
Feature: ä»»åŠ¡æ—¶é—´å—ç®¡ç†
  ä½œä¸ºä»»åŠ¡æ‰§è¡Œè€…ï¼Œæˆ‘å¸Œæœ›ä¸ºä»»åŠ¡åˆ†é…æ—¶é—´å—

  Background:
    Given ç”¨æˆ·"éƒ‘å"å·²ç™»å½•
    And ç”¨æˆ·æœ‰ä»¥ä¸‹ä»»åŠ¡ï¼š
      | uuid    | title        | estimatedTime |
      | task-1  | æ’°å†™é¡¹ç›®æŠ¥å‘Š  | 120ï¼ˆåˆ†é’Ÿï¼‰   |
      | task-2  | ä»£ç å®¡æŸ¥      | 60ï¼ˆåˆ†é’Ÿï¼‰    |

  Scenario: æˆåŠŸåˆ›å»ºæ—¶é—´å—
    When ç”¨æˆ·æ‰“å¼€ä»»åŠ¡"task-1"è¯¦æƒ…é¡µ
    And ç‚¹å‡»"å®‰æ’æ—¶é—´"
    And é€‰æ‹©æ—¥æœŸï¼š"2025-10-21"
    And é€‰æ‹©æ—¶é—´ï¼š"14:00-16:00"
    And é€‰æ‹©æ¨¡å¼ï¼š"è¿ç»­å·¥ä½œ"
    And å‹¾é€‰"åŒæ­¥åˆ°æ—¥å†"
    And ç‚¹å‡»"å®‰æ’æ—¶é—´"
    Then ç³»ç»Ÿåº”åˆ›å»º TimeBlock è®°å½•ï¼š
      | å­—æ®µ          | å€¼                     |
      | taskUuid      | task-1                |
      | startTime     | 2025-10-21 14:00:00   |
      | endTime       | 2025-10-21 16:00:00   |
      | duration      | 120ï¼ˆåˆ†é’Ÿï¼‰            |
      | mode          | continuous            |
      | status        | scheduled             |
    And æ—¥å†è§†å›¾åº”æ˜¾ç¤ºè¯¥æ—¶é—´å—
    And ç³»ç»Ÿåº”åœ¨ 2025-10-21 13:55 å‘é€æé†’

  Scenario: æ—¶é—´å—å†²çªæ£€æµ‹
    Given ä»»åŠ¡"task-1"å·²æœ‰æ—¶é—´å—ï¼š14:00-16:00
    When ç”¨æˆ·ä¸ºä»»åŠ¡"task-2"å®‰æ’æ—¶é—´å—ï¼š15:00-16:00
    Then ç³»ç»Ÿåº”æ˜¾ç¤ºå†²çªè­¦å‘Šï¼š
      | å­—æ®µ          | å€¼                           |
      | å†²çªä»»åŠ¡      | task-1 (æ’°å†™é¡¹ç›®æŠ¥å‘Š)        |
      | å†²çªæ—¶æ®µ      | 15:00-16:00ï¼ˆå†²çª 1 å°æ—¶ï¼‰   |
    And ç³»ç»Ÿåº”æ¨èè°ƒæ•´æ–¹æ¡ˆï¼š
      | æ–¹æ¡ˆ          | æ—¶é—´                |
      | æ–¹æ¡ˆ1         | 16:00-17:00        |
      | æ–¹æ¡ˆ2         | æ˜å¤© 15:00-16:00   |
    And ç”¨æˆ·é€‰æ‹©æ–¹æ¡ˆ1ååº”è°ƒæ•´ä¸º 16:00-17:00
```

---

#### Scenario 2: ç•ªèŒ„é’Ÿæ¨¡å¼æ‰§è¡Œ

```gherkin
  Background:
    Given ç”¨æˆ·ä¸ºä»»åŠ¡"task-1"åˆ›å»ºäº†ç•ªèŒ„é’Ÿæ—¶é—´å—
    And ç•ªèŒ„é’Ÿé…ç½®ï¼š
      | å·¥ä½œæ—¶é•¿   | 25åˆ†é’Ÿ |
      | ä¼‘æ¯æ—¶é•¿   | 5åˆ†é’Ÿ  |
      | ç•ªèŒ„é’Ÿæ•°é‡ | 2      |
    And æ—¶é—´å—çŠ¶æ€ä¸º"scheduled"

  Scenario: å¯åŠ¨ç•ªèŒ„é’Ÿå¹¶å®Œæˆ
    When å½“å‰æ—¶é—´åˆ°è¾¾æ—¶é—´å—å¼€å§‹æ—¶é—´
    And ç³»ç»Ÿå‘é€æé†’ï¼š"ä»»åŠ¡æ—¶é—´å—å³å°†å¼€å§‹"
    And ç”¨æˆ·ç‚¹å‡»"å¼€å§‹"
    Then æ—¶é—´å—çŠ¶æ€åº”å˜ä¸º"in-progress"
    And actualStartTime åº”è®°å½•ä¸ºå½“å‰æ—¶é—´
    And ç³»ç»Ÿåº”æ˜¾ç¤ºç•ªèŒ„é’Ÿè®¡æ—¶å™¨ï¼š
      | å­—æ®µ        | å€¼               |
      | ä¼šè¯ç±»å‹    | work             |
      | ä¼šè¯ç¼–å·    | 1                |
      | å‰©ä½™æ—¶é—´    | 25:00            |
      | è¿›åº¦        | 0/2              |

    When 25åˆ†é’Ÿåè®¡æ—¶ç»“æŸ
    Then ç³»ç»Ÿåº”è‡ªåŠ¨è¿›å…¥ä¼‘æ¯æ¨¡å¼
    And æ˜¾ç¤ºä¼‘æ¯è®¡æ—¶å™¨ï¼š5:00
    And è®°å½•ç¬¬1ä¸ªç•ªèŒ„é’Ÿä¼šè¯ï¼š
      | å­—æ®µ              | å€¼                |
      | sessionNumber     | 1                 |
      | type              | work              |
      | plannedDuration   | 25                |
      | actualDuration    | 25                |
      | completed         | true              |

    When 5åˆ†é’Ÿä¼‘æ¯ç»“æŸ
    Then ç³»ç»Ÿåº”è¿›å…¥ç¬¬2ä¸ªç•ªèŒ„é’Ÿ
    And æ˜¾ç¤ºå·¥ä½œè®¡æ—¶å™¨ï¼š25:00ï¼ˆä¼šè¯ 2/2ï¼‰

    When ç¬¬2ä¸ªç•ªèŒ„é’Ÿå®Œæˆ
    Then æ—¶é—´å—çŠ¶æ€åº”å˜ä¸º"completed"
    And actualEndTime åº”è®°å½•ä¸ºå½“å‰æ—¶é—´
    And actualDuration åº”ä¸º 60åˆ†é’Ÿï¼ˆ25+5+25+5ï¼‰
    And ä»»åŠ¡çš„ actualTime åº”æ›´æ–°ä¸º 60åˆ†é’Ÿ
```

---

#### Scenario 3: é¢„ä¼°æ—¶é—´ vs å®é™…æ—¶é—´å¯¹æ¯”

```gherkin
  Background:
    Given ä»»åŠ¡"task-1"çš„é¢„ä¼°æ—¶é—´ä¸º 120åˆ†é’Ÿ
    And ç”¨æˆ·å®Œæˆäº†æ—¶é—´å—ï¼Œå®é™…æ—¶é—´ä¸º 150åˆ†é’Ÿ

  Scenario: æŸ¥çœ‹æ—¶é—´å¯¹æ¯”åˆ†æ
    When ç”¨æˆ·æ‰“å¼€ä»»åŠ¡"task-1"è¯¦æƒ…é¡µ
    And æŸ¥çœ‹"æ—¶é—´ç»Ÿè®¡"éƒ¨åˆ†
    Then ç³»ç»Ÿåº”æ˜¾ç¤ºï¼š
      | å­—æ®µ        | å€¼                         |
      | é¢„ä¼°æ—¶é—´    | 120åˆ†é’Ÿï¼ˆ2å°æ—¶ï¼‰           |
      | å®é™…æ—¶é—´    | 150åˆ†é’Ÿï¼ˆ2.5å°æ—¶ï¼‰         |
      | åå·®        | +25% (è¶…å‡º 30åˆ†é’Ÿ)        |
      | åå·®ç±»å‹    | ä½ä¼°                       |
    And ç³»ç»Ÿåº”æä¾›å»ºè®®ï¼š"ç±»ä¼¼ä»»åŠ¡é¢„ä¼°æ—¶å¢åŠ  20-30%"
    And ç”¨æˆ·çš„ timeEstimationAccuracy åº”æ›´æ–°ï¼ˆå†å²å¹³å‡å€¼ï¼‰
```

---

#### Scenario 4: æ‰¹é‡å®‰æ’æ—¶é—´å—

```gherkin
  Background:
    Given ç”¨æˆ·æœ‰ä»¥ä¸‹ä»»åŠ¡ï¼š
      | uuid    | title        | estimatedTime | priority |
      | task-1  | æ’°å†™é¡¹ç›®æŠ¥å‘Š  | 120          | high     |
      | task-2  | ä»£ç å®¡æŸ¥      | 60           | medium   |
      | task-3  | å›å¤é‚®ä»¶      | 30           | low      |

  Scenario: æ™ºèƒ½æ‰¹é‡å®‰æ’
    When ç”¨æˆ·å‹¾é€‰ 3 ä¸ªä»»åŠ¡
    And ç‚¹å‡»"æ‰¹é‡å®‰æ’æ—¶é—´"
    Then ç³»ç»Ÿåº”åˆ†æå¹¶æ¨èï¼š
      | ä»»åŠ¡          | æ¨èæ—¶é—´              | åŸå›                       |
      | task-1        | 09:00-11:00          | ä¸Šåˆä¸“æ³¨åº¦é«˜ï¼Œé€‚åˆæ·±åº¦å·¥ä½œ  |
      | task-3        | 13:00-13:30          | ä¸­åˆä¸“æ³¨åº¦ä½ï¼Œé€‚åˆæ²Ÿé€š     |
      | task-2        | 14:00-15:00          | ä¸‹åˆä¸“æ³¨åº¦æ¢å¤ï¼Œé€‚åˆè¯„å®¡   |
    And æ¨èåº”é¿å¼€å·²æœ‰æ—¶é—´å—

    When ç”¨æˆ·ç‚¹å‡»"æ¥å—æ¨è"
    Then ç³»ç»Ÿåº”æ‰¹é‡åˆ›å»º 3 ä¸ªæ—¶é—´å—
    And æ‰€æœ‰æ—¶é—´å—çŠ¶æ€åº”ä¸º"scheduled"
    And æ—¥å†è§†å›¾åº”æ˜¾ç¤ºå…¨éƒ¨æ—¶é—´å—
```

---

#### Scenario 5: æ—¶é—´å—æ‹–æ‹½è°ƒæ•´

```gherkin
  Background:
    Given ç”¨æˆ·åœ¨æ—¥å†è§†å›¾
    And ä»»åŠ¡"task-1"æœ‰æ—¶é—´å—ï¼š14:00-16:00

  Scenario: æ‹–æ‹½è°ƒæ•´æ—¶é—´å—
    When ç”¨æˆ·æ‹–æ‹½æ—¶é—´å—åˆ° 15:00-17:00
    And æ¾å¼€é¼ æ ‡
    Then ç³»ç»Ÿåº”æ£€æµ‹æ–°æ—¶é—´æ®µæ˜¯å¦å†²çª
    And å¦‚æœæ— å†²çªï¼Œæ›´æ–°æ—¶é—´å—ï¼š
      | å­—æ®µ      | æ—§å€¼          | æ–°å€¼          |
      | startTime | 14:00        | 15:00        |
      | endTime   | 16:00        | 17:00        |
    And æ—¥å†è§†å›¾åº”å®æ—¶æ›´æ–°
    And updatedAt åº”æ›´æ–°ä¸ºå½“å‰æ—¶é—´
```

---

## 6. æŒ‡æ ‡ä¸è¿½è¸ª

### äº‹ä»¶åŸ‹ç‚¹

```typescript
// åˆ›å»ºæ—¶é—´å—
{
  event: 'time_block_created',
  properties: {
    mode: 'continuous' | 'pomodoro' | 'custom',
    duration: number,  // åˆ†é’Ÿ
    syncedToCalendar: boolean,
    hasConflict: boolean
  }
}

// å¼€å§‹æ—¶é—´å—
{
  event: 'time_block_started',
  properties: {
    mode: string,
    onTime: boolean,     // æ˜¯å¦å‡†æ—¶å¼€å§‹
    delayMinutes: number // å»¶è¿Ÿåˆ†é’Ÿæ•°
  }
}

// å®Œæˆç•ªèŒ„é’Ÿ
{
  event: 'pomodoro_completed',
  properties: {
    sessionNumber: number,
    plannedDuration: number,
    actualDuration: number,
    interrupted: boolean  // æ˜¯å¦è¢«ä¸­æ–­
  }
}

// æ—¶é—´å—å®Œæˆ
{
  event: 'time_block_completed',
  properties: {
    estimatedTime: number,
    actualTime: number,
    timeDelta: number,         // åå·®ï¼ˆåˆ†é’Ÿï¼‰
    timeDeltaPercentage: number // åå·®ç™¾åˆ†æ¯”
  }
}

// æ‰¹é‡å®‰æ’
{
  event: 'time_blocks_batch_scheduled',
  properties: {
    taskCount: number,
    totalDuration: number,
    acceptedRecommendation: boolean
  }
}
```

---

### æˆåŠŸæŒ‡æ ‡

**å®šé‡æŒ‡æ ‡**:
| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹å¼ |
|------|-------|---------|
| æ—¶é—´å—ä½¿ç”¨ç‡ | >50% | ä½¿ç”¨æ—¶é—´å—çš„ä»»åŠ¡æ•° / æ€»ä»»åŠ¡æ•° |
| æ—¶é—´ä¼°ç®—å‡†ç¡®ç‡ | >70% | Â±20% ä»¥å†…çš„ä»»åŠ¡æ¯”ä¾‹ |
| ç•ªèŒ„é’Ÿå®Œæˆç‡ | >80% | å®Œæ•´å®Œæˆçš„ç•ªèŒ„é’Ÿ / æ€»ç•ªèŒ„é’Ÿæ•° |
| å‡†æ—¶å¼€å§‹ç‡ | >60% | å‡†æ—¶ï¼ˆÂ±5åˆ†é’Ÿï¼‰å¼€å§‹çš„æ—¶é—´å—æ¯”ä¾‹ |

**å®šæ€§æŒ‡æ ‡**:

- ç”¨æˆ·åé¦ˆ"æ—¶é—´å—å¸®åŠ©æˆ‘æ›´ä¸“æ³¨æ‰§è¡Œä»»åŠ¡"
- æ‹–å»¶å‡å°‘ï¼ˆä»»åŠ¡å®é™…å¼€å§‹æ—¶é—´ä¸è®¡åˆ’æ—¶é—´çš„å·®è·ç¼©å°ï¼‰
- æ—¶é—´ç®¡ç†èƒ½åŠ›æå‡ï¼ˆæ—¶é—´ä¼°ç®—è¶Šæ¥è¶Šå‡†ç¡®ï¼‰

---

## 7. æŠ€æœ¯å®ç°è¦ç‚¹

### Prisma Schema

```prisma
model TimeBlock {
  uuid                String   @id @default(uuid())
  taskUuid            String   @map("task_uuid")
  userUuid            String   @map("user_uuid")
  startTime           BigInt   @map("start_time")
  endTime             BigInt   @map("end_time")
  duration            Int      @map("duration")  // åˆ†é’Ÿ
  mode                String   @map("mode")
  status              String   @map("status")
  actualStartTime     BigInt?  @map("actual_start_time")
  actualEndTime       BigInt?  @map("actual_end_time")
  actualDuration      Int?     @map("actual_duration")
  pomodoroConfig      Json?    @map("pomodoro_config")
  pomodoroSessions    Json?    @map("pomodoro_sessions")  // Array<PomodoroSession>
  syncedToCalendar    Boolean  @default(false) @map("synced_to_calendar")
  calendarEventId     String?  @map("calendar_event_id")
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")

  task                Task     @relation(fields: [taskUuid], references: [uuid])
  user                Account  @relation(fields: [userUuid], references: [uuid])

  @@index([taskUuid])
  @@index([userUuid, startTime, endTime])
  @@index([userUuid, status])
  @@map("time_blocks")
}

// æ›´æ–° Task æ¨¡å‹
model Task {
  // ...existing fields...

  estimatedTime           Int?         @map("estimated_time")  // åˆ†é’Ÿ
  actualTime              Int?         @map("actual_time")
  timeEstimationAccuracy  Float?       @map("time_estimation_accuracy")

  timeBlocks              TimeBlock[]
}
```

### Application Service

```typescript
// packages/domain-server/src/modules/task/application/ScheduleTimeBlockService.ts

export class ScheduleTimeBlockService {
  async execute(
    taskUuid: string,
    userUuid: string,
    startTime: number,
    endTime: number,
    mode: TimeBlockMode,
    pomodoroConfig?: PomodoroConfig,
  ): Promise<TimeBlock> {
    // 1. åŠ è½½ä»»åŠ¡
    const task = await this.taskRepository.findByUuid(taskUuid);

    // 2. å†²çªæ£€æµ‹
    const conflicts = await this.detectConflicts(userUuid, startTime, endTime);
    if (conflicts.length > 0) {
      throw new TimeBlockConflictError(conflicts);
    }

    // 3. åˆ›å»ºæ—¶é—´å—
    const duration = (endTime - startTime) / 60000; // è½¬æ¢ä¸ºåˆ†é’Ÿ
    const timeBlock = new TimeBlock({
      taskUuid,
      userUuid,
      startTime,
      endTime,
      duration,
      mode,
      status: TimeBlockStatus.SCHEDULED,
      pomodoroConfig,
    });

    // 4. ä¿å­˜
    await this.timeBlockRepository.save(timeBlock);

    // 5. åŒæ­¥åˆ°æ—¥å†ï¼ˆå¯é€‰ï¼‰
    if (syncToCalendar) {
      await this.calendarService.createEvent(timeBlock);
    }

    // 6. å‘å¸ƒäº‹ä»¶
    await this.eventBus.publish(
      new TimeBlockScheduledEvent({
        timeBlockUuid: timeBlock.uuid,
        taskUuid,
        startTime,
      }),
    );

    return timeBlock;
  }

  private async detectConflicts(
    userUuid: string,
    startTime: number,
    endTime: number,
  ): Promise<TimeBlock[]> {
    return this.timeBlockRepository.findOverlapping(userUuid, startTime, endTime, [
      TimeBlockStatus.SCHEDULED,
      TimeBlockStatus.IN_PROGRESS,
    ]);
  }
}
```

### API ç«¯ç‚¹

```typescript
// åˆ›å»ºæ—¶é—´å—
POST /api/v1/tasks/:taskUuid/time-blocks
Body: {
  startTime: number,
  endTime: number,
  mode: 'continuous' | 'pomodoro' | 'custom',
  pomodoroConfig?: PomodoroConfig,
  syncToCalendar?: boolean
}
Response: TimeBlockClientDTO

// å¼€å§‹æ—¶é—´å—
POST /api/v1/time-blocks/:uuid/start
Response: TimeBlockClientDTO

// æš‚åœæ—¶é—´å—
POST /api/v1/time-blocks/:uuid/pause
Response: TimeBlockClientDTO

// å®Œæˆæ—¶é—´å—
POST /api/v1/time-blocks/:uuid/complete
Response: TimeBlockClientDTO

// å–æ¶ˆæ—¶é—´å—
DELETE /api/v1/time-blocks/:uuid
Response: { success: boolean }

// è·å–ç”¨æˆ·çš„æ—¶é—´å—åˆ—è¡¨ï¼ˆæ—¥å†è§†å›¾ï¼‰
GET /api/v1/time-blocks?startDate=xxx&endDate=xxx
Response: { timeBlocks: TimeBlockClientDTO[] }

// æ‰¹é‡å®‰æ’æ—¶é—´å—
POST /api/v1/time-blocks/batch-schedule
Body: {
  taskUuids: string[],
  date?: string,  // å¯é€‰ï¼Œé»˜è®¤ä»Šå¤©
  acceptRecommendation?: boolean
}
Response: {
  timeBlocks: TimeBlockClientDTO[],
  recommendations?: TimeBlockRecommendation[]
}
```

---

## 8. é£é™©ä¸ç¼“è§£

| é£é™©             | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½                     |
| ---------------- | ------ | ---- | ---------------------------- |
| ç”¨æˆ·ä¸éµå®ˆæ—¶é—´å— | é«˜     | ä¸­   | æä¾›çµæ´»è°ƒæ•´ï¼Œå…è®¸å»¶è¿Ÿå¼€å§‹   |
| æ—¶é—´å—è¿‡åº¦åˆšæ€§   | ä¸­     | ä¸­   | æ”¯æŒæ‹–æ‹½è°ƒæ•´ã€æ‰¹é‡å–æ¶ˆ       |
| ç•ªèŒ„é’Ÿè¢«é¢‘ç¹æ‰“æ–­ | ä¸­     | ä½   | è®°å½•ä¸­æ–­æ¬¡æ•°ï¼Œæä¾›ä¸“æ³¨åº¦åˆ†æ |
| æ—¥å†åŒæ­¥å»¶è¿Ÿ     | ä½     | ä¸­   | å¼‚æ­¥é˜Ÿåˆ—å¤„ç†ï¼Œå¤±è´¥é‡è¯•       |
| æ—¶é—´å†²çªå¤æ‚åœºæ™¯ | ä¸­     | é«˜   | æ™ºèƒ½æ¨èå¤šä¸ªè°ƒæ•´æ–¹æ¡ˆ         |

---

## 9. åç»­å¢å¼ºæ–¹å‘

### Phase 2 åŠŸèƒ½

- ğŸ”„ æ—¶é—´å—è‡ªåŠ¨è°ƒæ•´ï¼ˆå½“å‰ä»»åŠ¡å»¶æœŸæ—¶ï¼Œè‡ªåŠ¨é¡ºå»¶åç»­æ—¶é—´å—ï¼‰
- ğŸ“Š æ—¶é—´åˆ©ç”¨ç‡åˆ†æï¼ˆæ¯æ—¥/æ¯å‘¨å·¥ä½œæ—¶é•¿ç»Ÿè®¡ï¼‰
- ğŸ§  ä¸“æ³¨åº¦çƒ­åŠ›å›¾ï¼ˆè¯†åˆ«æœ€é«˜æ•ˆæ—¶é—´æ®µï¼‰
- ğŸ‘¥ å›¢é˜Ÿæ—¶é—´å—å¯è§æ€§ï¼ˆæŸ¥çœ‹å›¢é˜Ÿæˆå‘˜çš„å¿™ç¢Œæ—¶æ®µï¼‰

### Phase 3 åŠŸèƒ½

- ğŸ¤– AI æ—¶é—´å—æ¨èï¼ˆåŸºäºå†å²æ•°æ®æ¨èæœ€ä½³æ‰§è¡Œæ—¶é—´ï¼‰
- ğŸ”— ä¸ä¼šè®®æ—¥å†æ·±åº¦é›†æˆï¼ˆè‡ªåŠ¨é¿å¼€ä¼šè®®æ—¶é—´ï¼‰
- ğŸ“± ç§»åŠ¨ç«¯ç•ªèŒ„é’Ÿä¸“æ³¨æ¨¡å¼ï¼ˆå±è”½é€šçŸ¥ï¼‰
- ğŸµ ä¸“æ³¨éŸ³ä¹é›†æˆï¼ˆç•ªèŒ„é’ŸæœŸé—´æ’­æ”¾ä¸“æ³¨éŸ³ä¹ï¼‰

---

## 10. å‚è€ƒèµ„æ–™

- [ç•ªèŒ„å·¥ä½œæ³•](https://en.wikipedia.org/wiki/Pomodoro_Technique)
- [æ—¶é—´ç›’ï¼ˆTime Boxingï¼‰](https://en.wikipedia.org/wiki/Timeboxing)
- [Task Contracts](../../../../packages/contracts/src/modules/task/)
- [Schedule æ¨¡å—æ–‡æ¡£](../../schedule/features/README.md)

---

**æ–‡æ¡£çŠ¶æ€**: âœ… Ready for PM Review  
**ä¸‹ä¸€æ­¥**: PM ç”Ÿæˆ Project Flow

---

**æ–‡æ¡£ç»´æŠ¤**:

- åˆ›å»º: 2025-10-21
- åˆ›å»ºè€…: PO Agent
- ç‰ˆæœ¬: 1.0
- ä¸‹æ¬¡æ›´æ–°: Sprint Planning å‰

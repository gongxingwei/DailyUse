# Feature Spec: ç›®æ ‡å¤ç›˜

> **åŠŸèƒ½ç¼–å·**: GOAL-004  
> **RICE è¯„åˆ†**: 336 (Reach: 7, Impact: 8, Confidence: 6, Effort: 1)  
> **ä¼˜å…ˆçº§**: P1  
> **é¢„ä¼°æ—¶é—´**: 0.5-1 å‘¨  
> **çŠ¶æ€**: Draft  
> **è´Ÿè´£äºº**: TBD  
> **æœ€åæ›´æ–°**: 2025-10-21

---

## 1. æ¦‚è¿°ä¸ç›®æ ‡

### èƒŒæ™¯ä¸ç—›ç‚¹

åœ¨ç›®æ ‡ç®¡ç†å®è·µä¸­ï¼Œå®šæœŸå¤ç›˜æ˜¯ä¿éšœç›®æ ‡è¾¾æˆçš„å…³é”®ç¯èŠ‚ï¼Œä½†ç°çŠ¶å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

- âŒ å¤ç›˜æ—¶é—´ä¸å›ºå®šï¼Œä¾èµ–äººå·¥è®°å¿†ï¼Œå®¹æ˜“é—å¿˜
- âŒ æ²¡æœ‰ç»“æ„åŒ–çš„å¤ç›˜è®°å½•ï¼Œå†å²å¤ç›˜å†…å®¹æ— æ³•è¿½æº¯
- âŒ ç¼ºå°‘ä¸“æ³¨å‘¨æœŸæ¦‚å¿µï¼Œç›®æ ‡æ‰§è¡Œç¼ºä¹èŠ‚å¥æ„Ÿ
- âŒ å¤ç›˜è´¨é‡å‚å·®ä¸é½ï¼Œæ²¡æœ‰æ ‡å‡†åŒ–çš„å¤ç›˜æ¡†æ¶

### ç›®æ ‡ç”¨æˆ·

- **ä¸»è¦ç”¨æˆ·**: OKR ç®¡ç†è€…ã€å›¢é˜Ÿ Leaderã€ä¸ªäººæ•ˆèƒ½è¿½æ±‚è€…
- **æ¬¡è¦ç”¨æˆ·**: å›¢é˜Ÿæˆå‘˜ï¼ˆå‚ä¸å¤ç›˜ã€æŸ¥çœ‹å¤ç›˜è®°å½•ï¼‰
- **å…¸å‹ç”»åƒ**: å¸Œæœ›å»ºç«‹å®šæœŸå¤ç›˜ä¹ æƒ¯ï¼ŒæŒç»­ä¼˜åŒ–ç›®æ ‡æ‰§è¡Œç­–ç•¥çš„ç”¨æˆ·

### ä»·å€¼ä¸»å¼ 

**ä¸€å¥è¯ä»·å€¼**: æä¾›ç»“æ„åŒ–çš„ä¸“æ³¨å‘¨æœŸä¸å¤ç›˜æœºåˆ¶ï¼Œé€šè¿‡å®šæœŸå›é¡¾æå‡ç›®æ ‡è¾¾æˆç‡

**æ ¸å¿ƒæ”¶ç›Š**:

- âœ… è‡ªåŠ¨å¤ç›˜æé†’ï¼Œé¿å…é—å¿˜ï¼Œå…»æˆå®šæœŸå›é¡¾ä¹ æƒ¯
- âœ… ç»“æ„åŒ–å¤ç›˜æ¨¡æ¿ï¼ˆ4Då›é¡¾ï¼šData, Discover, Dream, Designï¼‰
- âœ… å¤ç›˜å†å²å¯è¿½æº¯ï¼Œä¾¿äºåˆ†æç›®æ ‡æ‰§è¡Œè¶‹åŠ¿
- âœ… æ”¯æŒå¤šç§ä¸“æ³¨å‘¨æœŸï¼ˆå‘¨/åŒå‘¨/æœˆ/å­£ï¼‰ï¼Œé€‚åº”ä¸åŒç›®æ ‡ç±»å‹

---

## 2. ç”¨æˆ·ä»·å€¼ä¸åœºæ™¯

### æ ¸å¿ƒåœºæ™¯ 1: é…ç½®ä¸“æ³¨å‘¨æœŸ

**åœºæ™¯æè¿°**:  
ç”¨æˆ·ä¸ºç›®æ ‡é…ç½®ä¸“æ³¨å‘¨æœŸï¼ˆå¦‚æ¯å‘¨å¤ç›˜ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå¤ç›˜æé†’ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ç›®æ ‡è´Ÿè´£äºº
I want ä¸ºç›®æ ‡é…ç½®ä¸“æ³¨å‘¨æœŸï¼ˆå¦‚"æ¯å‘¨ä¸€ 10:00 å¤ç›˜"ï¼‰
So that ç³»ç»Ÿå¯ä»¥è‡ªåŠ¨æé†’æˆ‘å®šæœŸå›é¡¾ç›®æ ‡è¿›å±•
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€ç›®æ ‡è¯¦æƒ…é¡µ
2. ç‚¹å‡»"ä¸“æ³¨å‘¨æœŸ"é…ç½®å…¥å£
3. é€‰æ‹©å‘¨æœŸç±»å‹ï¼šæ¯å‘¨ / æ¯ä¸¤å‘¨ / æ¯æœˆ / è‡ªå®šä¹‰
4. è®¾ç½®å¤ç›˜æ—¶é—´ï¼ˆå¦‚"æ¯å‘¨ä¸€ 10:00"ï¼‰
5. å¯é€‰ï¼šè®¾ç½®å¤ç›˜æå‰æé†’ï¼ˆå¦‚æå‰ 1 å¤©ï¼‰
6. ä¿å­˜é…ç½®
7. ç³»ç»Ÿåˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œåˆ°æœŸæ—¶å‘é€å¤ç›˜æé†’

**é¢„æœŸç»“æœ**:

- Goal è¡¨æ–°å¢ `focusCycle` å­—æ®µï¼š
  ```typescript
  focusCycle: {
    type: 'weekly' | 'biweekly' | 'monthly' | 'custom',
    dayOfWeek?: number,        // å‘¨å‡ ï¼ˆ1-7ï¼‰
    dayOfMonth?: number,       // å‡ å·ï¼ˆ1-31ï¼‰
    time: string,              // HH:mm
    advanceNoticeHours: number // æå‰é€šçŸ¥ï¼ˆå°æ—¶ï¼‰
  }
  ```
- Reminder æ¨¡å—è‡ªåŠ¨åˆ›å»ºå¾ªç¯æé†’

---

### æ ¸å¿ƒåœºæ™¯ 2: æ‰§è¡Œå¤ç›˜å¹¶è®°å½•

**åœºæ™¯æè¿°**:  
ç”¨æˆ·æ”¶åˆ°å¤ç›˜æé†’åï¼Œè¿›å…¥ç»“æ„åŒ–å¤ç›˜æµç¨‹ï¼Œè®°å½•å›é¡¾å†…å®¹ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ç›®æ ‡è´Ÿè´£äºº
I want ä½¿ç”¨ 4D å¤ç›˜æ¨¡æ¿ï¼ˆData, Discover, Dream, Designï¼‰è®°å½•å›é¡¾
So that å¤ç›˜å†…å®¹ç»“æ„åŒ–ï¼Œä¾¿äºåç»­è¿½æº¯å’Œåˆ†æ
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·ç‚¹å‡»å¤ç›˜æé†’é€šçŸ¥
2. ç³»ç»Ÿæ‰“å¼€å¤ç›˜ç•Œé¢ï¼Œå±•ç¤ºï¼š
   - **Dataï¼ˆæ•°æ®å›é¡¾ï¼‰**: è‡ªåŠ¨å¡«å……æœ¬å‘¨æœŸ KR è¿›å±•æ•°æ®
   - **Discoverï¼ˆå‘ç°æ´å¯Ÿï¼‰**: ç”¨æˆ·å¡«å†™"åšå¾—å¥½çš„" + "éœ€æ”¹è¿›çš„"
   - **Dreamï¼ˆæœŸæœ›ç›®æ ‡ï¼‰**: ç”¨æˆ·å¡«å†™ä¸‹å‘¨æœŸç›®æ ‡
   - **Designï¼ˆè¡ŒåŠ¨è®¡åˆ’ï¼‰**: ç”¨æˆ·å¡«å†™å…·ä½“è¡ŒåŠ¨é¡¹
3. ç”¨æˆ·å¡«å†™å®Œæˆåç‚¹å‡»"ä¿å­˜å¤ç›˜"
4. ç³»ç»Ÿåˆ›å»º `GoalReview` è®°å½•
5. æ˜¾ç¤º"å¤ç›˜å·²ä¿å­˜ï¼Œä¸‹æ¬¡å¤ç›˜æ—¶é—´ï¼š2025-10-28 10:00"

**é¢„æœŸç»“æœ**:

- æ–°å¢ `GoalReview` å®ä½“ï¼š
  ```typescript
  {
    uuid: string,
    goalUuid: string,
    reviewTime: number,        // å¤ç›˜æ—¶é—´
    cycleStartTime: number,    // å‘¨æœŸå¼€å§‹æ—¶é—´
    cycleEndTime: number,      // å‘¨æœŸç»“æŸæ—¶é—´

    // 4D å¤ç›˜å†…å®¹
    data: {                    // æ•°æ®å›é¡¾
      krProgress: KeyResultProgressSnapshot[],
      completedTasks: number,
      totalTasks: number
    },
    discover: {                // å‘ç°æ´å¯Ÿ
      wentWell: string[],      // åšå¾—å¥½çš„
      needsImprovement: string[] // éœ€æ”¹è¿›çš„
    },
    dream: {                   // æœŸæœ›ç›®æ ‡
      nextCycleGoals: string
    },
    design: {                  // è¡ŒåŠ¨è®¡åˆ’
      actionItems: ActionItem[]
    },

    reviewerUuid: string,
    createdAt: number
  }
  ```

---

### æ ¸å¿ƒåœºæ™¯ 3: æŸ¥çœ‹å¤ç›˜å†å²

**åœºæ™¯æè¿°**:  
ç”¨æˆ·æŸ¥çœ‹ç›®æ ‡çš„å†å²å¤ç›˜è®°å½•ï¼Œåˆ†æç›®æ ‡æ‰§è¡Œè¶‹åŠ¿ã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ç›®æ ‡è´Ÿè´£äºº
I want æŸ¥çœ‹ç›®æ ‡çš„å†å²å¤ç›˜è®°å½•ï¼ˆæŒ‰æ—¶é—´è½´å±•ç¤ºï¼‰
So that æˆ‘å¯ä»¥åˆ†æç›®æ ‡æ‰§è¡Œçš„æ”¹è¿›è¶‹åŠ¿
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ‰“å¼€ç›®æ ‡è¯¦æƒ…é¡µ
2. ç‚¹å‡»"å¤ç›˜å†å²"æ ‡ç­¾
3. ç³»ç»Ÿå±•ç¤ºæ—¶é—´è½´å¼å¤ç›˜åˆ—è¡¨ï¼š
   ```
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ğŸ“… 2025-10-21 å‘¨å¤ç›˜
   Data: KR1 è¿›å±• +15%, KR2 è¿›å±• +10%
   Discover: âœ… æ—¶é—´ç®¡ç†æ”¹å–„ âš ï¸ æ²Ÿé€šä¸è¶³
   Dream: ä¸‹å‘¨å®Œæˆ KR1 è‡³ 60%
   Design: 3 ä¸ªè¡ŒåŠ¨é¡¹
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ğŸ“… 2025-10-14 å‘¨å¤ç›˜
   ...
   ```
4. ç”¨æˆ·å¯ç‚¹å‡»æŸæ¬¡å¤ç›˜æŸ¥çœ‹è¯¦æƒ…
5. å¯å¯¼å‡ºå¤ç›˜æŠ¥å‘Šï¼ˆPDF/Markdownï¼‰

**é¢„æœŸç»“æœ**:

- å¤ç›˜å†å²æŒ‰æ—¶é—´å€’åºå±•ç¤º
- æ¯æ¬¡å¤ç›˜æ˜¾ç¤ºå…³é”®æ‘˜è¦ï¼ˆKR è¿›å±•ã€æ´å¯Ÿæ•°é‡ã€è¡ŒåŠ¨é¡¹æ•°é‡ï¼‰
- æ”¯æŒç­›é€‰ï¼ˆæŒ‰æ—¶é—´èŒƒå›´ã€å¤ç›˜ç±»å‹ï¼‰

---

### æ ¸å¿ƒåœºæ™¯ 4: è·³è¿‡æˆ–å»¶è¿Ÿå¤ç›˜

**åœºæ™¯æè¿°**:  
ç”¨æˆ·å› ç‰¹æ®Šæƒ…å†µæ— æ³•æŒ‰æ—¶å¤ç›˜ï¼Œé€‰æ‹©è·³è¿‡æˆ–å»¶è¿Ÿã€‚

**ç”¨æˆ·æ•…äº‹**:

```gherkin
As a ç›®æ ‡è´Ÿè´£äºº
I want è·³è¿‡æˆ–å»¶è¿ŸæŸæ¬¡å¤ç›˜
So that å¤ç›˜å®‰æ’æ›´çµæ´»ï¼Œä¸ä¼šå› ä¸€æ¬¡é—æ¼è€Œä¸­æ–­èŠ‚å¥
```

**æ“ä½œæµç¨‹**:

1. ç”¨æˆ·æ”¶åˆ°å¤ç›˜æé†’
2. ç‚¹å‡»"å»¶è¿Ÿå¤ç›˜"æˆ–"è·³è¿‡æœ¬æ¬¡"
3. å¦‚é€‰æ‹©å»¶è¿Ÿï¼š
   - é€‰æ‹©å»¶è¿Ÿæ—¶é•¿ï¼ˆ1 å°æ—¶ / 3 å°æ—¶ / æ˜å¤©ï¼‰
   - ç³»ç»Ÿé‡æ–°è°ƒåº¦æé†’
4. å¦‚é€‰æ‹©è·³è¿‡ï¼š
   - ç³»ç»Ÿè®°å½•è·³è¿‡åŸå› ï¼ˆå¯é€‰ï¼‰
   - æ ‡è®°æœ¬æ¬¡å¤ç›˜ä¸º `skipped`
   - ä¸å½±å“ä¸‹æ¬¡å¤ç›˜æ—¶é—´

**é¢„æœŸç»“æœ**:

- `GoalReview` æ–°å¢çŠ¶æ€å­—æ®µï¼š`pending`, `completed`, `skipped`, `delayed`
- è·³è¿‡/å»¶è¿Ÿæ“ä½œè¢«è®°å½•ï¼Œä¾¿äºåˆ†æå¤ç›˜å®Œæˆç‡

---

## 3. è®¾è®¡è¦ç‚¹

### æ¶‰åŠå­—æ®µï¼ˆå¯¹é½ Contractsï¼‰

#### æ›´æ–°èšåˆæ ¹ï¼šGoal

**ä½ç½®**: `packages/contracts/src/modules/goal/aggregates/GoalServer.ts`

```typescript
export interface GoalServerDTO {
  // ...existing fields...

  // æ–°å¢å­—æ®µ
  readonly focusCycle?: FocusCycle; // ä¸“æ³¨å‘¨æœŸé…ç½®
  readonly reviews?: GoalReviewServerDTO[]; // å¤ç›˜å†å²
  readonly nextReviewTime?: number; // ä¸‹æ¬¡å¤ç›˜æ—¶é—´
}

export interface FocusCycle {
  readonly type: 'weekly' | 'biweekly' | 'monthly' | 'custom';
  readonly dayOfWeek?: number; // 1-7 (å‘¨ä¸€åˆ°å‘¨æ—¥)
  readonly dayOfMonth?: number; // 1-31
  readonly time: string; // HH:mm
  readonly advanceNoticeHours: number; // æå‰é€šçŸ¥æ—¶é—´
  readonly enabled: boolean; // æ˜¯å¦å¯ç”¨
}
```

#### æ–°å¢å®ä½“ï¼šGoalReview

**ä½ç½®**: `packages/contracts/src/modules/goal/entities/GoalReviewServer.ts`

```typescript
export interface GoalReviewServerDTO {
  readonly uuid: string;
  readonly goalUuid: string;
  readonly reviewTime: number;
  readonly cycleStartTime: number;
  readonly cycleEndTime: number;
  readonly status: 'pending' | 'completed' | 'skipped' | 'delayed';

  // 4D å¤ç›˜å†…å®¹
  readonly data: ReviewDataSection;
  readonly discover: ReviewDiscoverSection;
  readonly dream: ReviewDreamSection;
  readonly design: ReviewDesignSection;

  readonly reviewerUuid: string;
  readonly createdAt: number;
  readonly updatedAt: number;
}

export interface ReviewDataSection {
  readonly krProgress: Array<{
    keyResultUuid: string;
    oldProgress: number;
    newProgress: number;
    delta: number;
  }>;
  readonly completedTasks: number;
  readonly totalTasks: number;
}

export interface ReviewDiscoverSection {
  readonly wentWell: string[];
  readonly needsImprovement: string[];
}

export interface ReviewDreamSection {
  readonly nextCycleGoals: string;
}

export interface ReviewDesignSection {
  readonly actionItems: Array<{
    description: string;
    dueDate?: number;
    assignee?: string;
    completed: boolean;
  }>;
}
```

---

### äº¤äº’è®¾è®¡

#### 1. å¤ç›˜æé†’è§¦å‘æ—¶æœº

- âœ… å®šæ—¶ä»»åŠ¡ï¼šæ ¹æ® `focusCycle` é…ç½®å®šæœŸè§¦å‘
- âœ… æå‰æé†’ï¼šåœ¨å¤ç›˜æ—¶é—´å‰ N å°æ—¶å‘é€é¢„å‘Šé€šçŸ¥
- âœ… é€¾æœŸæé†’ï¼šå¦‚å¤ç›˜æœªå®Œæˆï¼Œ24 å°æ—¶åå†æ¬¡æé†’

#### 2. å¤ç›˜å®Œæˆç‡è¿½è¸ª

- è®¡ç®—å…¬å¼ï¼š`å®Œæˆç‡ = å·²å®Œæˆå¤ç›˜æ•° / åº”å®Œæˆå¤ç›˜æ•°`
- åœ¨ç›®æ ‡è¯¦æƒ…é¡µæ˜¾ç¤º"å¤ç›˜å®Œæˆç‡"å¾½ç« 
- ä½äº 50% æ—¶æ˜¾ç¤ºè­¦å‘Šæç¤º

#### 3. å¤ç›˜ä¸ Reminder æ¨¡å—é›†æˆ

- å¤ç›˜æé†’ç”± Reminder æ¨¡å—ç»Ÿä¸€ç®¡ç†
- å¤ç›˜æé†’ç±»å‹ï¼š`'goal-review'`
- æ”¯æŒ Web æ¨é€ã€æ¡Œé¢é€šçŸ¥ã€é‚®ä»¶æé†’ï¼ˆå¯é…ç½®ï¼‰

---

## 4. MVP/MMP/Full è·¯å¾„

### MVP: åŸºç¡€å¤ç›˜åŠŸèƒ½ï¼ˆ0.5-1 å‘¨ï¼‰

**èŒƒå›´**:

- âœ… é…ç½®ä¸“æ³¨å‘¨æœŸï¼ˆæ¯å‘¨/æ¯æœˆï¼‰
- âœ… å®šæ—¶å¤ç›˜æé†’ï¼ˆåŸºäº Reminder æ¨¡å—ï¼‰
- âœ… ç®€åŒ–ç‰ˆå¤ç›˜è®°å½•ï¼ˆåªåŒ…å«æ–‡æœ¬å›é¡¾ï¼Œæš‚æ—  4D ç»“æ„ï¼‰
- âœ… å¤ç›˜å†å²åˆ—è¡¨æŸ¥çœ‹

**æŠ€æœ¯è¦ç‚¹**:

- Contracts: å®šä¹‰ `FocusCycle` å’Œ `GoalReviewServerDTO`
- Domain: Goal èšåˆæ ¹æ·»åŠ  `configureFocusCycle()`, `createReview()` æ–¹æ³•
- Application: `CreateGoalReviewService` åº”ç”¨æœåŠ¡
- Prisma: æ·»åŠ  `GoalReview` è¡¨
- API: `POST /api/v1/goals/:id/reviews`, `GET /api/v1/goals/:id/reviews`
- UI: ä¸“æ³¨å‘¨æœŸé…ç½®é¢æ¿ + ç®€å•å¤ç›˜è¡¨å•

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·ä¸ºç›®æ ‡é…ç½®"æ¯å‘¨ä¸€ 10:00 å¤ç›˜"
When åˆ°è¾¾ 2025-10-27 10:00
Then ç³»ç»Ÿåº”å‘é€å¤ç›˜æé†’é€šçŸ¥
And ç”¨æˆ·ç‚¹å‡»é€šçŸ¥åå¯è¿›å…¥å¤ç›˜ç•Œé¢
And ç”¨æˆ·å¡«å†™å¤ç›˜å†…å®¹å¹¶ä¿å­˜
And å¤ç›˜è®°å½•å‡ºç°åœ¨"å¤ç›˜å†å²"åˆ—è¡¨ä¸­
```

---

### MMP: 4D å¤ç›˜æ¨¡æ¿ï¼ˆ+1-2 å‘¨ï¼‰

**åœ¨ MVP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… ç»“æ„åŒ– 4D å¤ç›˜æ¨¡æ¿ï¼ˆData, Discover, Dream, Designï¼‰
- âœ… è‡ªåŠ¨å¡«å…… Data éƒ¨åˆ†ï¼ˆKR è¿›å±•æ•°æ®ï¼‰
- âœ… è¡ŒåŠ¨é¡¹ç®¡ç†ï¼ˆDesign éƒ¨åˆ†ï¼‰
- âœ… å¤ç›˜å»¶è¿Ÿ/è·³è¿‡åŠŸèƒ½
- âœ… å¤ç›˜å®Œæˆç‡ç»Ÿè®¡

**æŠ€æœ¯è¦ç‚¹**:

- å¤ç›˜è¡¨å•ç»„ä»¶åŒ–ï¼ˆ4 ä¸ªç‹¬ç«‹æ­¥éª¤ï¼‰
- æ•°æ®è‡ªåŠ¨å¡«å……é€»è¾‘ï¼ˆæŸ¥è¯¢å‘¨æœŸå†… KR å˜åŒ–ï¼‰
- è¡ŒåŠ¨é¡¹ä¸ Task æ¨¡å—é›†æˆï¼ˆå¯é€‰ï¼‰

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·è¿›å…¥å¤ç›˜ç•Œé¢
When ç³»ç»Ÿå±•ç¤º 4D å¤ç›˜æ¨¡æ¿
Then Data éƒ¨åˆ†åº”è‡ªåŠ¨æ˜¾ç¤ºæœ¬å‘¨ KR è¿›å±•ï¼ˆå¦‚ KR1: 50%â†’65%ï¼‰
And ç”¨æˆ·å¯åœ¨ Discover éƒ¨åˆ†æ·»åŠ "åšå¾—å¥½çš„"å’Œ"éœ€æ”¹è¿›çš„"
And ç”¨æˆ·å¯åœ¨ Design éƒ¨åˆ†åˆ›å»ºè¡ŒåŠ¨é¡¹ï¼ˆå¦‚"æ˜å¤©è”ç³»å®¢æˆ· A"ï¼‰
And ä¿å­˜åå¤ç›˜è®°å½•åŒ…å«å®Œæ•´ 4D å†…å®¹
```

---

### Full Release: æ™ºèƒ½å¤ç›˜åˆ†æï¼ˆ+2-4 å‘¨ï¼‰

**åœ¨ MMP åŸºç¡€ä¸Šæ–°å¢**:

- âœ… å¤ç›˜è¶‹åŠ¿åˆ†æï¼ˆè¯†åˆ«æŒç»­å‡ºç°çš„é—®é¢˜ï¼‰
- âœ… å¤ç›˜è´¨é‡è¯„åˆ†ï¼ˆåŸºäºå†…å®¹ä¸°å¯Œåº¦ï¼‰
- âœ… å¤ç›˜æŠ¥å‘Šå¯¼å‡ºï¼ˆPDF/Markdownï¼‰
- âœ… å›¢é˜Ÿå¤ç›˜ï¼ˆå¤šäººåä½œå¡«å†™ï¼‰
- âœ… å¤ç›˜æ¨¡æ¿è‡ªå®šä¹‰ï¼ˆé™¤ 4D å¤–æ”¯æŒè‡ªå®šä¹‰é—®é¢˜ï¼‰

**æŠ€æœ¯è¦ç‚¹**:

- NLP åˆ†æ"éœ€æ”¹è¿›çš„"å†…å®¹ï¼Œè¯†åˆ«é‡å¤é—®é¢˜
- å¤ç›˜è´¨é‡ç®—æ³•ï¼ˆå¦‚ï¼šæœ‰è¡ŒåŠ¨é¡¹ +10 åˆ†ï¼Œæœ‰å…·ä½“æ•°æ® +10 åˆ†ï¼‰
- PDF ç”ŸæˆæœåŠ¡ï¼ˆä½¿ç”¨ Puppeteerï¼‰

**éªŒæ”¶æ ‡å‡†**:

```gherkin
Given ç”¨æˆ·å®Œæˆäº† 5 æ¬¡å¤ç›˜
When ç³»ç»Ÿåˆ†æå¤ç›˜å†…å®¹
Then ç³»ç»Ÿåº”è¯†åˆ«å‡º"æ²Ÿé€šä¸è¶³"é—®é¢˜åœ¨ 3 æ¬¡å¤ç›˜ä¸­å‡ºç°
And æ˜¾ç¤ºæç¤º"'æ²Ÿé€šä¸è¶³'é—®é¢˜æŒç»­å‡ºç°ï¼Œå»ºè®®ä¼˜å…ˆè§£å†³"
And ç”¨æˆ·å¯ç‚¹å‡»"ç”Ÿæˆå¤ç›˜æŠ¥å‘Š"å¯¼å‡º PDF
```

---

## 5. éªŒæ”¶æ ‡å‡†ï¼ˆGherkinï¼‰

### Feature: ä¸“æ³¨å‘¨æœŸè¿½è¸ª

#### Scenario 1: é…ç½®ä¸“æ³¨å‘¨æœŸ

```gherkin
Feature: ä¸“æ³¨å‘¨æœŸè¿½è¸ª
  ä½œä¸ºç›®æ ‡è´Ÿè´£äººï¼Œæˆ‘å¸Œæœ›ä¸ºç›®æ ‡é…ç½®ä¸“æ³¨å‘¨æœŸï¼Œè‡ªåŠ¨æ”¶åˆ°å¤ç›˜æé†’

  Background:
    Given ç”¨æˆ·"æå››"å·²ç™»å½•
    And å­˜åœ¨ç›®æ ‡"2025 Q4 äº§å“åˆ›æ–°"
    And å½“å‰æ—¶é—´ä¸º 2025-10-21 09:00

  Scenario: é…ç½®æ¯å‘¨å¤ç›˜
    When ç”¨æˆ·æ‰“å¼€ç›®æ ‡"2025 Q4 äº§å“åˆ›æ–°"
    And ç‚¹å‡»"ä¸“æ³¨å‘¨æœŸ"é…ç½®
    And é€‰æ‹©å‘¨æœŸç±»å‹ = "æ¯å‘¨"
    And é€‰æ‹©å¤ç›˜æ—¥ = "å‘¨ä¸€"
    And è®¾ç½®å¤ç›˜æ—¶é—´ = "10:00"
    And è®¾ç½®æå‰é€šçŸ¥ = "1 å¤©"
    And ç‚¹å‡»"ä¿å­˜"
    Then ç›®æ ‡çš„ focusCycle åº”ä¸ºï¼š
      | type    | dayOfWeek | time  | advanceNoticeHours |
      | weekly  | 1         | 10:00 | 24                 |
    And ç³»ç»Ÿåº”æ˜¾ç¤º"ä¸“æ³¨å‘¨æœŸå·²é…ç½®ï¼Œä¸‹æ¬¡å¤ç›˜ï¼š2025-10-27 10:00"
    And Reminder æ¨¡å—åº”åˆ›å»ºå¾ªç¯æé†’

  Scenario: é…ç½®åŒå‘¨å¤ç›˜
    When ç”¨æˆ·é…ç½®ä¸“æ³¨å‘¨æœŸï¼š
      | type     | dayOfWeek | time  |
      | biweekly | 5         | 14:00 |
    Then ä¸‹æ¬¡å¤ç›˜æ—¶é—´åº”ä¸º"2025-10-24 14:00"ï¼ˆæœ¬å‘¨äº”ï¼‰
    And ä¸‹ä¸‹æ¬¡å¤ç›˜æ—¶é—´åº”ä¸º"2025-11-07 14:00"ï¼ˆä¸¤å‘¨åï¼‰
```

---

#### Scenario 2: æ‰§è¡Œå¤ç›˜å¹¶è®°å½•

```gherkin
  Background:
    Given ç›®æ ‡å·²é…ç½®"æ¯å‘¨ä¸€ 10:00 å¤ç›˜"
    And å½“å‰æ—¶é—´ä¸º 2025-10-27 10:00
    And ç³»ç»Ÿå‘é€äº†å¤ç›˜æé†’é€šçŸ¥

  Scenario: å®Œæˆ 4D å¤ç›˜
    When ç”¨æˆ·ç‚¹å‡»å¤ç›˜æé†’é€šçŸ¥
    Then ç³»ç»Ÿåº”æ‰“å¼€å¤ç›˜ç•Œé¢
    And Data éƒ¨åˆ†åº”è‡ªåŠ¨æ˜¾ç¤ºï¼š
      | keyResult        | oldProgress | newProgress | delta |
      | ç”¨æˆ·å¢é•¿ 20%     | 50%         | 65%         | +15%  |
      | NPS æå‡è‡³ 40    | 35          | 38          | +3    |
    When ç”¨æˆ·åœ¨ Discover éƒ¨åˆ†å¡«å†™ï¼š
      | wentWell                | needsImprovement     |
      | æ–°åŠŸèƒ½ä¸Šçº¿é¡ºåˆ©           | ç”¨æˆ·åé¦ˆå“åº”æ…¢        |
    And ç”¨æˆ·åœ¨ Dream éƒ¨åˆ†å¡«å†™"ä¸‹å‘¨å®Œæˆç”¨æˆ·å¢é•¿è‡³ 70%"
    And ç”¨æˆ·åœ¨ Design éƒ¨åˆ†æ·»åŠ è¡ŒåŠ¨é¡¹"æ¯å¤©å¤„ç† 5 æ¡ç”¨æˆ·åé¦ˆ"
    And ç‚¹å‡»"ä¿å­˜å¤ç›˜"
    Then ç³»ç»Ÿåº”åˆ›å»º GoalReview è®°å½•
    And è®°å½•åŒ…å«å®Œæ•´ 4D å†…å®¹
    And æ˜¾ç¤º"å¤ç›˜å·²ä¿å­˜ï¼Œä¸‹æ¬¡å¤ç›˜ï¼š2025-11-03 10:00"

  Scenario: è·³è¿‡å¤ç›˜
    When ç”¨æˆ·æ”¶åˆ°å¤ç›˜æé†’
    And ç‚¹å‡»"è·³è¿‡æœ¬æ¬¡å¤ç›˜"
    And é€‰æ‹©åŸå›  = "å‡ºå·®æ— æ³•å¤ç›˜"
    Then ç³»ç»Ÿåº”æ ‡è®°æœ¬æ¬¡å¤ç›˜ä¸º skipped
    And ä¸å½±å“ä¸‹æ¬¡å¤ç›˜æ—¶é—´ï¼ˆä»ä¸º 2025-11-03 10:00ï¼‰
    And å¤ç›˜å®Œæˆç‡ç»Ÿè®¡ä¸­è®¡å…¥"è·³è¿‡æ¬¡æ•°"
```

---

#### Scenario 3: æŸ¥çœ‹å¤ç›˜å†å²

```gherkin
  Background:
    Given ç›®æ ‡æœ‰ä»¥ä¸‹å¤ç›˜å†å²ï¼š
      | reviewTime        | status    | krDelta | actionItems |
      | 2025-10-27 10:00 | completed | +15%    | 3           |
      | 2025-10-20 10:00 | completed | +10%    | 2           |
      | 2025-10-13 10:00 | skipped   | -       | -           |
      | 2025-10-06 10:00 | completed | +8%     | 4           |

  Scenario: æŸ¥çœ‹å¤ç›˜å†å²åˆ—è¡¨
    When ç”¨æˆ·æ‰“å¼€ç›®æ ‡çš„"å¤ç›˜å†å²"æ ‡ç­¾
    Then ç³»ç»Ÿåº”æ˜¾ç¤ºå¤ç›˜åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
    And åˆ—è¡¨åº”åŒ…å« 4 æ¡è®°å½•
    And ç¬¬ä¸€æ¡è®°å½•åº”æ˜¾ç¤ºï¼š
      | æ—¶é—´              | çŠ¶æ€ | KR è¿›å±• | è¡ŒåŠ¨é¡¹ |
      | 2025-10-27 10:00 | âœ…   | +15%    | 3      |
    And è·³è¿‡çš„å¤ç›˜åº”æ˜¾ç¤º"â­ï¸ å·²è·³è¿‡"æ ‡è¯†

  Scenario: æŸ¥çœ‹å•æ¬¡å¤ç›˜è¯¦æƒ…
    When ç”¨æˆ·ç‚¹å‡»"2025-10-27 10:00"çš„å¤ç›˜è®°å½•
    Then ç³»ç»Ÿåº”æ˜¾ç¤ºå¤ç›˜è¯¦æƒ…å¯¹è¯æ¡†
    And è¯¦æƒ…åº”åŒ…å«å®Œæ•´ 4D å†…å®¹ï¼š
      | éƒ¨åˆ†     | å†…å®¹æ‘˜è¦                          |
      | Data     | KR1: +15%, KR2: +3, ä»»åŠ¡å®Œæˆ 5/8  |
      | Discover | âœ… æ–°åŠŸèƒ½ä¸Šçº¿ âš ï¸ ç”¨æˆ·åé¦ˆæ…¢        |
      | Dream    | ä¸‹å‘¨å®Œæˆç”¨æˆ·å¢é•¿è‡³ 70%            |
      | Design   | 3 ä¸ªè¡ŒåŠ¨é¡¹ï¼ˆ1 ä¸ªå·²å®Œæˆï¼‰          |
```

---

## 6. æŒ‡æ ‡ä¸è¿½è¸ª

### äº‹ä»¶åŸ‹ç‚¹

```typescript
// é…ç½®ä¸“æ³¨å‘¨æœŸ
{
  event: 'focus_cycle_configured',
  properties: {
    goalUuid: string,
    cycleType: string,
    dayOfWeek?: number,
    time: string
  }
}

// å¤ç›˜å¼€å§‹
{
  event: 'goal_review_started',
  properties: {
    goalUuid: string,
    reviewUuid: string,
    trigger: 'notification' | 'manual'
  }
}

// å¤ç›˜å®Œæˆ
{
  event: 'goal_review_completed',
  properties: {
    goalUuid: string,
    reviewUuid: string,
    duration: number,          // å¤ç›˜è€—æ—¶ï¼ˆç§’ï¼‰
    actionItemsCount: number,  // è¡ŒåŠ¨é¡¹æ•°é‡
    qualityScore: number       // å¤ç›˜è´¨é‡åˆ†ï¼ˆMMP åŠŸèƒ½ï¼‰
  }
}

// å¤ç›˜è·³è¿‡
{
  event: 'goal_review_skipped',
  properties: {
    goalUuid: string,
    reason: string
  }
}
```

---

### æˆåŠŸæŒ‡æ ‡

**å®šé‡æŒ‡æ ‡**:
| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹å¼ |
|------|-------|---------|
| å¤ç›˜é…ç½®ç‡ | >40% | é…ç½®ä¸“æ³¨å‘¨æœŸçš„ç›®æ ‡æ•° / æ€»ç›®æ ‡æ•° |
| å¤ç›˜å®Œæˆç‡ | >70% | å·²å®Œæˆå¤ç›˜æ•° / åº”å®Œæˆå¤ç›˜æ•° |
| å¤ç›˜å¹³å‡è€—æ—¶ | <10 åˆ†é’Ÿ | ä»å¼€å§‹åˆ°ä¿å­˜çš„å¹³å‡æ—¶é—´ |
| è¡ŒåŠ¨é¡¹åˆ›å»ºç‡ | >60% | åŒ…å«è¡ŒåŠ¨é¡¹çš„å¤ç›˜æ•° / æ€»å¤ç›˜æ•° |

**å®šæ€§æŒ‡æ ‡**:

- ç”¨æˆ·åé¦ˆ"å¤ç›˜ä¹ æƒ¯å…»æˆ"
- ç›®æ ‡è¾¾æˆç‡æå‡ï¼ˆæœ‰å®šæœŸå¤ç›˜ vs æ— å¤ç›˜å¯¹æ¯”ï¼‰
- å¤ç›˜å†…å®¹è´¨é‡ï¼ˆæ˜¯å¦æœ‰å…·ä½“æ•°æ®å’Œè¡ŒåŠ¨è®¡åˆ’ï¼‰

---

## 7. æŠ€æœ¯å®ç°è¦ç‚¹

### Prisma Schema

```prisma
model Goal {
  // ...existing fields...

  focusCycleType           String?  @map("focus_cycle_type")
  focusCycleDayOfWeek      Int?     @map("focus_cycle_day_of_week")
  focusCycleDayOfMonth     Int?     @map("focus_cycle_day_of_month")
  focusCycleTime           String?  @map("focus_cycle_time")
  focusCycleAdvanceNotice  Int?     @map("focus_cycle_advance_notice")
  focusCycleEnabled        Boolean  @default(false) @map("focus_cycle_enabled")
  nextReviewTime           BigInt?  @map("next_review_time")

  reviews  GoalReview[]
}

model GoalReview {
  uuid               String   @id @default(uuid())
  goalUuid           String   @map("goal_uuid")
  reviewTime         BigInt   @map("review_time")
  cycleStartTime     BigInt   @map("cycle_start_time")
  cycleEndTime       BigInt   @map("cycle_end_time")
  status             String   // pending, completed, skipped, delayed

  // 4D å¤ç›˜å†…å®¹ï¼ˆJSON å­˜å‚¨ï¼‰
  data               Json     // ReviewDataSection
  discover           Json     // ReviewDiscoverSection
  dream              Json     // ReviewDreamSection
  design             Json     // ReviewDesignSection

  reviewerUuid       String   @map("reviewer_uuid")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  goal      Goal    @relation(fields: [goalUuid], references: [uuid])
  reviewer  Account @relation(fields: [reviewerUuid], references: [uuid])

  @@index([goalUuid, reviewTime(sort: Desc)])
  @@map("goal_reviews")
}
```

### API ç«¯ç‚¹

```typescript
// é…ç½®ä¸“æ³¨å‘¨æœŸ
PUT /api/v1/goals/:id/focus-cycle
Body: FocusCycle
Response: GoalClientDTO

// åˆ›å»ºå¤ç›˜
POST /api/v1/goals/:id/reviews
Body: Omit<GoalReviewServerDTO, 'uuid' | 'createdAt'>
Response: GoalReviewClientDTO

// æŸ¥è¯¢å¤ç›˜åˆ—è¡¨
GET /api/v1/goals/:id/reviews
Query: status?, startTime?, endTime?, limit?, offset?
Response: { reviews: GoalReviewClientDTO[], total: number }

// æ›´æ–°å¤ç›˜
PATCH /api/v1/reviews/:reviewId
Body: Partial<GoalReviewServerDTO>
Response: GoalReviewClientDTO
```

---

## 8. é£é™©ä¸ç¼“è§£

| é£é™©                 | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½                               |
| -------------------- | ------ | ---- | -------------------------------------- |
| ç”¨æˆ·è§‰å¾—å¤ç›˜å¤ªéº»çƒ¦   | é«˜     | é«˜   | ç®€åŒ– MVP ç‰ˆæœ¬ + å¿«é€Ÿå¤ç›˜æ¨¡å¼ï¼ˆ1 åˆ†é’Ÿï¼‰ |
| æé†’ç–²åŠ³ï¼ˆå¤ªå¤šé€šçŸ¥ï¼‰ | ä¸­     | ä¸­   | æ”¯æŒå…³é—­æé†’ + åˆå¹¶é€šçŸ¥                |
| å¤ç›˜å†…å®¹å¤ªç©ºæ´       | ä¸­     | ä¸­   | æä¾›å¤ç›˜æ¨¡æ¿ç¤ºä¾‹ + æ™ºèƒ½å»ºè®®            |
| æ—¶åŒºé—®é¢˜             | ä½     | ä¸­   | å­˜å‚¨ UTC æ—¶é—´ + å‰ç«¯æœ¬åœ°åŒ–             |

---

## 9. å‚è€ƒèµ„æ–™

- [Goal Contracts](../../../../packages/contracts/src/modules/goal/)
- [Reminder Module](../../../../packages/contracts/src/modules/reminder/)
- [4D å¤ç›˜æ³•](https://en.wikipedia.org/wiki/Appreciative_inquiry#4D_Cycle)

---

**æ–‡æ¡£çŠ¶æ€**: âœ… Ready for PM Review  
**ä¸‹ä¸€æ­¥**: PM ç”Ÿæˆ Project Flow

# E2E æµ‹è¯•å¿«é€Ÿå¼€å§‹

## ğŸš€ 5 åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨

### 1. ç¡®ä¿æœåŠ¡è¿è¡Œ

```bash
# ç»ˆç«¯ 1: API æœåŠ¡å™¨ (ç«¯å£ 3888)
cd apps/api
pnpm dev

# ç»ˆç«¯ 2: Web å‰ç«¯ (ç«¯å£ 5173)
cd apps/web
pnpm dev
```

éªŒè¯æœåŠ¡ï¼š

- API: http://localhost:3888/api-docs
- Web: http://localhost:5173

### 2. åˆ›å»ºæµ‹è¯•ç”¨æˆ· (é¦–æ¬¡è¿è¡Œ)

```bash
cd apps/api
npx tsx src/__tests__/manual/setup-e2e-test-user.ts
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
âœ… æµ‹è¯•ç”¨æˆ·å·²å­˜åœ¨: testuser
   Account UUID: 5e41f716-c0f1-46f0-b1b2-a0dc61703c54
   UserProfile UUID: efee3d2e-dd4f-4936-8a56-63e02cae5458
```

### 3. è¿è¡Œæµ‹è¯•

```bash
cd apps/web

# å¿«é€Ÿè¿è¡Œ (æ— å¤´æ¨¡å¼)
pnpm e2e

# å¯è§†åŒ–æ¨¡å¼ (æ¨èé¦–æ¬¡è¿è¡Œ)
pnpm e2e:headed

# è°ƒè¯•æ¨¡å¼
pnpm e2e:debug
```

## ğŸ“Š é¢„æœŸç»“æœ

### æˆåŠŸè¾“å‡ºç¤ºä¾‹

```
Running 2 tests using 1 worker

  âœ“ [chromium] â€º reminder.spec.ts:45:3 â€º åˆ›å»ºæ¯åˆ†é’Ÿæé†’å¹¶éªŒè¯æ¥æ”¶é€šçŸ¥ (185.2s)
  âœ“ [chromium] â€º reminder.spec.ts:139:3 â€º åˆ›å»ºæé†’åç«‹å³éªŒè¯ SSE è¿æ¥ (12.3s)

  2 passed (197.5s)
```

### æµ‹è¯•æ—¥å¿—ç¤ºä¾‹

```
========================================
ğŸš€ å¼€å§‹ E2E æµ‹è¯•
========================================

ğŸ“ Step 1: ç”¨æˆ·ç™»å½•
[Auth] å¼€å§‹ç™»å½•: testuser
âœ… ç™»å½•æˆåŠŸ

ğŸ“ Step 2: å¯¼èˆªåˆ° Reminder é¡µé¢
[Navigation] å¯¼èˆªåˆ° Reminder é¡µé¢
âœ… æˆåŠŸè¿›å…¥ Reminder é¡µé¢

ğŸ“ Step 3: åˆ›å»ºæ¯åˆ†é’Ÿæé†’
âœ… Reminder åˆ›å»ºæˆåŠŸå¹¶æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­

ğŸ“ Step 4: ç­‰å¾…æé†’è§¦å‘ (æœ€å¤š 3 åˆ†é’Ÿ)
â° å¼€å§‹ç­‰å¾…...
   - é¢„æœŸç¬¬ä¸€æ¬¡è§¦å‘: ~1 åˆ†é’Ÿå
   - é¢„æœŸç¬¬äºŒæ¬¡è§¦å‘: ~2 åˆ†é’Ÿå
   - æœ€å¤§ç­‰å¾…æ—¶é—´: 3 åˆ†é’Ÿ

[Notification] å·²ç­‰å¾… 60 ç§’...
[Notification] å·²ç­‰å¾… 65 ç§’...
[Notification] âœ… æ”¶åˆ°æé†’é€šçŸ¥!

ğŸ“ Step 5: éªŒè¯é€šçŸ¥æ¥æ”¶
ğŸ“¡ æ•è·åˆ° 3 ä¸ª SSE äº‹ä»¶:
   1. [schedule:reminder-triggered] at 2025-10-07T04:35:00.000Z
   2. [schedule:popup-reminder] at 2025-10-07T04:35:00.100Z
   3. [schedule:sound-reminder] at 2025-10-07T04:35:00.150Z

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              âœ… E2E æµ‹è¯•å®Œæˆ                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Reminder åç§°: E2E Test - 1759812345678                   â•‘
â•‘  åˆ›å»ºæ—¶é—´: 12:34:56                                        â•‘
â•‘  é¦–æ¬¡è§¦å‘: 72s å                                          â•‘
â•‘  SSE äº‹ä»¶æ•°: 3                                             â•‘
â•‘  Reminder äº‹ä»¶: 3                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1: æµ‹è¯•ç”¨æˆ·ä¸å­˜åœ¨

**é”™è¯¯**: `ç™»å½•å¤±è´¥ - ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯`

**è§£å†³**:

```bash
cd apps/api
npx tsx src/__tests__/manual/setup-e2e-test-user.ts
```

### é—®é¢˜ 2: æœåŠ¡æœªå¯åŠ¨

**é”™è¯¯**: `page.goto: net::ERR_CONNECTION_REFUSED`

**è§£å†³**: ç¡®ä¿ API å’Œ Web æœåŠ¡éƒ½åœ¨è¿è¡Œ

```bash
# æ£€æŸ¥ç«¯å£
netstat -ano | findstr :3888  # API
netstat -ano | findstr :5173  # Web
```

### é—®é¢˜ 3: è¶…æ—¶æœªæ”¶åˆ°é€šçŸ¥

**å¯èƒ½åŸå› **:

- Reminder åˆ›å»ºå¤±è´¥
- è°ƒåº¦å™¨æœªè¿è¡Œ
- SSE è¿æ¥æ–­å¼€

**è°ƒè¯•æ­¥éª¤**:

1. æ£€æŸ¥ API æ—¥å¿—ä¸­çš„è°ƒåº¦å™¨å¯åŠ¨ä¿¡æ¯
2. æ‰‹åŠ¨åœ¨ Web UI ä¸­åˆ›å»º Reminder éªŒè¯
3. ä½¿ç”¨ `pnpm e2e:debug` é€æ­¥æ‰§è¡Œ

### é—®é¢˜ 4: æµè§ˆå™¨æœªå®‰è£…

**é”™è¯¯**: `Executable doesn't exist at C:\Users\...\chromium-1194\chrome.exe`

**è§£å†³**:

```bash
cd apps/web
npx playwright install chromium
```

## ğŸ“ ä¸‹ä¸€æ­¥

- æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: [`E2E_TESTING_GUIDE.md`](./E2E_TESTING_GUIDE.md)
- æŸ¥çœ‹å®æ–½æ€»ç»“: [`../docs/testing/E2E_TESTING_IMPLEMENTATION_SUMMARY.md`](../../docs/testing/E2E_TESTING_IMPLEMENTATION_SUMMARY.md)
- æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹
- é›†æˆåˆ° CI/CD

---

**æç¤º**: é¦–æ¬¡è¿è¡Œå»ºè®®ä½¿ç”¨ `pnpm e2e:headed` ä»¥è§‚å¯Ÿå®Œæ•´çš„æµ‹è¯•æµç¨‹ï¼
